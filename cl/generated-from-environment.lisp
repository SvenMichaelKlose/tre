(IN-PACKAGE :TRE-PARALLEL)
(CL:PROGN (CL:DEFUN EVAL (X) (%EVAL X)) (CL:SETF (CL:GETHASH #'EVAL *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS '%EVAL (CL:CONS 'X NIL)) NIL))))
(CL:PROGN (CL:DEFUN STRING (X) (%STRING X)) (CL:SETF (CL:GETHASH #'STRING *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS '%STRING (CL:CONS 'X NIL)) NIL))))
(CL:PROGN (CL:DEFUN EQ (CL:&REST X) (CL:APPLY #'%EQ (CL:LIST X))) (CL:SETF (CL:GETHASH #'EQ *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '%EQ NIL)) (CL:CONS (CL:CONS 'CL:LIST (CL:CONS 'X NIL)) NIL))) NIL))))
(CL:PROGN (CL:DEFUN EQL (CL:&REST X) (CL:APPLY #'%EQL (CL:LIST X))) (CL:SETF (CL:GETHASH #'EQL *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '%EQL NIL)) (CL:CONS (CL:CONS 'CL:LIST (CL:CONS 'X NIL)) NIL))) NIL))))
(CL:PROGN (CL:DEFUN NOT (CL:&REST X) (CL:APPLY #'%NOT X)) (CL:SETF (CL:GETHASH #'NOT *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '%NOT NIL)) (CL:CONS 'X NIL))) NIL))))
(CL:PROGN (CL:DEFUN MAKE-SYMBOL (X CL:&OPTIONAL (PACKAGE NIL)) (%MAKE-SYMBOL X PACKAGE)) (CL:SETF (CL:GETHASH #'MAKE-SYMBOL *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'PACKAGE (CL:CONS NIL NIL)) NIL))) (CL:CONS (CL:CONS '%MAKE-SYMBOL (CL:CONS 'X (CL:CONS 'PACKAGE NIL))) NIL))))
(CL:PROGN (CL:DEFUN SYMBOL-NAME (X) (%SYMBOL-NAME X)) (CL:SETF (CL:GETHASH #'SYMBOL-NAME *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS '%SYMBOL-NAME (CL:CONS 'X NIL)) NIL))))
(CL:PROGN (CL:DEFUN SYMBOL-VALUE (X) (%SYMBOL-VALUE X)) (CL:SETF (CL:GETHASH #'SYMBOL-VALUE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS '%SYMBOL-VALUE (CL:CONS 'X NIL)) NIL))))
(CL:PROGN (CL:DEFUN SYMBOL-FUNCTION (X) (%SYMBOL-FUNCTION X)) (CL:SETF (CL:GETHASH #'SYMBOL-FUNCTION *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS '%SYMBOL-FUNCTION (CL:CONS 'X NIL)) NIL))))
(CL:PROGN (CL:DEFUN SYMBOL-PACKAGE (X) (%SYMBOL-PACKAGE X)) (CL:SETF (CL:GETHASH #'SYMBOL-PACKAGE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS '%SYMBOL-PACKAGE (CL:CONS 'X NIL)) NIL))))
(CL:PROGN (CL:DEFUN NUMBER? (X) (%NUMBER? X)) (CL:SETF (CL:GETHASH #'NUMBER? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS '%NUMBER? (CL:CONS 'X NIL)) NIL))))
(CL:PROGN (CL:DEFUN INTEGER (X) (%INTEGER X)) (CL:SETF (CL:GETHASH #'INTEGER *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS '%INTEGER (CL:CONS 'X NIL)) NIL))))
(CL:PROGN (CL:DEFUN CODE-CHAR (X) (%CODE-CHAR (%INTEGER X))) (CL:SETF (CL:GETHASH #'CODE-CHAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS '%CODE-CHAR (CL:CONS (CL:CONS '%INTEGER (CL:CONS 'X NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN NUMBER+ (CL:&REST X) (CL:APPLY #'%+ X)) (CL:SETF (CL:GETHASH #'NUMBER+ *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '%+ NIL)) (CL:CONS 'X NIL))) NIL))))
(CL:PROGN (CL:DEFUN INTEGER+ (CL:&REST X) (CL:APPLY #'%+ X)) (CL:SETF (CL:GETHASH #'INTEGER+ *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '%+ NIL)) (CL:CONS 'X NIL))) NIL))))
(CL:PROGN (CL:DEFUN CHARACTER+ (CL:&REST X) (CL:APPLY #'%+ X)) (CL:SETF (CL:GETHASH #'CHARACTER+ *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '%+ NIL)) (CL:CONS 'X NIL))) NIL))))
(CL:PROGN (CL:DEFUN NUMBER- (CL:&REST X) (CL:APPLY #'%- X)) (CL:SETF (CL:GETHASH #'NUMBER- *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '%- NIL)) (CL:CONS 'X NIL))) NIL))))
(CL:PROGN (CL:DEFUN INTEGER- (CL:&REST X) (CL:APPLY #'%- X)) (CL:SETF (CL:GETHASH #'INTEGER- *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '%- NIL)) (CL:CONS 'X NIL))) NIL))))
(CL:PROGN (CL:DEFUN CHARACTER- (CL:&REST X) (CL:APPLY #'%- X)) (CL:SETF (CL:GETHASH #'CHARACTER- *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '%- NIL)) (CL:CONS 'X NIL))) NIL))))
(CL:PROGN (CL:DEFUN * (CL:&REST X) (CL:APPLY #'%* X)) (CL:SETF (CL:GETHASH #'* *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '%* NIL)) (CL:CONS 'X NIL))) NIL))))
(CL:PROGN (CL:DEFUN / (CL:&REST X) (CL:APPLY #'%/ X)) (CL:SETF (CL:GETHASH #'/ *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '%/ NIL)) (CL:CONS 'X NIL))) NIL))))
(CL:PROGN (CL:DEFUN < (CL:&REST X) (CL:APPLY #'%< X)) (CL:SETF (CL:GETHASH #'< *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '%< NIL)) (CL:CONS 'X NIL))) NIL))))
(CL:PROGN (CL:DEFUN > (CL:&REST X) (CL:APPLY #'%> X)) (CL:SETF (CL:GETHASH #'> *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '%> NIL)) (CL:CONS 'X NIL))) NIL))))
(CL:PROGN (CL:DEFUN FILTER (FUN X) (CL:MAPCAR FUN X)) (CL:SETF (CL:GETHASH #'FILTER *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'FUN (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:MAPCAR (CL:CONS 'FUN (CL:CONS 'X NIL))) NIL))))
(CL:PROGN (CL:DEFUN MAKE-ARRAY (CL:&OPTIONAL (DIMENSIONS 1)) (%MAKE-ARRAY DIMENSIONS)) (CL:SETF (CL:GETHASH #'MAKE-ARRAY *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'DIMENSIONS (CL:CONS 1 NIL)) NIL)) (CL:CONS (CL:CONS '%MAKE-ARRAY (CL:CONS 'DIMENSIONS NIL)) NIL))))
(CL:PROGN (CL:DEFUN MAKE-HASH-TABLE (CL:&KEY (TEST #'EQL)) (%MAKE-HASH-TABLE :TEST TEST)) (CL:SETF (CL:GETHASH #'MAKE-HASH-TABLE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'TEST (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'EQL NIL)) NIL)) NIL)) (CL:CONS (CL:CONS '%MAKE-HASH-TABLE (CL:CONS ':TEST (CL:CONS 'TEST NIL))) NIL))))
(CL:PROGN (CL:DEFUN LOAD (PATHNAME) (%LOAD PATHNAME)) (CL:SETF (CL:GETHASH #'LOAD *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'PATHNAME NIL) (CL:CONS (CL:CONS '%LOAD (CL:CONS 'PATHNAME NIL)) NIL))))
(%DEFVAR *MACROEXPAND* NIL)
(CL:PROGN (CL:DEFUN MACROEXPAND-1 (X) (? *MACROEXPAND* (CL:APPLY *MACROEXPAND* (CL:LIST X)) X)) (CL:SETF (CL:GETHASH #'MACROEXPAND-1 *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS '? (CL:CONS '*MACROEXPAND* (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS '*MACROEXPAND* (CL:CONS (CL:CONS 'CL:LIST (CL:CONS 'X NIL)) NIL))) (CL:CONS 'X NIL)))) NIL))))
(CL:PROGN (CL:DEFUN MACROEXPAND-0 (OLD X) (? (%EQUAL X OLD) OLD (MACROEXPAND X))) (CL:SETF (CL:GETHASH #'MACROEXPAND-0 *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'OLD (CL:CONS 'X NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '%EQUAL (CL:CONS 'X (CL:CONS 'OLD NIL))) (CL:CONS 'OLD (CL:CONS (CL:CONS 'MACROEXPAND (CL:CONS 'X NIL)) NIL)))) NIL))))
(CL:PROGN (CL:DEFUN MACROEXPAND (X) (MACROEXPAND-0 X (MACROEXPAND-1 X))) (CL:SETF (CL:GETHASH #'MACROEXPAND *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'MACROEXPAND-0 (CL:CONS 'X (CL:CONS (CL:CONS 'MACROEXPAND-1 (CL:CONS 'X NIL)) NIL))) NIL))))
(CL:PROGN (CL:DEFUN NANOTIME NIL 0) (CL:SETF (CL:GETHASH #'NANOTIME *FUNCTION-ATOM-SOURCES*) (CL:CONS NIL (CL:CONS 0 NIL))))
(CL:PROGN (CL:DEFUN FUNCTION-BYTECODE (X) X NIL) (CL:SETF (CL:GETHASH #'FUNCTION-BYTECODE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS 'X (CL:CONS NIL NIL)))))
(%DEFVAR *FUNCTIONALS* NIL)
(%DEFMACRO FUNCTIONAL (CL:&REST NAMES) (PRINT-DEFINITION (CL:CONS 'FUNCTIONAL (APPEND NAMES NIL))) (CL:CONS 'CL:SETQ (CL:CONS '*FUNCTIONALS* (CL:CONS (CL:CONS '%NCONC (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS NAMES NIL)) (CL:CONS '*FUNCTIONALS* NIL))) NIL))))
(CL:PROGN (CL:DEFUN FUNCTIONAL? (NAME) (MEMBER NAME *FUNCTIONALS* :TEST #'EQ)) (CL:SETF (CL:GETHASH #'FUNCTIONAL? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'NAME NIL) (CL:CONS (CL:CONS 'MEMBER (CL:CONS 'NAME (CL:CONS '*FUNCTIONALS* (CL:CONS ':TEST (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'EQ NIL)) NIL))))) NIL))))
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'IDENTITY (CL:CONS '+ (CL:CONS '- (CL:CONS '* (CL:CONS '/ (CL:CONS 'CL:MOD (CL:CONS 'NUMBER+ (CL:CONS 'NUMBER- (CL:CONS 'NUMBER* (CL:CONS 'NUMBER/ (CL:CONS 'INTEGER+ (CL:CONS 'INTEGER- (CL:CONS 'INTEGER* (CL:CONS 'INTEGER/ (CL:CONS 'CHARACTER+ (CL:CONS 'CHARACTER- (CL:CONS 'LOGXOR (CL:CONS 'NUMBER? (CL:CONS '== (CL:CONS '< (CL:CONS '> (CL:CONS 'NUMBER== (CL:CONS 'NUMBER< (CL:CONS 'NUMBER> (CL:CONS 'INTEGER== (CL:CONS 'INTEGER< (CL:CONS 'INTEGER> (CL:CONS 'CHARACTER== (CL:CONS 'CHARACTER< (CL:CONS 'CHARACTER> (CL:CONS 'BIT-OR (CL:CONS 'BIT-AND (CL:CONS '<< (CL:CONS '>> (CL:CONS 'CODE-CHAR (CL:CONS 'INTEGER (CL:CONS 'CHARACTER? (CL:CONS 'NOT (CL:CONS 'EQ (CL:CONS 'EQL (CL:CONS 'MAKE-SYMBOL (CL:CONS 'CL:MAKE-PACKAGE (CL:CONS 'CL:ATOM (CL:CONS 'SYMBOL-VALUE (CL:CONS '%TYPE (CL:CONS '%%ID (CL:CONS '%MAKE-PTR (CL:CONS 'SYMBOL-FUNCTION (CL:CONS 'SYMBOL-PACKAGE (CL:CONS 'FUNCTION-NATIVE (CL:CONS 'SYMBOL? (CL:CONS 'FUNCTION? (CL:CONS 'BUILTIN? (CL:CONS 'MACRO? (CL:CONS 'CL:CONS (CL:CONS 'CL:LIST (CL:CONS 'CL:CAR (CL:CONS 'CL:CDR (CL:CONS 'CONS? (CL:CONS 'CL:ELT (CL:CONS 'CL:LENGTH (CL:CONS 'STRING? (CL:CONS 'CL:MAKE-STRING (CL:CONS 'STRING== (CL:CONS 'STRING-CONCAT (CL:CONS 'STRING (CL:CONS 'SYMBOL-NAME (CL:CONS 'LIST-STRING (CL:CONS 'MAKE-ARRAY (CL:CONS 'ARRAY? (CL:CONS 'CL:AREF (CL:CONS 'SLOT-VALUE (CL:CONS '%SLOT-VALUE (CL:CONS 'CL:LIST (CL:CONS 'IDENTITY (CL:CONS 'CL:LAST (CL:CONS 'CL:COPY-LIST (CL:CONS 'INTEGER? (CL:CONS 'CHARACTER? NIL))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))) *FUNCTIONALS*))
(%DEFVAR *DEFINITION-PRINTER* #'CL:PRINT)
(CL:PROGN (CL:DEFUN PRINT-DEFINITION (X) (? *PRINT-DEFINITIONS?* (CL:APPLY *DEFINITION-PRINTER* (CL:LIST X)))) (CL:SETF (CL:GETHASH #'PRINT-DEFINITION *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS '? (CL:CONS '*PRINT-DEFINITIONS?* (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS '*DEFINITION-PRINTER* (CL:CONS (CL:CONS 'CL:LIST (CL:CONS 'X NIL)) NIL))) NIL))) NIL))))
(CL:PROGN (CL:DEFUN ANY-QUASIQUOTE? (X) (? (CONS? X) (? (EQ (CL:CAR X) 'QUASIQUOTE) T (EQ (CL:CAR X) 'QUASIQUOTE-SPLICE) T))) (CL:SETF (CL:GETHASH #'ANY-QUASIQUOTE? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CONS? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'QUASIQUOTE NIL)) NIL))) (CL:CONS T (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'QUASIQUOTE-SPLICE NIL)) NIL))) (CL:CONS T NIL))))) NIL))) NIL))))
(CL:PROGN (CL:DEFUN %QUASIQUOTE-EXPAND (X) (? (CL:ATOM X) X (CL:ATOM (CL:CAR X)) (CL:CONS (CL:CAR X) (%QUASIQUOTE-EXPAND (CL:CDR X))) (EQ (CL:CAR (CL:CAR X)) 'CL:QUOTE) (CL:CONS (CL:CAR X) (%QUASIQUOTE-EXPAND (CL:CDR X))) (EQ (CL:CAR (CL:CAR X)) 'BACKQUOTE) (CL:CONS (CL:CAR X) (%QUASIQUOTE-EXPAND (CL:CDR X))) (EQ (CL:CAR (CL:CAR X)) 'QUASIQUOTE) (CL:CONS (EVAL (MACROEXPAND (CL:CAR (CL:CDR (CL:CAR X))))) (%QUASIQUOTE-EXPAND (CL:CDR X))) (EQ (CL:CAR (CL:CAR X)) 'QUASIQUOTE-SPLICE) (APPEND (EVAL (MACROEXPAND (CL:CAR (CL:CDR (CL:CAR X))))) (%QUASIQUOTE-EXPAND (CL:CDR X))) (CL:CONS (%QUASIQUOTE-EXPAND (CL:CAR X)) (%QUASIQUOTE-EXPAND (CL:CDR X))))) (CL:SETF (CL:GETHASH #'%QUASIQUOTE-EXPAND *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CL:ATOM (CL:CONS 'X NIL)) (CL:CONS 'X (CL:CONS (CL:CONS 'CL:ATOM (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) (CL:CONS (CL:CONS '%QUASIQUOTE-EXPAND (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL)) NIL))) (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CL:QUOTE NIL)) NIL))) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) (CL:CONS (CL:CONS '%QUASIQUOTE-EXPAND (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL)) NIL))) (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'BACKQUOTE NIL)) NIL))) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) (CL:CONS (CL:CONS '%QUASIQUOTE-EXPAND (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL)) NIL))) (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'QUASIQUOTE NIL)) NIL))) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'EVAL (CL:CONS (CL:CONS 'MACROEXPAND (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS '%QUASIQUOTE-EXPAND (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL)) NIL))) (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'QUASIQUOTE-SPLICE NIL)) NIL))) (CL:CONS (CL:CONS 'APPEND (CL:CONS (CL:CONS 'EVAL (CL:CONS (CL:CONS 'MACROEXPAND (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS '%QUASIQUOTE-EXPAND (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL)) NIL))) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS '%QUASIQUOTE-EXPAND (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) (CL:CONS (CL:CONS '%QUASIQUOTE-EXPAND (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL)) NIL))) NIL)))))))))))))) NIL))))
(CL:PROGN (CL:DEFUN QUASIQUOTE-EXPAND (X) (CL:CAR (%QUASIQUOTE-EXPAND (CL:LIST X)))) (CL:SETF (CL:GETHASH #'QUASIQUOTE-EXPAND *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS '%QUASIQUOTE-EXPAND (CL:CONS (CL:CONS 'CL:LIST (CL:CONS 'X NIL)) NIL)) NIL)) NIL))))
(CL:SETQ *QUASIQUOTE-EXPAND* #'QUASIQUOTE-EXPAND)
(CL:PROGN (CL:DEFUN IDENTITY (X) X) (CL:SETF (CL:GETHASH #'IDENTITY *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS 'X NIL))))
(CL:PROGN (CL:DEFUN + (CL:&REST X) (CL:LABELS ((G3653 (A) (? A (CL:APPLY (? (CONS? A) #'APPEND (STRING? A) #'STRING-CONCAT #'NUMBER+) X) (? (CL:CDR X) (CL:APPLY #'+ (CL:CDR X)))))) (G3653 (CL:CAR X)))) (CL:SETF (CL:GETHASH #'+ *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'A NIL) (CL:CONS (CL:CONS '? (CL:CONS 'A (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CONS? (CL:CONS 'A NIL)) (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'APPEND NIL)) (CL:CONS (CL:CONS 'STRING? (CL:CONS 'A NIL)) (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'STRING-CONCAT NIL)) (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'NUMBER+ NIL)) NIL)))))) (CL:CONS 'X NIL))) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '+ NIL)) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL))) NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN - (CL:&REST X) (CL:APPLY #'NUMBER- X)) (CL:SETF (CL:GETHASH #'- *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'NUMBER- NIL)) (CL:CONS 'X NIL))) NIL))))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'FUNCALL (CL:CONS (CL:CONS 'FUN (CL:CONS 'CL:&REST (CL:CONS 'ARGS NIL))) NIL)))) (CL:PROGN (CL:DEFUN FUNCALL (FUN CL:&REST ARGS) (CL:BLOCK FUNCALL (CL:BLOCK NIL (CL:APPLY FUN ARGS)))) (CL:SETF (CL:GETHASH #'FUNCALL *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'FUN (CL:CONS 'CL:&REST (CL:CONS 'ARGS NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'FUNCALL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS 'FUN (CL:CONS 'ARGS NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'FUNCALL))
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'CAAR (CL:CONS 'CADR (CL:CONS 'CDAR (CL:CONS 'CDDR (CL:CONS 'CADAR (CL:CONS 'CDDAR (CL:CONS 'CAADAR (CL:CONS 'CADDR (CL:CONS 'CAADR (CL:CONS 'CDDDR (CL:CONS 'CDADAR (CL:CONS 'CAADDR (CL:CONS 'CADDAR (CL:CONS 'CDDDAR (CL:CONS 'CDDDDR (CL:CONS 'CADADR (CL:CONS 'CADADDR (CL:CONS 'CADADAR (CL:CONS 'CDDADAR NIL))))))))))))))))))) *FUNCTIONALS*))
(CL:PROGN (CL:DEFUN CAAR (LST) (CL:CAR (CL:CAR LST))) (CL:SETF (CL:GETHASH #'CAAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CADR (LST) (CL:CAR (CL:CDR LST))) (CL:SETF (CL:GETHASH #'CADR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CDAR (LST) (CL:CDR (CL:CAR LST))) (CL:SETF (CL:GETHASH #'CDAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CDDR (LST) (CL:CDR (CL:CDR LST))) (CL:SETF (CL:GETHASH #'CDDR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CADAR (LST) (CADR (CL:CAR LST))) (CL:SETF (CL:GETHASH #'CADAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CADR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CDDAR (LST) (CDDR (CL:CAR LST))) (CL:SETF (CL:GETHASH #'CDDAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CDDR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CDADR (LST) (CDAR (CL:CDR LST))) (CL:SETF (CL:GETHASH #'CDADR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CDAR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CADDR (LST) (CL:CAR (CDDR LST))) (CL:SETF (CL:GETHASH #'CADDR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CDDR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CAADR (LST) (CL:CAR (CADR LST))) (CL:SETF (CL:GETHASH #'CAADR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CADR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CDDDR (LST) (CL:CDR (CL:CDR (CL:CDR LST)))) (CL:SETF (CL:GETHASH #'CDDDR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'LST NIL)) NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CDDDDR (LST) (CL:CDR (CL:CDR (CL:CDR (CL:CDR LST))))) (CL:SETF (CL:GETHASH #'CDDDDR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'LST NIL)) NIL)) NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CAADAR (LST) (CL:CAR (CADR (CL:CAR LST)))) (CL:SETF (CL:GETHASH #'CAADAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CADR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'LST NIL)) NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CDADAR (LST) (CL:CDR (CADR (CL:CAR LST)))) (CL:SETF (CL:GETHASH #'CDADAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS (CL:CONS 'CADR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'LST NIL)) NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CAADDR (LST) (CL:CAR (CADDR LST))) (CL:SETF (CL:GETHASH #'CAADDR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CADDR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CADDAR (LST) (CADDR (CL:CAR LST))) (CL:SETF (CL:GETHASH #'CADDAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CADDR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CDDDAR (LST) (CDDDR (CL:CAR LST))) (CL:SETF (CL:GETHASH #'CDDDAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CDDDR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CADADR (LST) (CADR (CADR LST))) (CL:SETF (CL:GETHASH #'CADADR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CADR (CL:CONS (CL:CONS 'CADR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CADADDR (LST) (CADR (CADDR LST))) (CL:SETF (CL:GETHASH #'CADADDR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CADR (CL:CONS (CL:CONS 'CADDR (CL:CONS 'LST NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CADADAR (LST) (CADR (CADR (CL:CAR LST)))) (CL:SETF (CL:GETHASH #'CADADAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CADR (CL:CONS (CL:CONS 'CADR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'LST NIL)) NIL)) NIL)) NIL))))
(CL:PROGN (CL:DEFUN CDDADAR (LST) (CDDR (CADR (CL:CAR LST)))) (CL:SETF (CL:GETHASH #'CDDADAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LST NIL) (CL:CONS (CL:CONS 'CDDR (CL:CONS (CL:CONS 'CADR (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'LST NIL)) NIL)) NIL)) NIL))))
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'EQUAL NIL) *FUNCTIONALS*))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'EQUAL (CL:CONS (CL:CONS 'X (CL:CONS 'Y NIL)) NIL)))) (CL:PROGN (CL:DEFUN EQUAL (X Y) (CL:BLOCK EQUAL (CL:BLOCK NIL (? (CL:LABELS ((G3654 (~G1461) (? ~G1461 ~G1461 (CL:ATOM Y)))) (G3654 (CL:ATOM X))) (EQL X Y) (EQUAL (CL:CAR X) (CL:CAR Y)) (EQUAL (CL:CDR X) (CL:CDR Y)))))) (CL:SETF (CL:GETHASH #'EQUAL *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'Y NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'EQUAL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1461 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1461 (CL:CONS '~G1461 (CL:CONS (CL:CONS 'CL:ATOM (CL:CONS 'Y NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:ATOM (CL:CONS 'X NIL)) NIL)) (CL:CONS (CL:CONS 'EQL (CL:CONS 'X (CL:CONS 'Y NIL))) (CL:CONS (CL:CONS 'EQUAL (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'Y NIL)) NIL))) (CL:CONS (CL:CONS 'EQUAL (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'Y NIL)) NIL))) NIL))))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'EQUAL))
NIL
NIL
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS '>= (CL:CONS '<= (CL:CONS 'CHARACTER>= (CL:CONS 'CHARACTER<= (CL:CONS 'INTEGER>= (CL:CONS 'INTEGER<= (CL:CONS 'NUMBER>= (CL:CONS 'NUMBER<= NIL)))))))) *FUNCTIONALS*))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '>= (CL:CONS (CL:CONS 'N (CL:CONS 'CL:&REST (CL:CONS 'X NIL))) NIL)))) (CL:PROGN (CL:DEFUN >= (N CL:&REST X) (CL:BLOCK >= (CL:BLOCK NIL (CL:BLOCK NIL (CL:LABELS ((G3655 (~G1472) (CL:LABELS ((G3656 (I) (CL:TAGBODY ~G1470 (? (NOT ~G1472) (CL:GO ~G1471)) (CL:SETQ I (CL:CAR ~G1472)) (CL:LABELS ((G3657 (~G1462) (? ~G1462 ~G1462 (CL:LABELS ((G3658 (~G1463) (? ~G1463 ~G1463 (CL:RETURN-FROM NIL NIL)))) (G3658 (> N I)))))) (G3657 (== N I))) (CL:SETQ N I) (CL:SETQ ~G1472 (CL:CDR ~G1472)) (CL:GO ~G1470) ~G1471 (CL:RETURN-FROM NIL (CL:PROGN T))))) (G3656 NIL)))) (G3655 X)))))) (CL:SETF (CL:GETHASH #'>= *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'N (CL:CONS 'CL:&REST (CL:CONS 'X NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '>= (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1472 (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'I (CL:CONS NIL NIL)) NIL)) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1470 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS '~G1472 NIL)) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1471 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'I (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1472 NIL)) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1462 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1462 (CL:CONS '~G1462 (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1463 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1463 (CL:CONS '~G1463 (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS NIL NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '> (CL:CONS 'N (CL:CONS 'I NIL))) NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '== (CL:CONS 'N (CL:CONS 'I NIL))) NIL)) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'N (CL:CONS 'I NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '~G1472 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1472 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1470 NIL)) (CL:CONS '~G1471 (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS T NIL)) NIL)) NIL)))))))))) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '>=))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '<= (CL:CONS (CL:CONS 'N (CL:CONS 'CL:&REST (CL:CONS 'X NIL))) NIL)))) (CL:PROGN (CL:DEFUN <= (N CL:&REST X) (CL:BLOCK <= (CL:BLOCK NIL (CL:BLOCK NIL (CL:LABELS ((G3659 (~G1475) (CL:LABELS ((G3660 (I) (CL:TAGBODY ~G1473 (? (NOT ~G1475) (CL:GO ~G1474)) (CL:SETQ I (CL:CAR ~G1475)) (CL:LABELS ((G3661 (~G1464) (? ~G1464 ~G1464 (CL:LABELS ((G3662 (~G1465) (? ~G1465 ~G1465 (CL:RETURN-FROM NIL NIL)))) (G3662 (< N I)))))) (G3661 (== N I))) (CL:SETQ N I) (CL:SETQ ~G1475 (CL:CDR ~G1475)) (CL:GO ~G1473) ~G1474 (CL:RETURN-FROM NIL (CL:PROGN T))))) (G3660 NIL)))) (G3659 X)))))) (CL:SETF (CL:GETHASH #'<= *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'N (CL:CONS 'CL:&REST (CL:CONS 'X NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '<= (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1475 (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'I (CL:CONS NIL NIL)) NIL)) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1473 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS '~G1475 NIL)) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1474 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'I (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1475 NIL)) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1464 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1464 (CL:CONS '~G1464 (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1465 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1465 (CL:CONS '~G1465 (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS NIL NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '< (CL:CONS 'N (CL:CONS 'I NIL))) NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '== (CL:CONS 'N (CL:CONS 'I NIL))) NIL)) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'N (CL:CONS 'I NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '~G1475 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1475 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1473 NIL)) (CL:CONS '~G1474 (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS T NIL)) NIL)) NIL)))))))))) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '<=))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'CHARACTER>= (CL:CONS (CL:CONS 'X (CL:CONS 'Y NIL)) NIL)))) (CL:PROGN (CL:DEFUN CHARACTER>= (X Y) (CL:BLOCK CHARACTER>= (CL:BLOCK NIL (CL:LABELS ((G3663 (~G1466) (? ~G1466 ~G1466 (CHARACTER> X Y)))) (G3663 (CHARACTER== X Y)))))) (CL:SETF (CL:GETHASH #'CHARACTER>= *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'Y NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'CHARACTER>= (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1466 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1466 (CL:CONS '~G1466 (CL:CONS (CL:CONS 'CHARACTER> (CL:CONS 'X (CL:CONS 'Y NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS 'X (CL:CONS 'Y NIL))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'CHARACTER>=))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'CHARACTER<= (CL:CONS (CL:CONS 'X (CL:CONS 'Y NIL)) NIL)))) (CL:PROGN (CL:DEFUN CHARACTER<= (X Y) (CL:BLOCK CHARACTER<= (CL:BLOCK NIL (CL:LABELS ((G3664 (~G1467) (? ~G1467 ~G1467 (CHARACTER< X Y)))) (G3664 (CHARACTER== X Y)))))) (CL:SETF (CL:GETHASH #'CHARACTER<= *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'Y NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'CHARACTER<= (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1467 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1467 (CL:CONS '~G1467 (CL:CONS (CL:CONS 'CHARACTER< (CL:CONS 'X (CL:CONS 'Y NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS 'X (CL:CONS 'Y NIL))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'CHARACTER<=))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'INTEGER>= (CL:CONS (CL:CONS 'X (CL:CONS 'Y NIL)) NIL)))) (CL:PROGN (CL:DEFUN INTEGER>= (X Y) (CL:BLOCK INTEGER>= (CL:BLOCK NIL (CL:LABELS ((G3665 (~G1468) (? ~G1468 ~G1468 (INTEGER> X Y)))) (G3665 (INTEGER== X Y)))))) (CL:SETF (CL:GETHASH #'INTEGER>= *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'Y NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'INTEGER>= (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1468 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1468 (CL:CONS '~G1468 (CL:CONS (CL:CONS 'INTEGER> (CL:CONS 'X (CL:CONS 'Y NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'INTEGER== (CL:CONS 'X (CL:CONS 'Y NIL))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'INTEGER>=))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'INTEGER<= (CL:CONS (CL:CONS 'X (CL:CONS 'Y NIL)) NIL)))) (CL:PROGN (CL:DEFUN INTEGER<= (X Y) (CL:BLOCK INTEGER<= (CL:BLOCK NIL (CL:LABELS ((G3666 (~G1469) (? ~G1469 ~G1469 (INTEGER< X Y)))) (G3666 (INTEGER== X Y)))))) (CL:SETF (CL:GETHASH #'INTEGER<= *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'Y NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'INTEGER<= (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1469 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1469 (CL:CONS '~G1469 (CL:CONS (CL:CONS 'INTEGER< (CL:CONS 'X (CL:CONS 'Y NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'INTEGER== (CL:CONS 'X (CL:CONS 'Y NIL))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'INTEGER<=))
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'ZERO? (CL:CONS 'EVEN? (CL:CONS 'ODD? (CL:CONS 'END? (CL:CONS 'KEYWORD? NIL))))) *FUNCTIONALS*))
NIL
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'ZERO? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN ZERO? (X) (CL:BLOCK ZERO? (CL:BLOCK NIL (== 0 X)))) (CL:SETF (CL:GETHASH #'ZERO? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'ZERO? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '== (CL:CONS 0 (CL:CONS 'X NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'ZERO?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'EVEN? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN EVEN? (X) (CL:BLOCK EVEN? (CL:BLOCK NIL (== 0 (CL:MOD X 2))))) (CL:SETF (CL:GETHASH #'EVEN? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'EVEN? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '== (CL:CONS 0 (CL:CONS (CL:CONS 'CL:MOD (CL:CONS 'X (CL:CONS 2 NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'EVEN?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'ODD? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN ODD? (X) (CL:BLOCK ODD? (CL:BLOCK NIL (== 1 (CL:MOD X 2))))) (CL:SETF (CL:GETHASH #'ODD? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'ODD? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '== (CL:CONS 1 (CL:CONS (CL:CONS 'CL:MOD (CL:CONS 'X (CL:CONS 2 NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'ODD?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'END? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN END? (X) (CL:BLOCK END? (CL:BLOCK NIL (EQ NIL X)))) (CL:SETF (CL:GETHASH #'END? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'END? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'EQ (CL:CONS NIL (CL:CONS 'X NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'END?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'KEYWORD? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN KEYWORD? (X) (CL:BLOCK KEYWORD? (CL:BLOCK NIL (? (SYMBOL? X) (EQ *KEYWORD-PACKAGE* (SYMBOL-PACKAGE X)))))) (CL:SETF (CL:GETHASH #'KEYWORD? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'KEYWORD? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'SYMBOL? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'EQ (CL:CONS '*KEYWORD-PACKAGE* (CL:CONS (CL:CONS 'SYMBOL-PACKAGE (CL:CONS 'X NIL)) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'KEYWORD?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'SOLE? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN SOLE? (X) (CL:BLOCK SOLE? (CL:BLOCK NIL (== 1 (CL:LENGTH X))))) (CL:SETF (CL:GETHASH #'SOLE? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'SOLE? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '== (CL:CONS 1 (CL:CONS (CL:CONS 'CL:LENGTH (CL:CONS 'X NIL)) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'SOLE?))
NIL
NIL
NIL
NIL
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '%NCONC-0 (CL:CONS (CL:CONS 'LSTS NIL) NIL)))) (CL:PROGN (CL:DEFUN %NCONC-0 (LSTS) (CL:BLOCK %NCONC-0 (CL:BLOCK NIL (? LSTS (CL:PROGN (CL:LABELS ((G3667 (!) (? ! (CL:PROGN (CL:RPLACD (CL:LAST !) (%NCONC-0 (CL:CDR LSTS))) !) (%NCONC-0 (CL:CDR LSTS))))) (G3667 (CL:CAR LSTS)))))))) (CL:SETF (CL:GETHASH #'%NCONC-0 *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'LSTS NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '%NCONC-0 (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS 'LSTS (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'LET (CL:CONS '! (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'LSTS NIL)) (CL:CONS (CL:CONS '? (CL:CONS '! (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:RPLACD (CL:CONS (CL:CONS 'CL:LAST (CL:CONS '! NIL)) (CL:CONS (CL:CONS '%NCONC-0 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'LSTS NIL)) NIL)) NIL))) (CL:CONS '! NIL))) (CL:CONS (CL:CONS '%!? (CL:CONS (CL:CONS '%NCONC-0 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'LSTS NIL)) NIL)) NIL)) NIL)))) NIL)))) NIL)) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '%NCONC-0))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'NCONC (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'LSTS NIL)) NIL)))) (CL:PROGN (CL:DEFUN NCONC (CL:&REST LSTS) (CL:BLOCK NCONC (CL:BLOCK NIL (%NCONC-0 LSTS)))) (CL:SETF (CL:GETHASH #'NCONC *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'LSTS NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'NCONC (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '%NCONC-0 (CL:CONS 'LSTS NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'NCONC))
(CL:BLOCK NIL (%DEFMACRO NCONC! (PLACE CL:&REST LSTS) (CL:BLOCK NCONC! (CL:CONS '= (CL:CONS PLACE (CL:CONS (CL:CONS 'NCONC (CL:CONS PLACE (APPEND LSTS NIL))) NIL))))))
NIL
NIL
(CL:BLOCK NIL (%DEFMACRO APPEND! (PLACE CL:&REST ARGS) (CL:BLOCK APPEND! (CL:CONS '= (CL:CONS PLACE (CL:CONS (CL:CONS 'APPEND (CL:CONS PLACE (APPEND ARGS NIL))) NIL))))))
NIL
NIL
NIL
NIL
NIL
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'QUEUE-LIST (CL:CONS 'QUEUE-FRONT NIL)) *FUNCTIONALS*))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'MAKE-QUEUE (CL:CONS NIL NIL)))) (CL:PROGN (CL:DEFUN MAKE-QUEUE NIL (CL:BLOCK MAKE-QUEUE (CL:BLOCK NIL (CL:CONS NIL NIL)))) (CL:SETF (CL:GETHASH #'MAKE-QUEUE *FUNCTION-ATOM-SOURCES*) (CL:CONS NIL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'MAKE-QUEUE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:CONS (CL:CONS NIL (CL:CONS NIL NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'MAKE-QUEUE))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'ENQUEUE (CL:CONS (CL:CONS 'X (CL:CONS 'CL:&REST (CL:CONS 'VALS NIL))) NIL)))) (CL:PROGN (CL:DEFUN ENQUEUE (X CL:&REST VALS) (CL:BLOCK ENQUEUE (CL:BLOCK NIL (CL:RPLACA X (CL:CDR (CL:RPLACD (CL:LABELS ((G3670 (~G1476) (? ~G1476 ~G1476 X))) (G3670 (CL:CAR X))) VALS))) VALS))) (CL:SETF (CL:GETHASH #'ENQUEUE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'CL:&REST (CL:CONS 'VALS NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'ENQUEUE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:RPLACA (CL:CONS 'X (CL:CONS (CL:CONS 'CL:CDR (CL:CONS (CL:CONS 'CL:RPLACD (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1476 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1476 (CL:CONS '~G1476 (CL:CONS 'X NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) (CL:CONS 'VALS NIL))) NIL)) NIL))) (CL:CONS 'VALS NIL)))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'ENQUEUE))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'ENQUEUE-LIST (CL:CONS (CL:CONS 'X (CL:CONS 'VALS NIL)) NIL)))) (CL:PROGN (CL:DEFUN ENQUEUE-LIST (X VALS) (CL:BLOCK ENQUEUE-LIST (CL:BLOCK NIL (CL:RPLACD X (NCONC (CL:CDR X) VALS)) (CL:RPLACA X (CL:LAST VALS))))) (CL:SETF (CL:GETHASH #'ENQUEUE-LIST *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'VALS NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'ENQUEUE-LIST (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:RPLACD (CL:CONS 'X (CL:CONS (CL:CONS 'NCONC (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) (CL:CONS 'VALS NIL))) NIL))) (CL:CONS (CL:CONS 'CL:RPLACA (CL:CONS 'X (CL:CONS (CL:CONS 'CL:LAST (CL:CONS 'VALS NIL)) NIL))) NIL)))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'ENQUEUE-LIST))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'QUEUE-POP (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN QUEUE-POP (X) (CL:BLOCK QUEUE-POP (CL:BLOCK NIL (CL:LABELS ((G3671 (~G1477) (? (NOT (CL:CDR (CL:CDR X))) (CL:RPLACA X NIL)) (? (CL:CDR X) (CL:RPLACD X (CL:CDR (CL:CDR X)))) ~G1477)) (G3671 (CL:CAR (CL:CDR X))))))) (CL:SETF (CL:GETHASH #'QUEUE-POP *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'QUEUE-POP (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1477 NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS 'CL:CDR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:RPLACA (CL:CONS 'X (CL:CONS NIL NIL))) NIL))) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:RPLACD (CL:CONS 'X (CL:CONS (CL:CONS 'CL:CDR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL)) NIL))) NIL))) (CL:CONS '~G1477 NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'QUEUE-POP))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'QUEUE-LIST (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN QUEUE-LIST (X) (CL:BLOCK QUEUE-LIST (CL:BLOCK NIL (CL:CDR X)))) (CL:SETF (CL:GETHASH #'QUEUE-LIST *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'QUEUE-LIST (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'QUEUE-LIST))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'QUEUE-FRONT (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN QUEUE-FRONT (X) (CL:BLOCK QUEUE-FRONT (CL:BLOCK NIL (CL:CAR (CL:CDR X))))) (CL:SETF (CL:GETHASH #'QUEUE-FRONT *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'QUEUE-FRONT (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'QUEUE-FRONT))
NIL
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS '++ (CL:CONS '-- (CL:CONS 'INTEGER++ (CL:CONS 'INTEGER-- NIL)))) *FUNCTIONALS*))
NIL
(CL:PROGN (CL:DEFUN ++ (X) (NUMBER+ X 1)) (CL:SETF (CL:GETHASH #'++ *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'NUMBER+ (CL:CONS 'X (CL:CONS 1 NIL))) NIL))))
(CL:PROGN (CL:DEFUN -- (X) (NUMBER- X 1)) (CL:SETF (CL:GETHASH #'-- *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'NUMBER- (CL:CONS 'X (CL:CONS 1 NIL))) NIL))))
(CL:PROGN (CL:DEFUN INTEGER++ (X) (INTEGER+ X 1)) (CL:SETF (CL:GETHASH #'INTEGER++ *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'INTEGER+ (CL:CONS 'X (CL:CONS 1 NIL))) NIL))))
(CL:PROGN (CL:DEFUN INTEGER-- (X) (INTEGER- X 1)) (CL:SETF (CL:GETHASH #'INTEGER-- *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'INTEGER- (CL:CONS 'X (CL:CONS 1 NIL))) NIL))))
NIL
NIL
(CL:BLOCK NIL (%DEFMACRO FN (CL:&REST BODY) (CL:BLOCK FN (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '_ NIL) (APPEND (? (? (CONS? (CL:CAR BODY)) (NOT (EQ '%SLOT-VALUE (CL:CAR (CL:CAR BODY))))) BODY (CL:LIST BODY)) NIL)) NIL)))))
(CL:BLOCK NIL (%DEFMACRO SQUARE (CL:&REST BODY) (CL:BLOCK SQUARE (CL:CONS 'FN (APPEND BODY NIL)))))
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'BUTLAST NIL) *FUNCTIONALS*))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'BUTLAST (CL:CONS (CL:CONS 'PLIST NIL) NIL)))) (CL:PROGN (CL:DEFUN BUTLAST (PLIST) (CL:BLOCK BUTLAST (CL:BLOCK NIL (? (CL:CDR PLIST) (CL:CONS (CL:CAR PLIST) (BUTLAST (CL:CDR PLIST))))))) (CL:SETF (CL:GETHASH #'BUTLAST *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'PLIST NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'BUTLAST (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'PLIST NIL)) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'PLIST NIL)) (CL:CONS (CL:CONS 'BUTLAST (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'PLIST NIL)) NIL)) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'BUTLAST))
NIL
NIL
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'VALUES (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'VALS NIL)) NIL)))) (CL:PROGN (CL:DEFUN VALUES (CL:&REST VALS) (CL:BLOCK VALUES (CL:BLOCK NIL (CL:CONS 'VALUES VALS)))) (CL:SETF (CL:GETHASH #'VALUES *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS 'VALS NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'VALUES (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'VALUES NIL)) (CL:CONS 'VALS NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'VALUES))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'VALUES? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN VALUES? (X) (CL:BLOCK VALUES? (CL:BLOCK NIL (? (CONS? X) (EQ 'VALUES (CL:CAR X)))))) (CL:SETF (CL:GETHASH #'VALUES? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'VALUES? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CONS? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'VALUES NIL)) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'VALUES?))
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'RANGE? NIL) *FUNCTIONALS*))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'RANGE? (CL:CONS (CL:CONS 'X (CL:CONS 'BOTTOM (CL:CONS 'TOP NIL))) NIL)))) (CL:PROGN (CL:DEFUN RANGE? (X BOTTOM TOP) (CL:BLOCK RANGE? (CL:BLOCK NIL (? (>= X BOTTOM) (<= X TOP))))) (CL:SETF (CL:GETHASH #'RANGE? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'BOTTOM (CL:CONS 'TOP NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'RANGE? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '>= (CL:CONS 'X (CL:CONS 'BOTTOM NIL))) (CL:CONS (CL:CONS '<= (CL:CONS 'X (CL:CONS 'TOP NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'RANGE?))
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'CHAR-UPCASE (CL:CONS 'CHAR-DOWNCASE (CL:CONS 'CL:CHAR-CODE (CL:CONS 'CODE-CHAR NIL)))) *FUNCTIONALS*))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'CHAR-UPCASE (CL:CONS (CL:CONS 'C NIL) NIL)))) (CL:PROGN (CL:DEFUN CHAR-UPCASE (C) (CL:BLOCK CHAR-UPCASE (CL:BLOCK NIL (? (LOWER-CASE? C) (CHARACTER+ C (CHARACTER- #\A #\a)) C)))) (CL:SETF (CL:GETHASH #'CHAR-UPCASE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'C NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'CHAR-UPCASE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'LOWER-CASE? (CL:CONS 'C NIL)) (CL:CONS (CL:CONS 'CHARACTER+ (CL:CONS 'C (CL:CONS (CL:CONS 'CHARACTER- (CL:CONS #\A (CL:CONS #\a NIL))) NIL))) (CL:CONS 'C NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'CHAR-UPCASE))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'CHAR-DOWNCASE (CL:CONS (CL:CONS 'C NIL) NIL)))) (CL:PROGN (CL:DEFUN CHAR-DOWNCASE (C) (CL:BLOCK CHAR-DOWNCASE (CL:BLOCK NIL (? (UPPER-CASE? C) (CHARACTER+ C (CHARACTER- #\a #\A)) C)))) (CL:SETF (CL:GETHASH #'CHAR-DOWNCASE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'C NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'CHAR-DOWNCASE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'UPPER-CASE? (CL:CONS 'C NIL)) (CL:CONS (CL:CONS 'CHARACTER+ (CL:CONS 'C (CL:CONS (CL:CONS 'CHARACTER- (CL:CONS #\a (CL:CONS #\A NIL))) NIL))) (CL:CONS 'C NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'CHAR-DOWNCASE))
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'LOWER-CASE? (CL:CONS 'UPPER-CASE? (CL:CONS 'ALPHA-CHAR? (CL:CONS 'DIGIT-CHAR? (CL:CONS 'ALPHANUMERIC? NIL))))) *FUNCTIONALS*))
(CL:BLOCK NIL (%DEFMACRO DEF-REST-PREDICATE (NAME ITER ARGS TEST-EXPR) (CL:BLOCK DEF-REST-PREDICATE (CL:LABELS ((G3672 (X) (CL:CONS 'DEFUN (CL:CONS NAME (CL:CONS (CL:CONS 'CL:&REST (CL:CONS X (APPEND ARGS NIL))) (CL:CONS (CL:CONS '@ (CL:CONS (CL:CONS ITER (CL:CONS X (CL:CONS T NIL))) (CL:CONS (CL:CONS '|\|| (CL:CONS TEST-EXPR (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS NIL NIL)) NIL))) NIL))) NIL)))))) (G3672 (GENSYM))))))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'LOWER-CASE? (CL:CONS (CL:CONS 'CL:&REST (CL:CONS '~G1478 NIL)) NIL)))) (CL:PROGN (CL:DEFUN LOWER-CASE? (CL:&REST ~G1478) (CL:BLOCK LOWER-CASE? (CL:BLOCK NIL (CL:BLOCK NIL (CL:LABELS ((G3673 (~G1494) (CL:LABELS ((G3674 (C) (CL:TAGBODY ~G1492 (? (NOT ~G1494) (CL:GO ~G1493)) (CL:SETQ C (CL:CAR ~G1494)) (CL:LABELS ((G3675 (~G1488) (? ~G1488 ~G1488 (CL:RETURN-FROM NIL NIL)))) (G3675 (RANGE? C #\a #\z))) (CL:SETQ ~G1494 (CL:CDR ~G1494)) (CL:GO ~G1492) ~G1493 (CL:RETURN-FROM NIL (CL:PROGN T))))) (G3674 NIL)))) (G3673 ~G1478)))))) (CL:SETF (CL:GETHASH #'LOWER-CASE? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS '~G1478 NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'LOWER-CASE? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1494 (CL:CONS '~G1478 NIL)) (CL:CONS (CL:CONS 'C (CL:CONS NIL NIL)) NIL)) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1492 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS '~G1494 NIL)) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1493 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'C (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1494 NIL)) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1488 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1488 (CL:CONS '~G1488 (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS NIL NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'RANGE? (CL:CONS 'C (CL:CONS #\a (CL:CONS #\z NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '~G1494 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1494 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1492 NIL)) (CL:CONS '~G1493 (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS T NIL)) NIL)) NIL))))))))) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'LOWER-CASE?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'UPPER-CASE? (CL:CONS (CL:CONS 'CL:&REST (CL:CONS '~G1479 NIL)) NIL)))) (CL:PROGN (CL:DEFUN UPPER-CASE? (CL:&REST ~G1479) (CL:BLOCK UPPER-CASE? (CL:BLOCK NIL (CL:BLOCK NIL (CL:LABELS ((G3676 (~G1497) (CL:LABELS ((G3677 (C) (CL:TAGBODY ~G1495 (? (NOT ~G1497) (CL:GO ~G1496)) (CL:SETQ C (CL:CAR ~G1497)) (CL:LABELS ((G3678 (~G1489) (? ~G1489 ~G1489 (CL:RETURN-FROM NIL NIL)))) (G3678 (RANGE? C #\A #\Z))) (CL:SETQ ~G1497 (CL:CDR ~G1497)) (CL:GO ~G1495) ~G1496 (CL:RETURN-FROM NIL (CL:PROGN T))))) (G3677 NIL)))) (G3676 ~G1479)))))) (CL:SETF (CL:GETHASH #'UPPER-CASE? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS '~G1479 NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'UPPER-CASE? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1497 (CL:CONS '~G1479 NIL)) (CL:CONS (CL:CONS 'C (CL:CONS NIL NIL)) NIL)) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1495 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS '~G1497 NIL)) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1496 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'C (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1497 NIL)) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1489 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1489 (CL:CONS '~G1489 (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS NIL NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'RANGE? (CL:CONS 'C (CL:CONS #\A (CL:CONS #\Z NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '~G1497 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1497 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1495 NIL)) (CL:CONS '~G1496 (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS T NIL)) NIL)) NIL))))))))) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'UPPER-CASE?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'ALPHA-CHAR? (CL:CONS (CL:CONS 'CL:&REST (CL:CONS '~G1481 NIL)) NIL)))) (CL:PROGN (CL:DEFUN ALPHA-CHAR? (CL:&REST ~G1481) (CL:BLOCK ALPHA-CHAR? (CL:BLOCK NIL (CL:BLOCK NIL (CL:LABELS ((G3679 (~G1500) (CL:LABELS ((G3680 (C) (CL:TAGBODY ~G1498 (? (NOT ~G1500) (CL:GO ~G1499)) (CL:SETQ C (CL:CAR ~G1500)) (CL:LABELS ((G3681 (~G1490) (? ~G1490 ~G1490 (CL:RETURN-FROM NIL NIL)))) (G3681 (CL:LABELS ((G3682 (~G1480) (? ~G1480 ~G1480 (UPPER-CASE? C)))) (G3682 (LOWER-CASE? C))))) (CL:SETQ ~G1500 (CL:CDR ~G1500)) (CL:GO ~G1498) ~G1499 (CL:RETURN-FROM NIL (CL:PROGN T))))) (G3680 NIL)))) (G3679 ~G1481)))))) (CL:SETF (CL:GETHASH #'ALPHA-CHAR? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS '~G1481 NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'ALPHA-CHAR? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1500 (CL:CONS '~G1481 NIL)) (CL:CONS (CL:CONS 'C (CL:CONS NIL NIL)) NIL)) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1498 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS '~G1500 NIL)) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1499 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'C (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1500 NIL)) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1490 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1490 (CL:CONS '~G1490 (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS NIL NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1480 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1480 (CL:CONS '~G1480 (CL:CONS (CL:CONS 'UPPER-CASE? (CL:CONS 'C NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'LOWER-CASE? (CL:CONS 'C NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '~G1500 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1500 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1498 NIL)) (CL:CONS '~G1499 (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS T NIL)) NIL)) NIL))))))))) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'ALPHA-CHAR?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'DECIMAL-DIGIT? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN DECIMAL-DIGIT? (X) (CL:BLOCK DECIMAL-DIGIT? (CL:BLOCK NIL (RANGE? X #\0 #\9)))) (CL:SETF (CL:GETHASH #'DECIMAL-DIGIT? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'DECIMAL-DIGIT? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'RANGE? (CL:CONS 'X (CL:CONS #\0 (CL:CONS #\9 NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'DECIMAL-DIGIT?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '%NONDECIMAL-DIGIT? (CL:CONS (CL:CONS 'X (CL:CONS 'START (CL:CONS 'BASE NIL))) NIL)))) (CL:PROGN (CL:DEFUN %NONDECIMAL-DIGIT? (X START BASE) (CL:BLOCK %NONDECIMAL-DIGIT? (CL:BLOCK NIL (RANGE? X START (CHARACTER+ START (CHARACTER- BASE 10)))))) (CL:SETF (CL:GETHASH #'%NONDECIMAL-DIGIT? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'START (CL:CONS 'BASE NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '%NONDECIMAL-DIGIT? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'RANGE? (CL:CONS 'X (CL:CONS 'START (CL:CONS (CL:CONS 'CHARACTER+ (CL:CONS 'START (CL:CONS (CL:CONS 'CHARACTER- (CL:CONS 'BASE (CL:CONS 10 NIL))) NIL))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '%NONDECIMAL-DIGIT?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'NONDECIMAL-DIGIT? (CL:CONS (CL:CONS 'X (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'BASE (CL:CONS 10 NIL)) NIL))) NIL)))) (CL:PROGN (CL:DEFUN NONDECIMAL-DIGIT? (X CL:&KEY (BASE 10)) (CL:BLOCK NONDECIMAL-DIGIT? (CL:BLOCK NIL (? (< 10 BASE) (CL:LABELS ((G3683 (~G1482) (? ~G1482 ~G1482 (%NONDECIMAL-DIGIT? X #\A BASE)))) (G3683 (%NONDECIMAL-DIGIT? X #\a BASE))))))) (CL:SETF (CL:GETHASH #'NONDECIMAL-DIGIT? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'BASE (CL:CONS 10 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'NONDECIMAL-DIGIT? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '< (CL:CONS 10 (CL:CONS 'BASE NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1482 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1482 (CL:CONS '~G1482 (CL:CONS (CL:CONS '%NONDECIMAL-DIGIT? (CL:CONS 'X (CL:CONS #\A (CL:CONS 'BASE NIL)))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '%NONDECIMAL-DIGIT? (CL:CONS 'X (CL:CONS #\a (CL:CONS 'BASE NIL)))) NIL)) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'NONDECIMAL-DIGIT?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'DIGIT-CHAR? (CL:CONS (CL:CONS 'C (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'BASE (CL:CONS 10 NIL)) NIL))) NIL)))) (CL:PROGN (CL:DEFUN DIGIT-CHAR? (C CL:&KEY (BASE 10)) (CL:BLOCK DIGIT-CHAR? (CL:BLOCK NIL (? (CHARACTER? C) (CL:LABELS ((G3684 (~G1483) (? ~G1483 ~G1483 (NONDECIMAL-DIGIT? C :BASE BASE)))) (G3684 (DECIMAL-DIGIT? C))))))) (CL:SETF (CL:GETHASH #'DIGIT-CHAR? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'C (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'BASE (CL:CONS 10 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'DIGIT-CHAR? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CHARACTER? (CL:CONS 'C NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1483 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1483 (CL:CONS '~G1483 (CL:CONS (CL:CONS 'NONDECIMAL-DIGIT? (CL:CONS 'C (CL:CONS ':BASE (CL:CONS 'BASE NIL)))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'DECIMAL-DIGIT? (CL:CONS 'C NIL)) NIL)) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'DIGIT-CHAR?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'HEX-DIGIT-CHAR? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN HEX-DIGIT-CHAR? (X) (CL:BLOCK HEX-DIGIT-CHAR? (CL:BLOCK NIL (CL:LABELS ((G3685 (~G1484) (? ~G1484 ~G1484 (CL:LABELS ((G3686 (~G1485) (? ~G1485 ~G1485 (? (>= X #\a) (<= X #\f))))) (G3686 (? (>= X #\A) (<= X #\F))))))) (G3685 (DIGIT-CHAR? X)))))) (CL:SETF (CL:GETHASH #'HEX-DIGIT-CHAR? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'HEX-DIGIT-CHAR? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1484 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1484 (CL:CONS '~G1484 (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1485 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1485 (CL:CONS '~G1485 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '>= (CL:CONS 'X (CL:CONS #\a NIL))) (CL:CONS (CL:CONS '<= (CL:CONS 'X (CL:CONS #\f NIL))) NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '>= (CL:CONS 'X (CL:CONS #\A NIL))) (CL:CONS (CL:CONS '<= (CL:CONS 'X (CL:CONS #\F NIL))) NIL))) NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'DIGIT-CHAR? (CL:CONS 'X NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'HEX-DIGIT-CHAR?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'ALPHANUMERIC? (CL:CONS (CL:CONS 'CL:&REST (CL:CONS '~G1487 NIL)) NIL)))) (CL:PROGN (CL:DEFUN ALPHANUMERIC? (CL:&REST ~G1487) (CL:BLOCK ALPHANUMERIC? (CL:BLOCK NIL (CL:BLOCK NIL (CL:LABELS ((G3687 (~G1503) (CL:LABELS ((G3688 (C) (CL:TAGBODY ~G1501 (? (NOT ~G1503) (CL:GO ~G1502)) (CL:SETQ C (CL:CAR ~G1503)) (CL:LABELS ((G3689 (~G1491) (? ~G1491 ~G1491 (CL:RETURN-FROM NIL NIL)))) (G3689 (CL:LABELS ((G3690 (~G1486) (? ~G1486 ~G1486 (DIGIT-CHAR? C)))) (G3690 (ALPHA-CHAR? C))))) (CL:SETQ ~G1503 (CL:CDR ~G1503)) (CL:GO ~G1501) ~G1502 (CL:RETURN-FROM NIL (CL:PROGN T))))) (G3688 NIL)))) (G3687 ~G1487)))))) (CL:SETF (CL:GETHASH #'ALPHANUMERIC? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&REST (CL:CONS '~G1487 NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'ALPHANUMERIC? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1503 (CL:CONS '~G1487 NIL)) (CL:CONS (CL:CONS 'C (CL:CONS NIL NIL)) NIL)) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1501 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS '~G1503 NIL)) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1502 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'C (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1503 NIL)) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1491 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1491 (CL:CONS '~G1491 (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS NIL NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1486 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1486 (CL:CONS '~G1486 (CL:CONS (CL:CONS 'DIGIT-CHAR? (CL:CONS 'C NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'ALPHA-CHAR? (CL:CONS 'C NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '~G1503 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1503 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1501 NIL)) (CL:CONS '~G1502 (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS T NIL)) NIL)) NIL))))))))) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'ALPHANUMERIC?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'WHITESPACE? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN WHITESPACE? (X) (CL:BLOCK WHITESPACE? (CL:BLOCK NIL (? (< X 33) (>= X 0))))) (CL:SETF (CL:GETHASH #'WHITESPACE? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'WHITESPACE? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '< (CL:CONS 'X (CL:CONS 33 NIL))) (CL:CONS (CL:CONS '>= (CL:CONS 'X (CL:CONS 0 NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'WHITESPACE?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'CONTROL-CHAR? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN CONTROL-CHAR? (X) (CL:BLOCK CONTROL-CHAR? (CL:BLOCK NIL (< X 32)))) (CL:SETF (CL:GETHASH #'CONTROL-CHAR? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'CONTROL-CHAR? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '< (CL:CONS 'X (CL:CONS 32 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'CONTROL-CHAR?))
NIL
NIL
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STRING-CONCAT (CL:CONS 'STRING== (CL:CONS 'UPCASE (CL:CONS 'DOWNCASE (CL:CONS 'LIST-STRING (CL:CONS 'STRING-LIST (CL:CONS 'QUEUE-STRING NIL))))))) *FUNCTIONALS*))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STRING<= (CL:CONS (CL:CONS 'A (CL:CONS 'B NIL)) NIL)))) (CL:PROGN (CL:DEFUN STRING<= (A B) (CL:BLOCK STRING<= (CL:BLOCK NIL (CL:LABELS ((G3691 (LA) (CL:LABELS ((G3692 (LB) (CL:LABELS ((G3693 (~G1504) (CL:BLOCK NIL (CL:LABELS ((G3694 (I) (CL:TAGBODY ~G1506 (? (INTEGER== I ~G1504) (CL:RETURN-FROM NIL (CL:PROGN (<= LA LB)))) (? (> (CL:ELT A I) (CL:ELT B I)) (CL:RETURN-FROM NIL NIL)) (CL:SETQ I (INTEGER+ 1 I)) (CL:GO ~G1506)))) (G3694 0))))) (G3693 (INTEGER LA))))) (G3692 (CL:LENGTH B))))) (G3691 (CL:LENGTH A)))))) (CL:SETF (CL:GETHASH #'STRING<= *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'A (CL:CONS 'B NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STRING<= (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'LA NIL) (CL:CONS (CL:CONS 'LET (CL:CONS 'LB (CL:CONS (CL:CONS 'CL:LENGTH (CL:CONS 'B NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1504 NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'I (CL:CONS 0 NIL)) NIL) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1506 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'INTEGER== (CL:CONS 'I (CL:CONS '~G1504 NIL))) (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '<= (CL:CONS 'LA (CL:CONS 'LB NIL))) NIL)) NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '> (CL:CONS (CL:CONS 'CL:ELT (CL:CONS 'A (CL:CONS 'I NIL))) (CL:CONS (CL:CONS 'CL:ELT (CL:CONS 'B (CL:CONS 'I NIL))) NIL))) (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS NIL NIL))) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'I (CL:CONS (CL:CONS 'INTEGER+ (CL:CONS 1 (CL:CONS 'I NIL))) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1506 NIL)) NIL)))))) NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'INTEGER (CL:CONS 'LA NIL)) NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:LENGTH (CL:CONS 'A NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STRING<=))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STRING-LIST (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN STRING-LIST (X) (CL:BLOCK STRING-LIST (CL:BLOCK NIL (CL:LABELS ((G3695 (L) (CL:LABELS ((G3696 (S) (CL:BLOCK NIL (CL:LABELS ((G3697 (I) (CL:TAGBODY ~G1505 (? (< I 0) (CL:RETURN-FROM NIL (CL:PROGN))) (CL:PROGN (CL:SETQ S (CL:PROGN (CL:SETQ S (CL:CONS (CL:ELT X I) S))))) (CL:SETQ I (-- I)) (CL:GO ~G1505)))) (G3697 (-- L)))) S)) (G3696 NIL)))) (G3695 (CL:LENGTH X)))))) (CL:SETF (CL:GETHASH #'STRING-LIST *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STRING-LIST (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'L NIL) (CL:CONS (CL:CONS 'LET (CL:CONS 'S (CL:CONS NIL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET (CL:CONS 'I (CL:CONS (CL:CONS '-- (CL:CONS 'L NIL)) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1505 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '< (CL:CONS 'I (CL:CONS 0 NIL))) (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN NIL) NIL))) NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'S (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'S (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'CL:ELT (CL:CONS 'X (CL:CONS 'I NIL))) (CL:CONS 'S NIL))) NIL))) NIL)) NIL))) NIL)) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'I (CL:CONS (CL:CONS '-- (CL:CONS 'I NIL)) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1505 NIL)) NIL)))))) NIL)))) NIL))) (CL:CONS 'S NIL))))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:LENGTH (CL:CONS 'X NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STRING-LIST))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'QUEUE-STRING (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN QUEUE-STRING (X) (CL:BLOCK QUEUE-STRING (CL:BLOCK NIL (CL:APPLY #'STRING-CONCAT (CL:MAPCAR #'(CL:LAMBDA (_) (? (STRING? _) _ (CHARACTER? _) (STRING _))) (QUEUE-LIST X)))))) (CL:SETF (CL:GETHASH #'QUEUE-STRING *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'QUEUE-STRING (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'STRING-CONCAT NIL)) (CL:CONS (CL:CONS 'CL:MAPCAR (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '_ NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'STRING? (CL:CONS '_ NIL)) (CL:CONS '_ (CL:CONS (CL:CONS 'CHARACTER? (CL:CONS '_ NIL)) (CL:CONS (CL:CONS 'STRING (CL:CONS '_ NIL)) NIL))))) NIL)) NIL)) (CL:CONS (CL:CONS 'QUEUE-LIST (CL:CONS 'X NIL)) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'QUEUE-STRING))
NIL
NIL
NIL
NIL
NIL
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'LIST-SYMBOL NIL) *FUNCTIONALS*))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'LIST-SYMBOL (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN LIST-SYMBOL (X) (CL:BLOCK LIST-SYMBOL (CL:BLOCK NIL (MAKE-SYMBOL (LIST-STRING X))))) (CL:SETF (CL:GETHASH #'LIST-SYMBOL *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'LIST-SYMBOL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'MAKE-SYMBOL (CL:CONS (CL:CONS 'LIST-STRING (CL:CONS 'X NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'LIST-SYMBOL))
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'SUBSEQ NIL) *FUNCTIONALS*))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'LIST-SUBSEQ (CL:CONS (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'END (CL:CONS 999999 NIL)) NIL)))) NIL)))) (CL:PROGN (CL:DEFUN LIST-SUBSEQ (SEQ START CL:&OPTIONAL (END 999999)) (CL:BLOCK LIST-SUBSEQ (CL:BLOCK NIL (? (? SEQ (NOT (== START END))) (CL:PROGN (? (> START END) (CL:LABELS ((G3698 (~G1507) (CL:PROGN (CL:SETQ START END) (CL:SETQ END ~G1507)))) (G3698 START))) (CL:LABELS ((COPY-NUM (LST LEN) (? LST (? (< 0 LEN) (CL:CONS (CL:CAR LST) (COPY-NUM (CL:CDR LST) (-- LEN))))))) (COPY-NUM (CL:NTHCDR START SEQ) (- END START)))))))) (CL:SETF (CL:GETHASH #'LIST-SUBSEQ *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'END (CL:CONS 999999 NIL)) NIL)))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'LIST-SUBSEQ (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '? (CL:CONS 'SEQ (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS '== (CL:CONS 'START (CL:CONS 'END NIL))) NIL)) NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '> (CL:CONS 'START (CL:CONS 'END NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1507 NIL) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'START (CL:CONS 'END NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'END (CL:CONS '~G1507 NIL))) NIL))) NIL)) NIL)) (CL:CONS 'START NIL)) NIL))) (CL:CONS (CL:CONS 'CL:LABELS (CL:CONS (CL:CONS (CL:CONS 'COPY-NUM (CL:CONS (CL:CONS 'LST (CL:CONS 'LEN NIL)) (CL:CONS (CL:CONS '? (CL:CONS 'LST (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '< (CL:CONS 0 (CL:CONS 'LEN NIL))) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'LST NIL)) (CL:CONS (CL:CONS 'COPY-NUM (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'LST NIL)) (CL:CONS (CL:CONS '-- (CL:CONS 'LEN NIL)) NIL))) NIL))) NIL))) NIL))) NIL))) NIL) (CL:CONS (CL:CONS 'COPY-NUM (CL:CONS (CL:CONS 'CL:NTHCDR (CL:CONS 'START (CL:CONS 'SEQ NIL))) (CL:CONS (CL:CONS '- (CL:CONS 'END (CL:CONS 'START NIL))) NIL))) NIL))) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'LIST-SUBSEQ))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '%SUBSEQ-SEQUENCE (CL:CONS (CL:CONS 'MAKER (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'END NIL)))) NIL)))) (CL:PROGN (CL:DEFUN %SUBSEQ-SEQUENCE (MAKER SEQ START END) (CL:BLOCK %SUBSEQ-SEQUENCE (CL:BLOCK NIL (? (NOT (== START END)) (CL:PROGN (CL:LABELS ((G3699 (!) (? (< START !) (CL:PROGN (? (>= END !) (CL:PROGN (CL:SETQ END !))) (CL:LABELS ((G3700 (L) (CL:LABELS ((G3701 (S) (CL:LABELS ((G3702 (~G1508) (CL:BLOCK NIL (CL:LABELS ((G3703 (X) (CL:TAGBODY ~G1511 (? (INTEGER== X ~G1508) (CL:RETURN-FROM NIL (CL:PROGN S))) (CL:PROGN (=-ELT (CL:ELT SEQ (+ START X)) S X)) (CL:SETQ X (INTEGER+ 1 X)) (CL:GO ~G1511)))) (G3703 0))))) (G3702 (INTEGER L))))) (G3701 (FUNCALL MAKER L))))) (G3700 (- END START))))))) (G3699 (CL:LENGTH SEQ)))))))) (CL:SETF (CL:GETHASH #'%SUBSEQ-SEQUENCE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'MAKER (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'END NIL)))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '%SUBSEQ-SEQUENCE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '& (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS '== (CL:CONS 'START (CL:CONS 'END NIL))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '< (CL:CONS 'START (CL:CONS '! NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '>= (CL:CONS 'END (CL:CONS '! NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'END (CL:CONS '! NIL))) NIL)) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'L NIL) (CL:CONS (CL:CONS 'LET (CL:CONS 'S (CL:CONS (CL:CONS 'FUNCALL (CL:CONS 'MAKER (CL:CONS 'L NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1508 NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'X (CL:CONS 0 NIL)) NIL) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1511 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'INTEGER== (CL:CONS 'X (CL:CONS '~G1508 NIL))) (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS 'S NIL)) NIL)) NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-ELT (CL:CONS (CL:CONS 'CL:ELT (CL:CONS 'SEQ (CL:CONS (CL:CONS '+ (CL:CONS 'START (CL:CONS 'X NIL))) NIL))) (CL:CONS 'S (CL:CONS 'X NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'X (CL:CONS (CL:CONS 'INTEGER+ (CL:CONS 1 (CL:CONS 'X NIL))) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1511 NIL)) NIL)))))) NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'INTEGER (CL:CONS 'L NIL)) NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '- (CL:CONS 'END (CL:CONS 'START NIL))) NIL)) NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:LENGTH (CL:CONS 'SEQ NIL)) NIL)) NIL)) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '%SUBSEQ-SEQUENCE))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'SUBSEQ (CL:CONS (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'END (CL:CONS 99999 NIL)) NIL)))) NIL)))) (CL:PROGN (CL:DEFUN SUBSEQ (SEQ START CL:&OPTIONAL (END 99999)) (CL:BLOCK SUBSEQ (CL:BLOCK NIL (? SEQ (CL:PROGN (? (> START END) (CL:LABELS ((G3704 (~G1509) (CL:PROGN (CL:SETQ START END) (CL:SETQ END ~G1509)))) (G3704 START))) (CL:LABELS ((G3705 (~G1510) (? (CONS? ~G1510) (LIST-SUBSEQ SEQ START END) (STRING? ~G1510) (STRING-SUBSEQ SEQ START END) (ARRAY? ~G1510) (%SUBSEQ-SEQUENCE #'MAKE-ARRAY SEQ START END) (ERROR "Type of ~A not supported." SEQ)))) (G3705 SEQ))))))) (CL:SETF (CL:GETHASH #'SUBSEQ *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'END (CL:CONS 99999 NIL)) NIL)))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'SUBSEQ (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS 'SEQ (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '> (CL:CONS 'START (CL:CONS 'END NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1509 NIL) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'START (CL:CONS 'END NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'END (CL:CONS '~G1509 NIL))) NIL))) NIL)) NIL)) (CL:CONS 'START NIL)) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1510 NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CONS? (CL:CONS '~G1510 NIL)) (CL:CONS (CL:CONS 'LIST-SUBSEQ (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'END NIL)))) (CL:CONS (CL:CONS 'STRING? (CL:CONS '~G1510 NIL)) (CL:CONS (CL:CONS 'STRING-SUBSEQ (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'END NIL)))) (CL:CONS (CL:CONS 'ARRAY? (CL:CONS '~G1510 NIL)) (CL:CONS (CL:CONS '%SUBSEQ-SEQUENCE (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'MAKE-ARRAY NIL)) (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'END NIL))))) (CL:CONS (CL:CONS 'ERROR (CL:CONS "Type of ~A not supported." (CL:CONS 'SEQ NIL))) NIL)))))))) NIL)) NIL)) (CL:CONS 'SEQ NIL)) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'SUBSEQ))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STRING-SUBSEQ (CL:CONS (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'END (CL:CONS 99999 NIL)) NIL)))) NIL)))) (CL:PROGN (CL:DEFUN STRING-SUBSEQ (SEQ START CL:&OPTIONAL (END 99999)) (CL:BLOCK STRING-SUBSEQ (CL:BLOCK NIL (? (== START END) "" (CL:LABELS ((G3706 (SEQLEN) (? (< START SEQLEN) (CL:PROGN (? (>= END SEQLEN) (CL:PROGN (CL:PROGN (CL:SETQ END SEQLEN)))) (CL:LABELS ((G3707 (L) (CL:LABELS ((G3708 (S) (CL:LABELS ((G3709 (~G1512) (CL:BLOCK NIL (CL:LABELS ((G3710 (X) (CL:TAGBODY ~G1513 (? (INTEGER== X ~G1512) (CL:RETURN-FROM NIL (CL:PROGN S))) (CL:PROGN (CL:SETQ S (+ S (STRING (CL:ELT SEQ (+ START X)))))) (CL:SETQ X (INTEGER+ 1 X)) (CL:GO ~G1513)))) (G3710 0))))) (G3709 (INTEGER L))))) (G3708 (CL:MAKE-STRING 0))))) (G3707 (- END START))))))) (G3706 (CL:LENGTH SEQ))))))) (CL:SETF (CL:GETHASH #'STRING-SUBSEQ *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'END (CL:CONS 99999 NIL)) NIL)))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STRING-SUBSEQ (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS 'START (CL:CONS 'END NIL))) (CL:CONS "" (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'SEQLEN NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '< (CL:CONS 'START (CL:CONS 'SEQLEN NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '>= (CL:CONS 'END (CL:CONS 'SEQLEN NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'END (CL:CONS 'SEQLEN NIL))) NIL)) NIL)) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'L NIL) (CL:CONS (CL:CONS 'LET (CL:CONS 'S (CL:CONS (CL:CONS 'CL:MAKE-STRING (CL:CONS 0 NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1512 NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'X (CL:CONS 0 NIL)) NIL) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1513 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'INTEGER== (CL:CONS 'X (CL:CONS '~G1512 NIL))) (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS 'S NIL)) NIL)) NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'S (CL:CONS (CL:CONS '+ (CL:CONS 'S (CL:CONS (CL:CONS 'STRING (CL:CONS (CL:CONS 'CL:ELT (CL:CONS 'SEQ (CL:CONS (CL:CONS '+ (CL:CONS 'START (CL:CONS 'X NIL))) NIL))) NIL)) NIL))) NIL))) NIL)) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'X (CL:CONS (CL:CONS 'INTEGER+ (CL:CONS 1 (CL:CONS 'X NIL))) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1513 NIL)) NIL)))))) NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'INTEGER (CL:CONS 'L NIL)) NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '- (CL:CONS 'END (CL:CONS 'START NIL))) NIL)) NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:LENGTH (CL:CONS 'SEQ NIL)) NIL)) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STRING-SUBSEQ))
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'FIND (CL:CONS 'POSITION NIL)) *FUNCTIONALS*))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '%FIND-IF-LIST (CL:CONS (CL:CONS 'PRED (CL:CONS 'SEQ (CL:CONS 'FROM-END (CL:CONS 'WITH-INDEX NIL)))) NIL)))) (CL:PROGN (CL:DEFUN %FIND-IF-LIST (PRED SEQ FROM-END WITH-INDEX) (CL:BLOCK %FIND-IF-LIST (CL:BLOCK NIL (CL:LABELS ((G3711 (!) (? WITH-INDEX (CL:LABELS ((G3712 (IDX) (CL:BLOCK NIL (CL:LABELS ((G3713 (~G1522) (CL:LABELS ((G3714 (!) (CL:TAGBODY ~G1520 (? (NOT ~G1522) (CL:GO ~G1521)) (CL:SETQ ! (CL:CAR ~G1522)) (? (FUNCALL PRED ! IDX) (CL:RETURN-FROM NIL !)) (CL:PROGN (CL:SETQ IDX (NUMBER+ IDX 1))) (CL:SETQ ~G1522 (CL:CDR ~G1522)) (CL:GO ~G1520) ~G1521 (CL:RETURN-FROM NIL (CL:PROGN NIL))))) (G3714 NIL)))) (G3713 !))))) (G3712 0)) (CL:BLOCK NIL (CL:LABELS ((G3715 (~G1525) (CL:LABELS ((G3716 (!) (CL:TAGBODY ~G1523 (? (NOT ~G1525) (CL:GO ~G1524)) (CL:SETQ ! (CL:CAR ~G1525)) (? (FUNCALL PRED !) (CL:RETURN-FROM NIL !)) (CL:SETQ ~G1525 (CL:CDR ~G1525)) (CL:GO ~G1523) ~G1524 (CL:RETURN-FROM NIL (CL:PROGN NIL))))) (G3716 NIL)))) (G3715 !)))))) (G3711 (? FROM-END (REVERSE SEQ) SEQ)))))) (CL:SETF (CL:GETHASH #'%FIND-IF-LIST *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'PRED (CL:CONS 'SEQ (CL:CONS 'FROM-END (CL:CONS 'WITH-INDEX NIL)))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '%FIND-IF-LIST (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '? (CL:CONS 'WITH-INDEX (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'IDX NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1522 (CL:CONS '! NIL)) (CL:CONS (CL:CONS '! (CL:CONS NIL NIL)) NIL)) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1520 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS '~G1522 NIL)) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1521 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '! (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1522 NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'FUNCALL (CL:CONS 'PRED (CL:CONS '! (CL:CONS 'IDX NIL)))) (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS '! NIL))) NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'IDX (CL:CONS (CL:CONS 'NUMBER+ (CL:CONS 'IDX (CL:CONS 1 NIL))) NIL))) NIL)) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '~G1522 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1522 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1520 NIL)) (CL:CONS '~G1521 (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS NIL NIL)) NIL)) NIL)))))))))) NIL))) NIL))) NIL)) NIL)) (CL:CONS 0 NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1525 (CL:CONS '! NIL)) (CL:CONS (CL:CONS '! (CL:CONS NIL NIL)) NIL)) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1523 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS '~G1525 NIL)) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1524 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '! (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1525 NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'FUNCALL (CL:CONS 'PRED (CL:CONS '! NIL))) (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS '! NIL))) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '~G1525 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1525 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1523 NIL)) (CL:CONS '~G1524 (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS NIL NIL)) NIL)) NIL))))))))) NIL))) NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '? (CL:CONS 'FROM-END (CL:CONS (CL:CONS 'REVERSE (CL:CONS 'SEQ NIL)) (CL:CONS 'SEQ NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '%FIND-IF-LIST))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '%FIND-IF-SEQUENCE (CL:CONS (CL:CONS 'PRED (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'END (CL:CONS 'FROM-END (CL:CONS 'WITH-INDEX NIL)))))) NIL)))) (CL:PROGN (CL:DEFUN %FIND-IF-SEQUENCE (PRED SEQ START END FROM-END WITH-INDEX) (CL:BLOCK %FIND-IF-SEQUENCE (CL:BLOCK NIL (? SEQ (? (< 0 (CL:LENGTH SEQ)) (CL:LABELS ((G3717 (E) (CL:LABELS ((G3718 (S) (? (CL:LABELS ((G3719 (~G1516) (? ~G1516 ~G1516 (? (< S E) FROM-END)))) (G3719 (? (> S E) (NOT FROM-END)))) (CL:LABELS ((G3720 (~G1517) (CL:PROGN (CL:SETQ S E) (CL:SETQ E ~G1517)))) (G3720 S))) (CL:BLOCK NIL (CL:LABELS ((G3721 (I) (CL:TAGBODY ~G1518 (? (? FROM-END (< I E) (> I E)) (CL:RETURN-FROM NIL (CL:PROGN))) (CL:LABELS ((G3722 (!) (? (CL:APPLY PRED (CL:CONS ! (? WITH-INDEX (CL:LIST I)))) (CL:RETURN-FROM NIL !)))) (G3722 (CL:ELT SEQ I))) (CL:SETQ I (? FROM-END (-- I) (++ I))) (CL:GO ~G1518)))) (G3721 S))))) (G3718 (CL:LABELS ((G3723 (~G1515) (? ~G1515 ~G1515 0))) (G3723 START)))))) (G3717 (CL:LABELS ((G3724 (~G1514) (? ~G1514 ~G1514 (-- (CL:LENGTH SEQ))))) (G3724 END))))))))) (CL:SETF (CL:GETHASH #'%FIND-IF-SEQUENCE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'PRED (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'END (CL:CONS 'FROM-END (CL:CONS 'WITH-INDEX NIL)))))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '%FIND-IF-SEQUENCE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS 'SEQ (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '< (CL:CONS 0 (CL:CONS (CL:CONS 'CL:LENGTH (CL:CONS 'SEQ NIL)) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'E NIL) (CL:CONS (CL:CONS 'LET (CL:CONS 'S (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1515 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1515 (CL:CONS '~G1515 (CL:CONS 0 NIL)))) NIL)) NIL)) (CL:CONS 'START NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1516 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1516 (CL:CONS '~G1516 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '< (CL:CONS 'S (CL:CONS 'E NIL))) (CL:CONS 'FROM-END NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '> (CL:CONS 'S (CL:CONS 'E NIL))) (CL:CONS (CL:CONS 'NOT (CL:CONS 'FROM-END NIL)) NIL))) NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1517 NIL) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'S (CL:CONS 'E NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'E (CL:CONS '~G1517 NIL))) NIL))) NIL)) NIL)) (CL:CONS 'S NIL)) NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET (CL:CONS 'I (CL:CONS 'S (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1518 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '? (CL:CONS 'FROM-END (CL:CONS (CL:CONS '< (CL:CONS 'I (CL:CONS 'E NIL))) (CL:CONS (CL:CONS '> (CL:CONS 'I (CL:CONS 'E NIL))) NIL)))) (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN NIL) NIL))) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS 'PRED (CL:CONS (CL:CONS 'CL:CONS (CL:CONS '! (CL:CONS (CL:CONS '? (CL:CONS 'WITH-INDEX (CL:CONS (CL:CONS 'CL:LIST (CL:CONS 'I NIL)) NIL))) NIL))) NIL))) (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS '! NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:ELT (CL:CONS 'SEQ (CL:CONS 'I NIL))) NIL)) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'I (CL:CONS (CL:CONS '? (CL:CONS 'FROM-END (CL:CONS (CL:CONS '-- (CL:CONS 'I NIL)) (CL:CONS (CL:CONS '++ (CL:CONS 'I NIL)) NIL)))) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1518 NIL)) NIL)))))) NIL)))) NIL))) NIL))))) NIL)) NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1514 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1514 (CL:CONS '~G1514 (CL:CONS (CL:CONS '-- (CL:CONS (CL:CONS 'CL:LENGTH (CL:CONS 'SEQ NIL)) NIL)) NIL)))) NIL)) NIL)) (CL:CONS 'END NIL)) NIL)) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '%FIND-IF-SEQUENCE))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'FIND-IF (CL:CONS (CL:CONS 'PRED (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'START (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'FROM-END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'WITH-INDEX (CL:CONS NIL NIL)) NIL))))))) NIL)))) (CL:PROGN (CL:DEFUN FIND-IF (PRED SEQ CL:&KEY (START NIL) (END NIL) (FROM-END NIL) (WITH-INDEX NIL)) (CL:BLOCK FIND-IF (CL:BLOCK NIL (? (NOT (CL:ATOM SEQ) START END) (%FIND-IF-LIST PRED SEQ FROM-END WITH-INDEX) (%FIND-IF-SEQUENCE PRED SEQ START END FROM-END WITH-INDEX))))) (CL:SETF (CL:GETHASH #'FIND-IF *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'PRED (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'START (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'FROM-END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'WITH-INDEX (CL:CONS NIL NIL)) NIL))))))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'FIND-IF (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS 'CL:ATOM (CL:CONS 'SEQ NIL)) (CL:CONS 'START (CL:CONS 'END NIL)))) (CL:CONS (CL:CONS '%FIND-IF-LIST (CL:CONS 'PRED (CL:CONS 'SEQ (CL:CONS 'FROM-END (CL:CONS 'WITH-INDEX NIL))))) (CL:CONS (CL:CONS '%FIND-IF-SEQUENCE (CL:CONS 'PRED (CL:CONS 'SEQ (CL:CONS 'START (CL:CONS 'END (CL:CONS 'FROM-END (CL:CONS 'WITH-INDEX NIL))))))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'FIND-IF))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'FIND (CL:CONS (CL:CONS 'OBJ (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'START (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'FROM-END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'TEST (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'EQL NIL)) NIL)) NIL))))))) NIL)))) (CL:PROGN (CL:DEFUN FIND (OBJ SEQ CL:&KEY (START NIL) (END NIL) (FROM-END NIL) (TEST #'EQL)) (CL:BLOCK FIND (CL:BLOCK NIL (FIND-IF #'(CL:LAMBDA (_) (FUNCALL TEST _ OBJ)) SEQ :START START :END END :FROM-END FROM-END)))) (CL:SETF (CL:GETHASH #'FIND *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'OBJ (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'START (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'FROM-END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'TEST (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'EQL NIL)) NIL)) NIL))))))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'FIND (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'FIND-IF (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '_ NIL) (CL:CONS (CL:CONS 'FUNCALL (CL:CONS 'TEST (CL:CONS '_ (CL:CONS 'OBJ NIL)))) NIL)) NIL)) (CL:CONS 'SEQ (CL:CONS ':START (CL:CONS 'START (CL:CONS ':END (CL:CONS 'END (CL:CONS ':FROM-END (CL:CONS 'FROM-END NIL))))))))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'FIND))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'POSITION (CL:CONS (CL:CONS 'OBJ (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'START (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'FROM-END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'TEST (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'EQL NIL)) NIL)) NIL))))))) NIL)))) (CL:PROGN (CL:DEFUN POSITION (OBJ SEQ CL:&KEY (START NIL) (END NIL) (FROM-END NIL) (TEST #'EQL)) (CL:BLOCK POSITION (CL:BLOCK NIL (CL:LABELS ((G3725 (!) (FIND-IF #'(CL:LAMBDA (X I) (? (FUNCALL TEST X OBJ) (CL:PROGN (CL:SETQ ! I)))) SEQ :START START :END END :FROM-END FROM-END :WITH-INDEX T) !)) (G3725 NIL))))) (CL:SETF (CL:GETHASH #'POSITION *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'OBJ (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'START (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'FROM-END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'TEST (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'EQL NIL)) NIL)) NIL))))))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'POSITION (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS 'FIND-IF (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'X (CL:CONS 'I NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'FUNCALL (CL:CONS 'TEST (CL:CONS 'X (CL:CONS 'OBJ NIL)))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '! (CL:CONS 'I NIL))) NIL)) NIL))) NIL)) NIL)) (CL:CONS 'SEQ (CL:CONS ':START (CL:CONS 'START (CL:CONS ':END (CL:CONS 'END (CL:CONS ':FROM-END (CL:CONS 'FROM-END (CL:CONS ':WITH-INDEX (CL:CONS T NIL))))))))))) (CL:CONS '! NIL))) NIL)) (CL:CONS NIL NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'POSITION))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'POSITION-IF (CL:CONS (CL:CONS 'PRED (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'START (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'FROM-END (CL:CONS NIL NIL)) NIL)))))) NIL)))) (CL:PROGN (CL:DEFUN POSITION-IF (PRED SEQ CL:&KEY (START NIL) (END NIL) (FROM-END NIL)) (CL:BLOCK POSITION-IF (CL:BLOCK NIL (CL:LABELS ((G3726 (!) (FIND-IF #'(CL:LAMBDA (X I) (? (FUNCALL PRED X) (CL:PROGN (CL:SETQ ! I)))) SEQ :START START :END END :FROM-END FROM-END :WITH-INDEX T) !)) (G3726 NIL))))) (CL:SETF (CL:GETHASH #'POSITION-IF *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'PRED (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'START (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'END (CL:CONS NIL NIL)) (CL:CONS (CL:CONS 'FROM-END (CL:CONS NIL NIL)) NIL)))))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'POSITION-IF (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS 'FIND-IF (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'X (CL:CONS 'I NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'FUNCALL (CL:CONS 'PRED (CL:CONS 'X NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '! (CL:CONS 'I NIL))) NIL)) NIL))) NIL)) NIL)) (CL:CONS 'SEQ (CL:CONS ':START (CL:CONS 'START (CL:CONS ':END (CL:CONS 'END (CL:CONS ':FROM-END (CL:CONS 'FROM-END (CL:CONS ':WITH-INDEX (CL:CONS T NIL))))))))))) (CL:CONS '! NIL))) NIL)) (CL:CONS NIL NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'POSITION-IF))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'SOME (CL:CONS (CL:CONS 'PRED (CL:CONS 'CL:&REST (CL:CONS 'SEQS NIL))) NIL)))) (CL:PROGN (CL:DEFUN SOME (PRED CL:&REST SEQS) (CL:BLOCK SOME (CL:BLOCK NIL (FIND-IF PRED (CL:APPLY #'APPEND SEQS))))) (CL:SETF (CL:GETHASH #'SOME *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'PRED (CL:CONS 'CL:&REST (CL:CONS 'SEQS NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'SOME (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'FIND-IF (CL:CONS 'PRED (CL:CONS (CL:CONS 'CL:APPLY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'APPEND NIL)) (CL:CONS 'SEQS NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'SOME))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'EVERY (CL:CONS (CL:CONS 'PRED (CL:CONS 'CL:&REST (CL:CONS 'SEQS NIL))) NIL)))) (CL:PROGN (CL:DEFUN EVERY (PRED CL:&REST SEQS) (CL:BLOCK EVERY (CL:BLOCK NIL (CL:BLOCK NIL (CL:LABELS ((G3727 (~G1529) (CL:LABELS ((G3728 (SEQ) (CL:TAGBODY ~G1527 (? (NOT ~G1529) (CL:GO ~G1528)) (CL:SETQ SEQ (CL:CAR ~G1529)) (CL:LABELS ((G3729 (~G1526) (CL:BLOCK NIL (CL:LABELS ((G3730 (!) (CL:TAGBODY ~G1530 (? (INTEGER== ! ~G1526) (CL:RETURN-FROM NIL (CL:PROGN NIL))) (CL:LABELS ((G3731 (~G1519) (? ~G1519 ~G1519 (CL:RETURN-FROM EVERY NIL)))) (G3731 (FUNCALL PRED (CL:ELT SEQ !)))) (CL:SETQ ! (INTEGER+ 1 !)) (CL:GO ~G1530)))) (G3730 0))))) (G3729 (INTEGER (CL:LENGTH SEQ)))) (CL:SETQ ~G1529 (CL:CDR ~G1529)) (CL:GO ~G1527) ~G1528 (CL:RETURN-FROM NIL (CL:PROGN T))))) (G3728 NIL)))) (G3727 SEQS)))))) (CL:SETF (CL:GETHASH #'EVERY *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'PRED (CL:CONS 'CL:&REST (CL:CONS 'SEQS NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'EVERY (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1529 (CL:CONS 'SEQS NIL)) (CL:CONS (CL:CONS 'SEQ (CL:CONS NIL NIL)) NIL)) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1527 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS '~G1529 NIL)) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1528 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'SEQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1529 NIL)) NIL))) (CL:CONS (CL:CONS 'LET (CL:CONS '~G1526 (CL:CONS (CL:CONS 'INTEGER (CL:CONS (CL:CONS 'CL:LENGTH (CL:CONS 'SEQ NIL)) NIL)) (CL:CONS (CL:CONS 'DO (CL:CONS (CL:CONS (CL:CONS '! (CL:CONS 0 (CL:CONS (CL:CONS 'INTEGER+ (CL:CONS 1 (CL:CONS '! NIL))) NIL))) NIL) (CL:CONS (CL:CONS (CL:CONS 'INTEGER== (CL:CONS '! (CL:CONS '~G1526 NIL))) (CL:CONS NIL NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1519 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1519 (CL:CONS '~G1519 (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS 'EVERY (CL:CONS NIL NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'FUNCALL (CL:CONS 'PRED (CL:CONS (CL:CONS 'CL:ELT (CL:CONS 'SEQ (CL:CONS '! NIL))) NIL))) NIL)) NIL)))) NIL)))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '~G1529 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1529 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1527 NIL)) (CL:CONS '~G1528 (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS T NIL)) NIL)) NIL))))))))) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'EVERY))
NIL
NIL
NIL
NIL
NIL
NIL
NIL
NIL
NIL
NIL
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'DOT-EXPAND-MAKE-EXPR (CL:CONS (CL:CONS 'WHICH (CL:CONS 'NUM (CL:CONS 'X NIL))) NIL)))) (CL:PROGN (CL:DEFUN DOT-EXPAND-MAKE-EXPR (WHICH NUM X) (CL:BLOCK DOT-EXPAND-MAKE-EXPR (CL:BLOCK NIL (? (< 0 NUM) (CL:CONS WHICH (CL:CONS (DOT-EXPAND-MAKE-EXPR WHICH (-- NUM) X) NIL)) X)))) (CL:SETF (CL:GETHASH #'DOT-EXPAND-MAKE-EXPR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'WHICH (CL:CONS 'NUM (CL:CONS 'X NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'DOT-EXPAND-MAKE-EXPR (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '< (CL:CONS 0 (CL:CONS 'NUM NIL))) (CL:CONS (CL:CONS 'BACKQUOTE (CL:CONS (CL:CONS (CL:CONS 'QUASIQUOTE (CL:CONS 'WHICH NIL)) (CL:CONS (CL:CONS 'QUASIQUOTE (CL:CONS (CL:CONS 'DOT-EXPAND-MAKE-EXPR (CL:CONS 'WHICH (CL:CONS (CL:CONS '-- (CL:CONS 'NUM NIL)) (CL:CONS 'X NIL)))) NIL)) NIL)) NIL)) (CL:CONS 'X NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'DOT-EXPAND-MAKE-EXPR))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'DOT-EXPAND-HEAD-LENGTH (CL:CONS (CL:CONS 'X (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'NUM (CL:CONS 0 NIL)) NIL))) NIL)))) (CL:PROGN (CL:DEFUN DOT-EXPAND-HEAD-LENGTH (X CL:&OPTIONAL (NUM 0)) (CL:BLOCK DOT-EXPAND-HEAD-LENGTH (CL:BLOCK NIL (? (== #\. (CL:CAR X)) (DOT-EXPAND-HEAD-LENGTH (CL:CDR X) (++ NUM)) (VALUES NUM X))))) (CL:SETF (CL:GETHASH #'DOT-EXPAND-HEAD-LENGTH *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'NUM (CL:CONS 0 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'DOT-EXPAND-HEAD-LENGTH (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS #\. (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL))) (CL:CONS (CL:CONS 'DOT-EXPAND-HEAD-LENGTH (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) (CL:CONS (CL:CONS '++ (CL:CONS 'NUM NIL)) NIL))) (CL:CONS (CL:CONS 'VALUES (CL:CONS 'NUM (CL:CONS 'X NIL))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'DOT-EXPAND-HEAD-LENGTH))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'DOT-EXPAND-TAIL-LENGTH (CL:CONS (CL:CONS 'X (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'NUM (CL:CONS 0 NIL)) NIL))) NIL)))) (CL:PROGN (CL:DEFUN DOT-EXPAND-TAIL-LENGTH (X CL:&OPTIONAL (NUM 0)) (CL:BLOCK DOT-EXPAND-TAIL-LENGTH (CL:BLOCK NIL (? (== #\. (CL:CAR (CL:LAST X))) (DOT-EXPAND-TAIL-LENGTH (BUTLAST X) (++ NUM)) (VALUES NUM X))))) (CL:SETF (CL:GETHASH #'DOT-EXPAND-TAIL-LENGTH *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'NUM (CL:CONS 0 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'DOT-EXPAND-TAIL-LENGTH (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS #\. (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:LAST (CL:CONS 'X NIL)) NIL)) NIL))) (CL:CONS (CL:CONS 'DOT-EXPAND-TAIL-LENGTH (CL:CONS (CL:CONS 'BUTLAST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS '++ (CL:CONS 'NUM NIL)) NIL))) (CL:CONS (CL:CONS 'VALUES (CL:CONS 'NUM (CL:CONS 'X NIL))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'DOT-EXPAND-TAIL-LENGTH))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'DOT-EXPAND-LIST (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN DOT-EXPAND-LIST (X) (CL:BLOCK DOT-EXPAND-LIST (CL:BLOCK NIL (CL:LABELS ((G3732 (~G1536) (CL:LABELS ((G3733 (~G1537) (? (NOT (EQ (CL:CAR ~G1536) 'VALUES)) (CL:PROGN (ERROR "VALUES expected instead of ~A." ~G1536))) (CL:LABELS ((G3734 (NUM-CDRS) (CL:LABELS ((G3735 (~G1538) (CL:LABELS ((G3736 (WITHOUT-START) (CL:LABELS ((G3737 (~G1542) (CL:LABELS ((G3738 (~G1543) (? (NOT (EQ (CL:CAR ~G1542) 'VALUES)) (CL:PROGN (ERROR "VALUES expected instead of ~A." ~G1542))) (CL:LABELS ((G3739 (NUM-CARS) (CL:LABELS ((G3740 (~G1544) (CL:LABELS ((G3741 (WITHOUT-END) (DOT-EXPAND-MAKE-EXPR 'CL:CAR NUM-CARS (DOT-EXPAND-MAKE-EXPR 'CL:CDR NUM-CDRS (DOT-EXPAND (LIST-SYMBOL WITHOUT-END)))))) (G3741 (CL:CAR ~G1544))))) (G3740 (CL:LABELS ((G3742 (~G1546) (? ~G1546 ~G1546 (%ERROR "Not enough VALUES.")))) (G3742 (CL:CDR ~G1543))))))) (G3739 (CL:CAR ~G1543))))) (G3738 (CL:CDR ~G1542))))) (G3737 (DOT-EXPAND-TAIL-LENGTH WITHOUT-START))))) (G3736 (CL:CAR ~G1538))))) (G3735 (CL:LABELS ((G3743 (~G1541) (? ~G1541 ~G1541 (%ERROR "Not enough VALUES.")))) (G3743 (CL:CDR ~G1537))))))) (G3734 (CL:CAR ~G1537))))) (G3733 (CL:CDR ~G1536))))) (G3732 (DOT-EXPAND-HEAD-LENGTH X)))))) (CL:SETF (CL:GETHASH #'DOT-EXPAND-LIST *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'DOT-EXPAND-LIST (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1536 (CL:CONS (CL:CONS 'DOT-EXPAND-HEAD-LENGTH (CL:CONS 'X NIL)) NIL)) (CL:CONS (CL:CONS '~G1537 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1536 NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'UNLESS (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1536 NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'VALUES NIL)) NIL))) (CL:CONS (CL:CONS 'ERROR (CL:CONS "VALUES expected instead of ~A." (CL:CONS '~G1536 NIL))) NIL))) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'NUM-CDRS (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1537 NIL)) NIL)) (CL:CONS (CL:CONS '~G1538 (CL:CONS (CL:CONS '|\|| (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1537 NIL)) (CL:CONS (CL:CONS '%ERROR (CL:CONS "Not enough VALUES." NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'WITHOUT-START (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1538 NIL)) NIL)) NIL) (CL:CONS (CL:CONS 'MULTIPLE-VALUE-BIND (CL:CONS (CL:CONS 'NUM-CARS (CL:CONS 'WITHOUT-END NIL)) (CL:CONS (CL:CONS 'DOT-EXPAND-TAIL-LENGTH (CL:CONS 'WITHOUT-START NIL)) (CL:CONS (CL:CONS 'DOT-EXPAND-MAKE-EXPR (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CL:CAR NIL)) (CL:CONS 'NUM-CARS (CL:CONS (CL:CONS 'DOT-EXPAND-MAKE-EXPR (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CL:CDR NIL)) (CL:CONS 'NUM-CDRS (CL:CONS (CL:CONS 'DOT-EXPAND (CL:CONS (CL:CONS 'LIST-SYMBOL (CL:CONS 'WITHOUT-END NIL)) NIL)) NIL)))) NIL)))) NIL)))) NIL))) NIL))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'DOT-EXPAND-LIST))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'DOT-POSITION (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN DOT-POSITION (X) (CL:BLOCK DOT-POSITION (CL:BLOCK NIL (POSITION #\. X :TEST #'==)))) (CL:SETF (CL:GETHASH #'DOT-POSITION *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'DOT-POSITION (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'POSITION (CL:CONS #\. (CL:CONS 'X (CL:CONS ':TEST (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS '== NIL)) NIL))))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'DOT-POSITION))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'NO-DOT-NOTATION? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN NO-DOT-NOTATION? (X) (CL:BLOCK NO-DOT-NOTATION? (CL:BLOCK NIL (CL:LABELS ((G3744 (SL) (CL:LABELS ((G3745 (L) (CL:LABELS ((G3746 (P) (CL:LABELS ((G3747 (~G1531) (? ~G1531 ~G1531 (NOT P)))) (G3747 (== 1 L))))) (G3746 (DOT-POSITION SL))))) (G3745 (CL:LENGTH SL))))) (G3744 (STRING-LIST (SYMBOL-NAME X))))))) (CL:SETF (CL:GETHASH #'NO-DOT-NOTATION? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'NO-DOT-NOTATION? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'SL NIL) (CL:CONS (CL:CONS 'LET (CL:CONS 'L (CL:CONS (CL:CONS 'CL:LENGTH (CL:CONS 'SL NIL)) (CL:CONS (CL:CONS 'WITH (CL:CONS (CL:CONS 'P (CL:CONS (CL:CONS 'DOT-POSITION (CL:CONS 'SL NIL)) NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1531 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1531 (CL:CONS '~G1531 (CL:CONS (CL:CONS 'NOT (CL:CONS 'P NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '== (CL:CONS 1 (CL:CONS 'L NIL))) NIL)) NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'STRING-LIST (CL:CONS (CL:CONS 'SYMBOL-NAME (CL:CONS 'X NIL)) NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'NO-DOT-NOTATION?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'HAS-DOT-NOTATION? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN HAS-DOT-NOTATION? (X) (CL:BLOCK HAS-DOT-NOTATION? (CL:BLOCK NIL (CL:LABELS ((G3748 (SL) (CL:LABELS ((G3749 (~G1532) (? ~G1532 ~G1532 (== #\. (CL:CAR (CL:LAST SL)))))) (G3749 (== #\. (CL:CAR SL)))))) (G3748 (STRING-LIST (SYMBOL-NAME X))))))) (CL:SETF (CL:GETHASH #'HAS-DOT-NOTATION? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'HAS-DOT-NOTATION? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'SL NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1532 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1532 (CL:CONS '~G1532 (CL:CONS (CL:CONS '== (CL:CONS #\. (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:LAST (CL:CONS 'SL NIL)) NIL)) NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '== (CL:CONS #\. (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'SL NIL)) NIL))) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'STRING-LIST (CL:CONS (CL:CONS 'SYMBOL-NAME (CL:CONS 'X NIL)) NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'HAS-DOT-NOTATION?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'DOT-EXPAND-CONV (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN DOT-EXPAND-CONV (X) (CL:BLOCK DOT-EXPAND-CONV (CL:BLOCK NIL (CL:LABELS ((G3750 (SL) (CL:LABELS ((G3751 (P) (? (NO-DOT-NOTATION? X) X (HAS-DOT-NOTATION? X) (DOT-EXPAND-LIST SL) (CL:CONS '%SLOT-VALUE (CL:CONS (LIST-SYMBOL (SUBSEQ SL 0 P)) (CL:CONS (DOT-EXPAND-CONV (LIST-SYMBOL (SUBSEQ SL (++ P)))) NIL)))))) (G3751 (DOT-POSITION SL))))) (G3750 (STRING-LIST (SYMBOL-NAME X))))))) (CL:SETF (CL:GETHASH #'DOT-EXPAND-CONV *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'DOT-EXPAND-CONV (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'SL NIL) (CL:CONS (CL:CONS 'LET (CL:CONS 'P (CL:CONS (CL:CONS 'DOT-POSITION (CL:CONS 'SL NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NO-DOT-NOTATION? (CL:CONS 'X NIL)) (CL:CONS 'X (CL:CONS (CL:CONS 'HAS-DOT-NOTATION? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'DOT-EXPAND-LIST (CL:CONS 'SL NIL)) (CL:CONS (CL:CONS 'BACKQUOTE (CL:CONS (CL:CONS '%SLOT-VALUE (CL:CONS (CL:CONS 'QUASIQUOTE (CL:CONS (CL:CONS 'LIST-SYMBOL (CL:CONS (CL:CONS 'SUBSEQ (CL:CONS 'SL (CL:CONS 0 (CL:CONS 'P NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'QUASIQUOTE (CL:CONS (CL:CONS 'DOT-EXPAND-CONV (CL:CONS (CL:CONS 'LIST-SYMBOL (CL:CONS (CL:CONS 'SUBSEQ (CL:CONS 'SL (CL:CONS (CL:CONS '++ (CL:CONS 'P NIL)) NIL))) NIL)) NIL)) NIL)) NIL))) NIL)) NIL)))))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'STRING-LIST (CL:CONS (CL:CONS 'SYMBOL-NAME (CL:CONS 'X NIL)) NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'DOT-EXPAND-CONV))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'DOT-EXPAND (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN DOT-EXPAND (X) (CL:BLOCK DOT-EXPAND (CL:BLOCK NIL (CL:LABELS ((LABEL? (_) (NOT (CL:LABELS ((G3752 (~G1533) (? ~G1533 ~G1533 (CL:LABELS ((G3753 (~G1534) (? ~G1534 ~G1534 (STRING? _)))) (G3753 (NUMBER? _)))))) (G3752 (CONS? _)))))) (? X (CL:PROGN (? (LABEL? X) (DOT-EXPAND-CONV X) (CONS? X) (CL:PROGN (CL:LABELS ((G3754 (~G1540) (CL:LABELS ((G3755 (!) (? ! (CL:PROGN (CL:PROGN (CL:SETQ *DEFAULT-LISTPROP* !)))))) (G3755 (? (CONS? ~G1540) (CPR ~G1540)))))) (G3754 X)) (CL:LABELS ((G3756 (~G1535) (RPLACP (CL:CONS (DOT-EXPAND (CL:CAR X)) (DOT-EXPAND (CL:CDR X))) ~G1535))) (G3756 *DEFAULT-LISTPROP*))) X))))))) (CL:SETF (CL:GETHASH #'DOT-EXPAND *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'DOT-EXPAND (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:LABELS (CL:CONS (CL:CONS (CL:CONS 'LABEL? (CL:CONS (CL:CONS '_ NIL) (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1533 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1533 (CL:CONS '~G1533 (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1534 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1534 (CL:CONS '~G1534 (CL:CONS (CL:CONS 'STRING? (CL:CONS '_ NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'NUMBER? (CL:CONS '_ NIL)) NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CONS? (CL:CONS '_ NIL)) NIL)) NIL)) NIL))) NIL) (CL:CONS (CL:CONS '? (CL:CONS 'X (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'LABEL? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'DOT-EXPAND-CONV (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CONS? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'LET (CL:CONS '~G1540 (CL:CONS 'X (CL:CONS (CL:CONS 'AWHEN (CL:CONS (CL:CONS '& (CL:CONS (CL:CONS 'CONS? (CL:CONS '~G1540 NIL)) (CL:CONS (CL:CONS 'CPR (CL:CONS '~G1540 NIL)) NIL))) (CL:CONS (CL:CONS '= (CL:CONS '*DEFAULT-LISTPROP* (CL:CONS '! NIL))) NIL))) NIL)))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1535 NIL) (CL:CONS (CL:CONS 'RPLACP (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'DOT-EXPAND (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) (CL:CONS (CL:CONS 'DOT-EXPAND (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL)) NIL))) (CL:CONS '~G1535 NIL))) NIL)) NIL)) (CL:CONS '*DEFAULT-LISTPROP* NIL)) NIL))) (CL:CONS 'X NIL)))))) NIL)) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'DOT-EXPAND))
(CL:PROGN (CL:SETQ *DOT-EXPAND* #'DOT-EXPAND))
(%DEFVAR *MEMORIZED-NUMBERS* (MAKE-HASH-TABLE :TEST #'==))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'MEMORIZED-NUMBER (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN MEMORIZED-NUMBER (X) (CL:BLOCK MEMORIZED-NUMBER (CL:BLOCK NIL (CL:LABELS ((G3757 (~G1547) (? ~G1547 ~G1547 (CL:PROGN (=-HREF X *MEMORIZED-NUMBERS* X))))) (G3757 (HREF *MEMORIZED-NUMBERS* X)))))) (CL:SETF (CL:GETHASH #'MEMORIZED-NUMBER *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'MEMORIZED-NUMBER (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET (CL:CONS '~G1547 (CL:CONS (CL:CONS 'HREF (CL:CONS '*MEMORIZED-NUMBERS* (CL:CONS 'X NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1547 (CL:CONS '~G1547 (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-HREF (CL:CONS 'X (CL:CONS '*MEMORIZED-NUMBERS* (CL:CONS 'X NIL)))) NIL)) NIL)))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'MEMORIZED-NUMBER))
(%DEFVAR *TERPRI* (STRING (CODE-CHAR 10)))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'TERPRI (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-OUTPUT* NIL)) NIL)) NIL)))) (CL:PROGN (CL:DEFUN TERPRI (CL:&OPTIONAL (STR *STANDARD-OUTPUT*)) (CL:BLOCK TERPRI (CL:BLOCK NIL (CL:LABELS ((G3758 (~G1548) (CL:LABELS ((G3759 (S) (CL:LABELS ((G3760 (~G1549) (? ~G1548 ~G1549 (GET-STREAM-STRING S)))) (G3760 (CL:PROGN (STREAM-PRINC (CODE-CHAR 10) S) (FORCE-OUTPUT S) NIL))))) (G3759 (DEFAULT-STREAM ~G1548))))) (G3758 STR))))) (CL:SETF (CL:GETHASH #'TERPRI *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-OUTPUT* NIL)) NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'TERPRI (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET (CL:CONS '~G1548 (CL:CONS 'STR (CL:CONS (CL:CONS 'WITH (CL:CONS (CL:CONS 'S (CL:CONS (CL:CONS 'DEFAULT-STREAM (CL:CONS '~G1548 NIL)) (CL:CONS '~G1549 (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'STREAM-PRINC (CL:CONS (CL:CONS 'CODE-CHAR (CL:CONS 10 NIL)) (CL:CONS 'S NIL))) (CL:CONS (CL:CONS 'FORCE-OUTPUT (CL:CONS 'S NIL)) (CL:CONS NIL NIL)))) NIL)))) (CL:CONS (CL:CONS '? (CL:CONS '~G1548 (CL:CONS '~G1549 (CL:CONS (CL:CONS 'GET-STREAM-STRING (CL:CONS 'S NIL)) NIL)))) NIL))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'TERPRI))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'FRESH-LINE (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-OUTPUT* NIL)) NIL)) NIL)))) (CL:PROGN (CL:DEFUN FRESH-LINE (CL:&OPTIONAL (STR *STANDARD-OUTPUT*)) (CL:BLOCK FRESH-LINE (CL:BLOCK NIL (CL:LABELS ((G3761 (~G1550) (CL:LABELS ((G3762 (S) (CL:LABELS ((G3763 (~G1551) (? ~G1550 ~G1551 (GET-STREAM-STRING S)))) (G3763 (CL:PROGN (? (NOT (FRESH-LINE? S)) (CL:PROGN (TERPRI S) T))))))) (G3762 (DEFAULT-STREAM ~G1550))))) (G3761 STR))))) (CL:SETF (CL:GETHASH #'FRESH-LINE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-OUTPUT* NIL)) NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'FRESH-LINE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET (CL:CONS '~G1550 (CL:CONS 'STR (CL:CONS (CL:CONS 'WITH (CL:CONS (CL:CONS 'S (CL:CONS (CL:CONS 'DEFAULT-STREAM (CL:CONS '~G1550 NIL)) (CL:CONS '~G1551 (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS 'FRESH-LINE? (CL:CONS 'S NIL)) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'TERPRI (CL:CONS 'S NIL)) (CL:CONS T NIL))) NIL))) NIL)) NIL)))) (CL:CONS (CL:CONS '? (CL:CONS '~G1550 (CL:CONS '~G1551 (CL:CONS (CL:CONS 'GET-STREAM-STRING (CL:CONS 'S NIL)) NIL)))) NIL))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'FRESH-LINE))
(%DEFVAR *DEFAULT-STREAM-TABSIZE* 8)
(CL:PROGN NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'MAKE-STREAM-LOCATION (CL:CONS (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'TRACK? (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'TRACK? NIL)) NIL)) (CL:CONS (CL:CONS 'ID (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'ID NIL)) NIL)) (CL:CONS (CL:CONS 'LINE (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'LINE NIL)) NIL)) (CL:CONS (CL:CONS 'COLUMN (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'COLUMN NIL)) NIL)) (CL:CONS (CL:CONS 'TABSIZE (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'TABSIZE NIL)) NIL)) NIL)))))) NIL)))) (CL:PROGN (CL:DEFUN MAKE-STREAM-LOCATION (CL:&KEY (TRACK? 'TRACK?) (ID 'ID) (LINE 'LINE) (COLUMN 'COLUMN) (TABSIZE 'TABSIZE)) (CL:BLOCK MAKE-STREAM-LOCATION (CL:BLOCK NIL (CL:LABELS ((G3764 (~G1552) (CL:PROGN (=-AREF 'STRUCT ~G1552 0) (=-AREF 'STREAM-LOCATION ~G1552 1)) (CL:PROGN (=-AREF (? (EQ TRACK? 'TRACK?) T TRACK?) ~G1552 2)) (CL:PROGN (=-AREF (? (EQ ID 'ID) NIL ID) ~G1552 3)) (CL:PROGN (=-AREF (? (EQ LINE 'LINE) 1 LINE) ~G1552 4)) (CL:PROGN (=-AREF (? (EQ COLUMN 'COLUMN) 1 COLUMN) ~G1552 5)) (CL:PROGN (=-AREF (? (EQ TABSIZE 'TABSIZE) *DEFAULT-STREAM-TABSIZE* TABSIZE) ~G1552 6)) ~G1552)) (G3764 (MAKE-ARRAY 7)))))) (CL:SETF (CL:GETHASH #'MAKE-STREAM-LOCATION *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'TRACK? (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'TRACK? NIL)) NIL)) (CL:CONS (CL:CONS 'ID (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'ID NIL)) NIL)) (CL:CONS (CL:CONS 'LINE (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'LINE NIL)) NIL)) (CL:CONS (CL:CONS 'COLUMN (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'COLUMN NIL)) NIL)) (CL:CONS (CL:CONS 'TABSIZE (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'TABSIZE NIL)) NIL)) NIL)))))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'MAKE-STREAM-LOCATION (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1552 NIL) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'STRUCT NIL)) (CL:CONS '~G1552 (CL:CONS 0 NIL)))) (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'STREAM-LOCATION NIL)) (CL:CONS '~G1552 (CL:CONS 1 NIL)))) NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'TRACK? (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'TRACK? NIL)) NIL))) (CL:CONS T (CL:CONS 'TRACK? NIL)))) (CL:CONS '~G1552 (CL:CONS 2 NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'ID (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'ID NIL)) NIL))) (CL:CONS NIL (CL:CONS 'ID NIL)))) (CL:CONS '~G1552 (CL:CONS 3 NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'LINE (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'LINE NIL)) NIL))) (CL:CONS 1 (CL:CONS 'LINE NIL)))) (CL:CONS '~G1552 (CL:CONS 4 NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'COLUMN (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'COLUMN NIL)) NIL))) (CL:CONS 1 (CL:CONS 'COLUMN NIL)))) (CL:CONS '~G1552 (CL:CONS 5 NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'TABSIZE (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'TABSIZE NIL)) NIL))) (CL:CONS '*DEFAULT-STREAM-TABSIZE* (CL:CONS 'TABSIZE NIL)))) (CL:CONS '~G1552 (CL:CONS 6 NIL)))) NIL)) (CL:CONS '~G1552 NIL)))))))) NIL)) (CL:CONS (CL:CONS 'MAKE-ARRAY (CL:CONS 7 NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'MAKE-STREAM-LOCATION)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-LOCATION? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-LOCATION? (X) (CL:BLOCK STREAM-LOCATION? (CL:BLOCK NIL (? (ARRAY? X) (? (EQ 'STRUCT (CL:AREF X 0)) (EQ 'STREAM-LOCATION (CL:AREF X 1))))))) (CL:SETF (CL:GETHASH #'STREAM-LOCATION? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-LOCATION? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'ARRAY? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'STRUCT NIL)) (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'X (CL:CONS 0 NIL))) NIL))) (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'STREAM-LOCATION NIL)) (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'X (CL:CONS 1 NIL))) NIL))) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-LOCATION?)) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-LOCATION-TRACK? NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-LOCATION-TRACK? (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-LOCATION-TRACK? (ARR) (CL:BLOCK STREAM-LOCATION-TRACK? (CL:BLOCK NIL (CL:AREF ARR 2)))) (CL:SETF (CL:GETHASH #'STREAM-LOCATION-TRACK? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-LOCATION-TRACK? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 2 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-LOCATION-TRACK?)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-LOCATION-TRACK? (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-LOCATION-TRACK? (VAL ARR) (CL:BLOCK =-STREAM-LOCATION-TRACK? (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 2))))) (CL:SETF (CL:GETHASH #'=-STREAM-LOCATION-TRACK? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-LOCATION-TRACK? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 2 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-LOCATION-TRACK?))) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-LOCATION-ID NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-LOCATION-ID (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-LOCATION-ID (ARR) (CL:BLOCK STREAM-LOCATION-ID (CL:BLOCK NIL (CL:AREF ARR 3)))) (CL:SETF (CL:GETHASH #'STREAM-LOCATION-ID *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-LOCATION-ID (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 3 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-LOCATION-ID)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-LOCATION-ID (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-LOCATION-ID (VAL ARR) (CL:BLOCK =-STREAM-LOCATION-ID (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 3))))) (CL:SETF (CL:GETHASH #'=-STREAM-LOCATION-ID *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-LOCATION-ID (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 3 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-LOCATION-ID))) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-LOCATION-LINE NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-LOCATION-LINE (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-LOCATION-LINE (ARR) (CL:BLOCK STREAM-LOCATION-LINE (CL:BLOCK NIL (CL:AREF ARR 4)))) (CL:SETF (CL:GETHASH #'STREAM-LOCATION-LINE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-LOCATION-LINE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 4 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-LOCATION-LINE)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-LOCATION-LINE (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-LOCATION-LINE (VAL ARR) (CL:BLOCK =-STREAM-LOCATION-LINE (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 4))))) (CL:SETF (CL:GETHASH #'=-STREAM-LOCATION-LINE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-LOCATION-LINE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 4 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-LOCATION-LINE))) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-LOCATION-COLUMN NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-LOCATION-COLUMN (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-LOCATION-COLUMN (ARR) (CL:BLOCK STREAM-LOCATION-COLUMN (CL:BLOCK NIL (CL:AREF ARR 5)))) (CL:SETF (CL:GETHASH #'STREAM-LOCATION-COLUMN *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-LOCATION-COLUMN (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 5 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-LOCATION-COLUMN)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-LOCATION-COLUMN (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-LOCATION-COLUMN (VAL ARR) (CL:BLOCK =-STREAM-LOCATION-COLUMN (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 5))))) (CL:SETF (CL:GETHASH #'=-STREAM-LOCATION-COLUMN *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-LOCATION-COLUMN (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 5 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-LOCATION-COLUMN))) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-LOCATION-TABSIZE NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-LOCATION-TABSIZE (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-LOCATION-TABSIZE (ARR) (CL:BLOCK STREAM-LOCATION-TABSIZE (CL:BLOCK NIL (CL:AREF ARR 6)))) (CL:SETF (CL:GETHASH #'STREAM-LOCATION-TABSIZE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-LOCATION-TABSIZE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 6 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-LOCATION-TABSIZE)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-LOCATION-TABSIZE (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-LOCATION-TABSIZE (VAL ARR) (CL:BLOCK =-STREAM-LOCATION-TABSIZE (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 6))))) (CL:SETF (CL:GETHASH #'=-STREAM-LOCATION-TABSIZE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-LOCATION-TABSIZE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 6 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-LOCATION-TABSIZE))) (CL:BLOCK NIL (%DEFMACRO WITH-STREAM-LOCATION (S CL:&REST BODY) (CL:BLOCK WITH-STREAM-LOCATION (CL:CONS 'WITH-STRUCT (CL:CONS 'STREAM-LOCATION (CL:CONS S (APPEND BODY NIL))))))) (CL:BLOCK NIL (%DEFMACRO DEF-STREAM-LOCATION (NAME ARGS CL:&REST BODY) (CL:BLOCK DEF-STREAM-LOCATION (CL:CONS 'DEFUN (CL:CONS NAME (CL:CONS ARGS (CL:CONS (CL:CONS 'WITH-STRUCT (CL:CONS 'STREAM-LOCATION (CL:CONS 'STREAM-LOCATION (APPEND BODY NIL)))) NIL))))))))
(CL:PROGN NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'MAKE-STREAM (CL:CONS (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'HANDLE (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'HANDLE NIL)) NIL)) (CL:CONS (CL:CONS 'FUN-IN (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'FUN-IN NIL)) NIL)) (CL:CONS (CL:CONS 'FUN-OUT (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'FUN-OUT NIL)) NIL)) (CL:CONS (CL:CONS 'FUN-EOF (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'FUN-EOF NIL)) NIL)) (CL:CONS (CL:CONS 'LAST-CHAR (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'LAST-CHAR NIL)) NIL)) (CL:CONS (CL:CONS 'PEEKED-CHAR (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'PEEKED-CHAR NIL)) NIL)) (CL:CONS (CL:CONS 'INPUT-LOCATION (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'INPUT-LOCATION NIL)) NIL)) (CL:CONS (CL:CONS 'OUTPUT-LOCATION (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'OUTPUT-LOCATION NIL)) NIL)) (CL:CONS (CL:CONS 'USER-DETAIL (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'USER-DETAIL NIL)) NIL)) NIL)))))))))) NIL)))) (CL:PROGN (CL:DEFUN MAKE-STREAM (CL:&KEY (HANDLE 'HANDLE) (FUN-IN 'FUN-IN) (FUN-OUT 'FUN-OUT) (FUN-EOF 'FUN-EOF) (LAST-CHAR 'LAST-CHAR) (PEEKED-CHAR 'PEEKED-CHAR) (INPUT-LOCATION 'INPUT-LOCATION) (OUTPUT-LOCATION 'OUTPUT-LOCATION) (USER-DETAIL 'USER-DETAIL)) (CL:BLOCK MAKE-STREAM (CL:BLOCK NIL (CL:LABELS ((G3765 (~G1553) (CL:PROGN (=-AREF 'STRUCT ~G1553 0) (=-AREF 'STREAM ~G1553 1)) (CL:PROGN (=-AREF (? (EQ HANDLE 'HANDLE) NIL HANDLE) ~G1553 2)) (CL:PROGN (=-AREF (? (EQ FUN-IN 'FUN-IN) NIL FUN-IN) ~G1553 3)) (CL:PROGN (=-AREF (? (EQ FUN-OUT 'FUN-OUT) NIL FUN-OUT) ~G1553 4)) (CL:PROGN (=-AREF (? (EQ FUN-EOF 'FUN-EOF) NIL FUN-EOF) ~G1553 5)) (CL:PROGN (=-AREF (? (EQ LAST-CHAR 'LAST-CHAR) NIL LAST-CHAR) ~G1553 6)) (CL:PROGN (=-AREF (? (EQ PEEKED-CHAR 'PEEKED-CHAR) NIL PEEKED-CHAR) ~G1553 7)) (CL:PROGN (=-AREF (? (EQ INPUT-LOCATION 'INPUT-LOCATION) (MAKE-STREAM-LOCATION) INPUT-LOCATION) ~G1553 8)) (CL:PROGN (=-AREF (? (EQ OUTPUT-LOCATION 'OUTPUT-LOCATION) (MAKE-STREAM-LOCATION :TRACK? NIL) OUTPUT-LOCATION) ~G1553 9)) (CL:PROGN (=-AREF (? (EQ USER-DETAIL 'USER-DETAIL) NIL USER-DETAIL) ~G1553 10)) ~G1553)) (G3765 (MAKE-ARRAY 11)))))) (CL:SETF (CL:GETHASH #'MAKE-STREAM *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'HANDLE (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'HANDLE NIL)) NIL)) (CL:CONS (CL:CONS 'FUN-IN (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'FUN-IN NIL)) NIL)) (CL:CONS (CL:CONS 'FUN-OUT (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'FUN-OUT NIL)) NIL)) (CL:CONS (CL:CONS 'FUN-EOF (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'FUN-EOF NIL)) NIL)) (CL:CONS (CL:CONS 'LAST-CHAR (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'LAST-CHAR NIL)) NIL)) (CL:CONS (CL:CONS 'PEEKED-CHAR (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'PEEKED-CHAR NIL)) NIL)) (CL:CONS (CL:CONS 'INPUT-LOCATION (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'INPUT-LOCATION NIL)) NIL)) (CL:CONS (CL:CONS 'OUTPUT-LOCATION (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'OUTPUT-LOCATION NIL)) NIL)) (CL:CONS (CL:CONS 'USER-DETAIL (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'USER-DETAIL NIL)) NIL)) NIL)))))))))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'MAKE-STREAM (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1553 NIL) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'STRUCT NIL)) (CL:CONS '~G1553 (CL:CONS 0 NIL)))) (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'STREAM NIL)) (CL:CONS '~G1553 (CL:CONS 1 NIL)))) NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'HANDLE (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'HANDLE NIL)) NIL))) (CL:CONS NIL (CL:CONS 'HANDLE NIL)))) (CL:CONS '~G1553 (CL:CONS 2 NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'FUN-IN (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'FUN-IN NIL)) NIL))) (CL:CONS NIL (CL:CONS 'FUN-IN NIL)))) (CL:CONS '~G1553 (CL:CONS 3 NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'FUN-OUT (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'FUN-OUT NIL)) NIL))) (CL:CONS NIL (CL:CONS 'FUN-OUT NIL)))) (CL:CONS '~G1553 (CL:CONS 4 NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'FUN-EOF (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'FUN-EOF NIL)) NIL))) (CL:CONS NIL (CL:CONS 'FUN-EOF NIL)))) (CL:CONS '~G1553 (CL:CONS 5 NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'LAST-CHAR (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'LAST-CHAR NIL)) NIL))) (CL:CONS NIL (CL:CONS 'LAST-CHAR NIL)))) (CL:CONS '~G1553 (CL:CONS 6 NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'PEEKED-CHAR (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'PEEKED-CHAR NIL)) NIL))) (CL:CONS NIL (CL:CONS 'PEEKED-CHAR NIL)))) (CL:CONS '~G1553 (CL:CONS 7 NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'INPUT-LOCATION (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'INPUT-LOCATION NIL)) NIL))) (CL:CONS (CL:CONS 'MAKE-STREAM-LOCATION NIL) (CL:CONS 'INPUT-LOCATION NIL)))) (CL:CONS '~G1553 (CL:CONS 8 NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'OUTPUT-LOCATION (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'OUTPUT-LOCATION NIL)) NIL))) (CL:CONS (CL:CONS 'MAKE-STREAM-LOCATION (CL:CONS ':TRACK? (CL:CONS NIL NIL))) (CL:CONS 'OUTPUT-LOCATION NIL)))) (CL:CONS '~G1553 (CL:CONS 9 NIL)))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'USER-DETAIL (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'USER-DETAIL NIL)) NIL))) (CL:CONS NIL (CL:CONS 'USER-DETAIL NIL)))) (CL:CONS '~G1553 (CL:CONS 10 NIL)))) NIL)) (CL:CONS '~G1553 NIL)))))))))))) NIL)) (CL:CONS (CL:CONS 'MAKE-ARRAY (CL:CONS 11 NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'MAKE-STREAM)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM? (X) (CL:BLOCK STREAM? (CL:BLOCK NIL (? (ARRAY? X) (? (EQ 'STRUCT (CL:AREF X 0)) (EQ 'STREAM (CL:AREF X 1))))))) (CL:SETF (CL:GETHASH #'STREAM? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'ARRAY? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'STRUCT NIL)) (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'X (CL:CONS 0 NIL))) NIL))) (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'STREAM NIL)) (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'X (CL:CONS 1 NIL))) NIL))) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM?)) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-HANDLE NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-HANDLE (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-HANDLE (ARR) (CL:BLOCK STREAM-HANDLE (CL:BLOCK NIL (CL:AREF ARR 2)))) (CL:SETF (CL:GETHASH #'STREAM-HANDLE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-HANDLE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 2 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-HANDLE)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-HANDLE (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-HANDLE (VAL ARR) (CL:BLOCK =-STREAM-HANDLE (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 2))))) (CL:SETF (CL:GETHASH #'=-STREAM-HANDLE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-HANDLE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 2 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-HANDLE))) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-FUN-IN NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-FUN-IN (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-FUN-IN (ARR) (CL:BLOCK STREAM-FUN-IN (CL:BLOCK NIL (CL:AREF ARR 3)))) (CL:SETF (CL:GETHASH #'STREAM-FUN-IN *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-FUN-IN (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 3 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-FUN-IN)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-FUN-IN (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-FUN-IN (VAL ARR) (CL:BLOCK =-STREAM-FUN-IN (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 3))))) (CL:SETF (CL:GETHASH #'=-STREAM-FUN-IN *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-FUN-IN (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 3 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-FUN-IN))) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-FUN-OUT NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-FUN-OUT (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-FUN-OUT (ARR) (CL:BLOCK STREAM-FUN-OUT (CL:BLOCK NIL (CL:AREF ARR 4)))) (CL:SETF (CL:GETHASH #'STREAM-FUN-OUT *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-FUN-OUT (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 4 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-FUN-OUT)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-FUN-OUT (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-FUN-OUT (VAL ARR) (CL:BLOCK =-STREAM-FUN-OUT (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 4))))) (CL:SETF (CL:GETHASH #'=-STREAM-FUN-OUT *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-FUN-OUT (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 4 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-FUN-OUT))) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-FUN-EOF NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-FUN-EOF (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-FUN-EOF (ARR) (CL:BLOCK STREAM-FUN-EOF (CL:BLOCK NIL (CL:AREF ARR 5)))) (CL:SETF (CL:GETHASH #'STREAM-FUN-EOF *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-FUN-EOF (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 5 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-FUN-EOF)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-FUN-EOF (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-FUN-EOF (VAL ARR) (CL:BLOCK =-STREAM-FUN-EOF (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 5))))) (CL:SETF (CL:GETHASH #'=-STREAM-FUN-EOF *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-FUN-EOF (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 5 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-FUN-EOF))) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-LAST-CHAR NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-LAST-CHAR (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-LAST-CHAR (ARR) (CL:BLOCK STREAM-LAST-CHAR (CL:BLOCK NIL (CL:AREF ARR 6)))) (CL:SETF (CL:GETHASH #'STREAM-LAST-CHAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-LAST-CHAR (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 6 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-LAST-CHAR)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-LAST-CHAR (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-LAST-CHAR (VAL ARR) (CL:BLOCK =-STREAM-LAST-CHAR (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 6))))) (CL:SETF (CL:GETHASH #'=-STREAM-LAST-CHAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-LAST-CHAR (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 6 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-LAST-CHAR))) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-PEEKED-CHAR NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-PEEKED-CHAR (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-PEEKED-CHAR (ARR) (CL:BLOCK STREAM-PEEKED-CHAR (CL:BLOCK NIL (CL:AREF ARR 7)))) (CL:SETF (CL:GETHASH #'STREAM-PEEKED-CHAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-PEEKED-CHAR (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 7 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-PEEKED-CHAR)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-PEEKED-CHAR (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-PEEKED-CHAR (VAL ARR) (CL:BLOCK =-STREAM-PEEKED-CHAR (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 7))))) (CL:SETF (CL:GETHASH #'=-STREAM-PEEKED-CHAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-PEEKED-CHAR (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 7 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-PEEKED-CHAR))) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-INPUT-LOCATION NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-INPUT-LOCATION (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-INPUT-LOCATION (ARR) (CL:BLOCK STREAM-INPUT-LOCATION (CL:BLOCK NIL (CL:AREF ARR 8)))) (CL:SETF (CL:GETHASH #'STREAM-INPUT-LOCATION *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-INPUT-LOCATION (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 8 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-INPUT-LOCATION)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-INPUT-LOCATION (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-INPUT-LOCATION (VAL ARR) (CL:BLOCK =-STREAM-INPUT-LOCATION (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 8))))) (CL:SETF (CL:GETHASH #'=-STREAM-INPUT-LOCATION *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-INPUT-LOCATION (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 8 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-INPUT-LOCATION))) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-OUTPUT-LOCATION NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-OUTPUT-LOCATION (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-OUTPUT-LOCATION (ARR) (CL:BLOCK STREAM-OUTPUT-LOCATION (CL:BLOCK NIL (CL:AREF ARR 9)))) (CL:SETF (CL:GETHASH #'STREAM-OUTPUT-LOCATION *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-OUTPUT-LOCATION (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 9 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-OUTPUT-LOCATION)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-OUTPUT-LOCATION (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-OUTPUT-LOCATION (VAL ARR) (CL:BLOCK =-STREAM-OUTPUT-LOCATION (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 9))))) (CL:SETF (CL:GETHASH #'=-STREAM-OUTPUT-LOCATION *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-OUTPUT-LOCATION (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 9 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-OUTPUT-LOCATION))) (CL:PROGN (CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'STREAM-USER-DETAIL NIL) *FUNCTIONALS*)) NIL (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-USER-DETAIL (CL:CONS (CL:CONS 'ARR NIL) NIL)))) (CL:PROGN (CL:DEFUN STREAM-USER-DETAIL (ARR) (CL:BLOCK STREAM-USER-DETAIL (CL:BLOCK NIL (CL:AREF ARR 10)))) (CL:SETF (CL:GETHASH #'STREAM-USER-DETAIL *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'ARR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-USER-DETAIL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:AREF (CL:CONS 'ARR (CL:CONS 10 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-USER-DETAIL)) (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '=-STREAM-USER-DETAIL (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) NIL)))) (CL:PROGN (CL:DEFUN =-STREAM-USER-DETAIL (VAL ARR) (CL:BLOCK =-STREAM-USER-DETAIL (CL:BLOCK NIL (CL:PROGN (=-AREF VAL ARR 10))))) (CL:SETF (CL:GETHASH #'=-STREAM-USER-DETAIL *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'VAL (CL:CONS 'ARR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '=-STREAM-USER-DETAIL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-AREF (CL:CONS 'VAL (CL:CONS 'ARR (CL:CONS 10 NIL)))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '=-STREAM-USER-DETAIL))) (CL:BLOCK NIL (%DEFMACRO WITH-STREAM (S CL:&REST BODY) (CL:BLOCK WITH-STREAM (CL:CONS 'WITH-STRUCT (CL:CONS 'STREAM (CL:CONS S (APPEND BODY NIL))))))) (CL:BLOCK NIL (%DEFMACRO DEF-STREAM (NAME ARGS CL:&REST BODY) (CL:BLOCK DEF-STREAM (CL:CONS 'DEFUN (CL:CONS NAME (CL:CONS ARGS (CL:CONS (CL:CONS 'WITH-STRUCT (CL:CONS 'STREAM (CL:CONS 'STREAM (APPEND BODY NIL)))) NIL))))))))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'NEXT-TABULATOR-COLUMN (CL:CONS (CL:CONS 'COLUMN (CL:CONS 'SIZE NIL)) NIL)))) (CL:PROGN (CL:DEFUN NEXT-TABULATOR-COLUMN (COLUMN SIZE) (CL:BLOCK NEXT-TABULATOR-COLUMN (CL:BLOCK NIL (++ (* SIZE (++ (INTEGER (/ (-- COLUMN) SIZE)))))))) (CL:SETF (CL:GETHASH #'NEXT-TABULATOR-COLUMN *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'COLUMN (CL:CONS 'SIZE NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'NEXT-TABULATOR-COLUMN (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '++ (CL:CONS (CL:CONS '* (CL:CONS 'SIZE (CL:CONS (CL:CONS '++ (CL:CONS (CL:CONS 'INTEGER (CL:CONS (CL:CONS '/ (CL:CONS (CL:CONS '-- (CL:CONS 'COLUMN NIL)) (CL:CONS 'SIZE NIL))) NIL)) NIL)) NIL))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'NEXT-TABULATOR-COLUMN))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '%TRACK-LOCATION (CL:CONS (CL:CONS 'STREAM-LOCATION (CL:CONS 'X NIL)) NIL)))) (CL:PROGN (CL:DEFUN %TRACK-LOCATION (STREAM-LOCATION X) (CL:BLOCK %TRACK-LOCATION (CL:BLOCK NIL (CL:LABELS ((G3766 (STREAM-LOCATION) (CL:LABELS ((G3767 (TRACK?) (CL:LABELS ((G3768 (ID) (CL:LABELS ((G3769 (LINE) (CL:LABELS ((G3770 (COLUMN) (CL:LABELS ((G3771 (TABSIZE) TRACK? ID LINE COLUMN TABSIZE (? TRACK? (CL:PROGN (? (STRING? X) (CL:BLOCK NIL (CL:LABELS ((G3772 (~G1556) (CL:LABELS ((G3773 (!) (CL:TAGBODY ~G1554 (? (NOT ~G1556) (CL:GO ~G1555)) (CL:SETQ ! (CL:CAR ~G1556)) (%TRACK-LOCATION STREAM-LOCATION !) (CL:SETQ ~G1556 (CL:CDR ~G1556)) (CL:GO ~G1554) ~G1555 (CL:RETURN-FROM NIL (CL:PROGN NIL))))) (G3773 NIL)))) (G3772 (STRING-LIST X)))) (? X (CL:PROGN (? (== 10 X) (CL:PROGN (CL:PROGN (=-STREAM-LOCATION-COLUMN 1 STREAM-LOCATION)) (CL:PROGN (=-STREAM-LOCATION-LINE (NUMBER+ (STREAM-LOCATION-LINE STREAM-LOCATION) 1) STREAM-LOCATION))) (? (== 9 X) (CL:PROGN (=-STREAM-LOCATION-COLUMN (NEXT-TABULATOR-COLUMN COLUMN TABSIZE) STREAM-LOCATION)) (< 31 X) (CL:PROGN (=-STREAM-LOCATION-COLUMN (NUMBER+ (STREAM-LOCATION-COLUMN STREAM-LOCATION) 1) STREAM-LOCATION))))))))) X)) (G3771 (STREAM-LOCATION-TABSIZE STREAM-LOCATION))))) (G3770 (STREAM-LOCATION-COLUMN STREAM-LOCATION))))) (G3769 (STREAM-LOCATION-LINE STREAM-LOCATION))))) (G3768 (STREAM-LOCATION-ID STREAM-LOCATION))))) (G3767 (STREAM-LOCATION-TRACK? STREAM-LOCATION))))) (G3766 STREAM-LOCATION))))) (CL:SETF (CL:GETHASH #'%TRACK-LOCATION *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STREAM-LOCATION (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '%TRACK-LOCATION (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET (CL:CONS 'STREAM-LOCATION (CL:CONS 'STREAM-LOCATION (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'TRACK? (CL:CONS (CL:CONS 'STREAM-LOCATION-TRACK? (CL:CONS 'STREAM-LOCATION NIL)) NIL)) (CL:CONS (CL:CONS 'ID (CL:CONS (CL:CONS 'STREAM-LOCATION-ID (CL:CONS 'STREAM-LOCATION NIL)) NIL)) (CL:CONS (CL:CONS 'LINE (CL:CONS (CL:CONS 'STREAM-LOCATION-LINE (CL:CONS 'STREAM-LOCATION NIL)) NIL)) (CL:CONS (CL:CONS 'COLUMN (CL:CONS (CL:CONS 'STREAM-LOCATION-COLUMN (CL:CONS 'STREAM-LOCATION NIL)) NIL)) (CL:CONS (CL:CONS 'TABSIZE (CL:CONS (CL:CONS 'STREAM-LOCATION-TABSIZE (CL:CONS 'STREAM-LOCATION NIL)) NIL)) NIL))))) (CL:CONS 'TRACK? (CL:CONS 'ID (CL:CONS 'LINE (CL:CONS 'COLUMN (CL:CONS 'TABSIZE (CL:CONS (CL:CONS '? (CL:CONS 'TRACK? (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'STRING? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET (CL:CONS '~G1556 (CL:CONS (CL:CONS 'STRING-LIST (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '! (CL:CONS NIL NIL)) NIL) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1554 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS '~G1556 NIL)) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1555 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '! (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1556 NIL)) NIL))) (CL:CONS (CL:CONS '%TRACK-LOCATION (CL:CONS 'STREAM-LOCATION (CL:CONS '! NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '~G1556 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1556 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1554 NIL)) (CL:CONS '~G1555 (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS NIL NIL)) NIL))) NIL))))))))) NIL))) NIL)))) NIL))) (CL:CONS (CL:CONS '? (CL:CONS 'X (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS 10 (CL:CONS 'X NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-STREAM-LOCATION-COLUMN (CL:CONS 1 (CL:CONS 'STREAM-LOCATION NIL))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-STREAM-LOCATION-LINE (CL:CONS (CL:CONS 'NUMBER+ (CL:CONS (CL:CONS 'STREAM-LOCATION-LINE (CL:CONS 'STREAM-LOCATION NIL)) (CL:CONS 1 NIL))) (CL:CONS 'STREAM-LOCATION NIL))) NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS 9 (CL:CONS 'X NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-STREAM-LOCATION-COLUMN (CL:CONS (CL:CONS 'NEXT-TABULATOR-COLUMN (CL:CONS 'COLUMN (CL:CONS 'TABSIZE NIL))) (CL:CONS 'STREAM-LOCATION NIL))) NIL)) (CL:CONS (CL:CONS '< (CL:CONS 31 (CL:CONS 'X NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-STREAM-LOCATION-COLUMN (CL:CONS (CL:CONS 'NUMBER+ (CL:CONS (CL:CONS 'STREAM-LOCATION-COLUMN (CL:CONS 'STREAM-LOCATION NIL)) (CL:CONS 1 NIL))) (CL:CONS 'STREAM-LOCATION NIL))) NIL)) NIL))))) NIL)))) NIL)) NIL))) NIL)))) NIL)) NIL))) (CL:CONS 'X NIL))))))))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '%TRACK-LOCATION))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'STREAM-PRINC (CL:CONS (CL:CONS 'X (CL:CONS 'STR NIL)) NIL)))) (CL:PROGN (CL:DEFUN STREAM-PRINC (X STR) (CL:BLOCK STREAM-PRINC (CL:BLOCK NIL (? (CONS? X) (CL:BLOCK NIL (CL:LABELS ((G3774 (~G1559) (CL:LABELS ((G3775 (!) (CL:TAGBODY ~G1557 (? (NOT ~G1559) (CL:GO ~G1558)) (CL:SETQ ! (CL:CAR ~G1559)) (STREAM-PRINC ! STR) (CL:SETQ ~G1559 (CL:CDR ~G1559)) (CL:GO ~G1557) ~G1558 (CL:RETURN-FROM NIL (CL:PROGN X))))) (G3775 NIL)))) (G3774 X))) (? (NOT (? (STRING? X) (ZERO? (CL:LENGTH X)))) (CL:PROGN (CL:PROGN (=-STREAM-LAST-CHAR (? (STRING? X) (CL:ELT X (-- (CL:LENGTH X))) X) STR)) (%TRACK-LOCATION (STREAM-OUTPUT-LOCATION STR) X) (FUNCALL (STREAM-FUN-OUT STR) X STR))))))) (CL:SETF (CL:GETHASH #'STREAM-PRINC *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'STREAM-PRINC (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CONS? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1559 (CL:CONS 'X NIL)) (CL:CONS (CL:CONS '! (CL:CONS NIL NIL)) NIL)) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1557 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS '~G1559 NIL)) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1558 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '! (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1559 NIL)) NIL))) (CL:CONS (CL:CONS 'STREAM-PRINC (CL:CONS '! (CL:CONS 'STR NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '~G1559 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1559 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1557 NIL)) (CL:CONS '~G1558 (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS 'X NIL)) NIL)) NIL))))))))) NIL))) NIL))) (CL:CONS (CL:CONS '& (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'STRING? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'ZERO? (CL:CONS (CL:CONS 'CL:LENGTH (CL:CONS 'X NIL)) NIL)) NIL))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-STREAM-LAST-CHAR (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'STRING? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'CL:ELT (CL:CONS 'X (CL:CONS (CL:CONS '-- (CL:CONS (CL:CONS 'CL:LENGTH (CL:CONS 'X NIL)) NIL)) NIL))) (CL:CONS 'X NIL)))) (CL:CONS 'STR NIL))) NIL)) (CL:CONS (CL:CONS '%TRACK-LOCATION (CL:CONS (CL:CONS 'STREAM-OUTPUT-LOCATION (CL:CONS 'STR NIL)) (CL:CONS 'X NIL))) (CL:CONS (CL:CONS 'FUNCALL (CL:CONS (CL:CONS 'STREAM-FUN-OUT (CL:CONS 'STR NIL)) (CL:CONS 'X (CL:CONS 'STR NIL)))) NIL)))) NIL))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'STREAM-PRINC))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-PEEKED-CHAR (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN READ-PEEKED-CHAR (STR) (CL:BLOCK READ-PEEKED-CHAR (CL:BLOCK NIL (CL:LABELS ((G3776 (!) (? ! (CL:PROGN (CL:PROGN (=-STREAM-PEEKED-CHAR NIL STR)) !)))) (G3776 (STREAM-PEEKED-CHAR STR)))))) (CL:SETF (CL:GETHASH #'READ-PEEKED-CHAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-PEEKED-CHAR (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '& (CL:CONS '! (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-STREAM-PEEKED-CHAR (CL:CONS NIL (CL:CONS 'STR NIL))) NIL)) (CL:CONS '! NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'STREAM-PEEKED-CHAR (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-PEEKED-CHAR))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-CHAR-0 (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN READ-CHAR-0 (STR) (CL:BLOCK READ-CHAR-0 (CL:BLOCK NIL (CL:LABELS ((G3777 (~G1560) (? ~G1560 ~G1560 (CL:PROGN (=-STREAM-LAST-CHAR (FUNCALL (STREAM-FUN-IN STR) STR) STR))))) (G3777 (READ-PEEKED-CHAR STR)))))) (CL:SETF (CL:GETHASH #'READ-CHAR-0 *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-CHAR-0 (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1560 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1560 (CL:CONS '~G1560 (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-STREAM-LAST-CHAR (CL:CONS (CL:CONS 'FUNCALL (CL:CONS (CL:CONS 'STREAM-FUN-IN (CL:CONS 'STR NIL)) (CL:CONS 'STR NIL))) (CL:CONS 'STR NIL))) NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'READ-PEEKED-CHAR (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-CHAR-0))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-CHAR (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-INPUT* NIL)) NIL)) NIL)))) (CL:PROGN (CL:DEFUN READ-CHAR (CL:&OPTIONAL (STR *STANDARD-INPUT*)) (CL:BLOCK READ-CHAR (CL:BLOCK NIL (%TRACK-LOCATION (STREAM-INPUT-LOCATION STR) (READ-CHAR-0 STR))))) (CL:SETF (CL:GETHASH #'READ-CHAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-INPUT* NIL)) NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-CHAR (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '%TRACK-LOCATION (CL:CONS (CL:CONS 'STREAM-INPUT-LOCATION (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'READ-CHAR-0 (CL:CONS 'STR NIL)) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-CHAR))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'PEEK-CHAR (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-INPUT* NIL)) NIL)) NIL)))) (CL:PROGN (CL:DEFUN PEEK-CHAR (CL:&OPTIONAL (STR *STANDARD-INPUT*)) (CL:BLOCK PEEK-CHAR (CL:BLOCK NIL (CL:LABELS ((G3778 (~G1561) (? ~G1561 ~G1561 (CL:PROGN (=-STREAM-PEEKED-CHAR (READ-CHAR-0 STR) STR))))) (G3778 (STREAM-PEEKED-CHAR STR)))))) (CL:SETF (CL:GETHASH #'PEEK-CHAR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-INPUT* NIL)) NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'PEEK-CHAR (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1561 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1561 (CL:CONS '~G1561 (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-STREAM-PEEKED-CHAR (CL:CONS (CL:CONS 'READ-CHAR-0 (CL:CONS 'STR NIL)) (CL:CONS 'STR NIL))) NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'STREAM-PEEKED-CHAR (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'PEEK-CHAR))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'DEFAULT-STREAM (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN DEFAULT-STREAM (X) (CL:BLOCK DEFAULT-STREAM (CL:BLOCK NIL (CL:LABELS ((G3779 (~G1562) (? (EQ ~G1562 NIL) (MAKE-STRING-STREAM) (EQ ~G1562 T) *STANDARD-OUTPUT* X))) (G3779 X))))) (CL:SETF (CL:GETHASH #'DEFAULT-STREAM *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'DEFAULT-STREAM (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1562 NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1562 (CL:CONS NIL NIL))) (CL:CONS (CL:CONS 'MAKE-STRING-STREAM NIL) (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1562 (CL:CONS T NIL))) (CL:CONS '*STANDARD-OUTPUT* (CL:CONS 'X NIL)))))) NIL)) NIL)) (CL:CONS 'X NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'DEFAULT-STREAM))
(CL:BLOCK NIL (%DEFMACRO WITH-DEFAULT-STREAM (NSTR STR CL:&REST BODY) (CL:BLOCK WITH-DEFAULT-STREAM (CL:LABELS ((G3780 (G) (CL:LABELS ((G3781 (BODY-RESULT) (CL:CONS 'WITH (CL:CONS (CL:CONS G (CL:CONS STR (CL:CONS NSTR (CL:CONS (CL:CONS 'DEFAULT-STREAM (CL:CONS G NIL)) (CL:CONS BODY-RESULT (CL:CONS (CL:CONS 'CL:PROGN (APPEND BODY NIL)) NIL)))))) (CL:CONS (CL:CONS '? (CL:CONS G (CL:CONS BODY-RESULT (CL:CONS (CL:CONS 'GET-STREAM-STRING (CL:CONS NSTR NIL)) NIL)))) NIL))))) (G3781 (GENSYM))))) (G3780 (GENSYM))))))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'MAKE-STRING-STREAM (CL:CONS NIL NIL)))) (CL:PROGN (CL:DEFUN MAKE-STRING-STREAM NIL (CL:BLOCK MAKE-STRING-STREAM (CL:BLOCK NIL (MAKE-STREAM :USER-DETAIL (MAKE-QUEUE) :FUN-IN #'(CL:LAMBDA (STR) (CL:LABELS ((G3782 (!) (? (STRING? (CL:CAR !)) (CL:PROGN (CL:PROGN (=-STREAM-USER-DETAIL (MAKE-QUEUE) STR)) (ENQUEUE-LIST (STREAM-USER-DETAIL STR) (APPEND (STRING-LIST (CL:CAR !)) (CL:CDR !))))))) (G3782 (QUEUE-LIST (STREAM-USER-DETAIL STR)))) (QUEUE-POP (STREAM-USER-DETAIL STR))) :FUN-OUT #'(CL:LAMBDA (X STR) (ENQUEUE (STREAM-USER-DETAIL STR) X)) :FUN-EOF #'(CL:LAMBDA (STR) (NOT (QUEUE-LIST (STREAM-USER-DETAIL STR)))))))) (CL:SETF (CL:GETHASH #'MAKE-STRING-STREAM *FUNCTION-ATOM-SOURCES*) (CL:CONS NIL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'MAKE-STRING-STREAM (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'MAKE-STREAM (CL:CONS ':USER-DETAIL (CL:CONS (CL:CONS 'MAKE-QUEUE NIL) (CL:CONS ':FUN-IN (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'STRING? (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '! NIL)) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-STREAM-USER-DETAIL (CL:CONS (CL:CONS 'MAKE-QUEUE NIL) (CL:CONS 'STR NIL))) NIL)) (CL:CONS (CL:CONS 'ENQUEUE-LIST (CL:CONS (CL:CONS 'STREAM-USER-DETAIL (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'APPEND (CL:CONS (CL:CONS 'STRING-LIST (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '! NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '! NIL)) NIL))) NIL))) NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'QUEUE-LIST (CL:CONS (CL:CONS 'STREAM-USER-DETAIL (CL:CONS 'STR NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'QUEUE-POP (CL:CONS (CL:CONS 'STREAM-USER-DETAIL (CL:CONS 'STR NIL)) NIL)) NIL))) NIL)) (CL:CONS ':FUN-OUT (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'X (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'ENQUEUE (CL:CONS (CL:CONS 'STREAM-USER-DETAIL (CL:CONS 'STR NIL)) (CL:CONS 'X NIL))) NIL)) NIL)) (CL:CONS ':FUN-EOF (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS 'QUEUE-LIST (CL:CONS (CL:CONS 'STREAM-USER-DETAIL (CL:CONS 'STR NIL)) NIL)) NIL)) NIL)) NIL)) NIL))))))))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'MAKE-STRING-STREAM))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'GET-STREAM-STRING (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN GET-STREAM-STRING (STR) (CL:BLOCK GET-STREAM-STRING (CL:BLOCK NIL (CL:LABELS ((G3783 (~G1563) (CL:PROGN (=-STREAM-USER-DETAIL (MAKE-QUEUE) STR)) ~G1563)) (G3783 (QUEUE-STRING (STREAM-USER-DETAIL STR))))))) (CL:SETF (CL:GETHASH #'GET-STREAM-STRING *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'GET-STREAM-STRING (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1563 NIL) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '=-STREAM-USER-DETAIL (CL:CONS (CL:CONS 'MAKE-QUEUE NIL) (CL:CONS 'STR NIL))) NIL)) (CL:CONS '~G1563 NIL))) NIL)) (CL:CONS (CL:CONS 'QUEUE-STRING (CL:CONS (CL:CONS 'STREAM-USER-DETAIL (CL:CONS 'STR NIL)) NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'GET-STREAM-STRING))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'MAKE-STREAM-STREAM (CL:CONS (CL:CONS 'CL:&KEY (CL:CONS 'STREAM (CL:CONS (CL:CONS 'INPUT-LOCATION (CL:CONS (CL:CONS 'MAKE-STREAM-LOCATION NIL) NIL)) (CL:CONS (CL:CONS 'OUTPUT-LOCATION (CL:CONS (CL:CONS 'MAKE-STREAM-LOCATION (CL:CONS ':TRACK? (CL:CONS NIL NIL))) NIL)) NIL)))) NIL)))) (CL:PROGN (CL:DEFUN MAKE-STREAM-STREAM (CL:&KEY STREAM (INPUT-LOCATION (MAKE-STREAM-LOCATION)) (OUTPUT-LOCATION (MAKE-STREAM-LOCATION :TRACK? NIL))) (CL:BLOCK MAKE-STREAM-STREAM (CL:BLOCK NIL (MAKE-STREAM :HANDLE STREAM :INPUT-LOCATION INPUT-LOCATION :OUTPUT-LOCATION OUTPUT-LOCATION :FUN-IN #'(CL:LAMBDA (_) (%READ-CHAR (STREAM-HANDLE _))) :FUN-OUT #'(CL:LAMBDA (C STR) (%PRINC C (STREAM-HANDLE STR))) :FUN-EOF #'(CL:LAMBDA (_) (%FEOF (STREAM-HANDLE _))))))) (CL:SETF (CL:GETHASH #'MAKE-STREAM-STREAM *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&KEY (CL:CONS 'STREAM (CL:CONS (CL:CONS 'INPUT-LOCATION (CL:CONS (CL:CONS 'MAKE-STREAM-LOCATION NIL) NIL)) (CL:CONS (CL:CONS 'OUTPUT-LOCATION (CL:CONS (CL:CONS 'MAKE-STREAM-LOCATION (CL:CONS ':TRACK? (CL:CONS NIL NIL))) NIL)) NIL)))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'MAKE-STREAM-STREAM (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'MAKE-STREAM (CL:CONS ':HANDLE (CL:CONS 'STREAM (CL:CONS ':INPUT-LOCATION (CL:CONS 'INPUT-LOCATION (CL:CONS ':OUTPUT-LOCATION (CL:CONS 'OUTPUT-LOCATION (CL:CONS ':FUN-IN (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '_ NIL) (CL:CONS (CL:CONS '%READ-CHAR (CL:CONS (CL:CONS 'STREAM-HANDLE (CL:CONS '_ NIL)) NIL)) NIL)) NIL)) (CL:CONS ':FUN-OUT (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'C (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS '%PRINC (CL:CONS 'C (CL:CONS (CL:CONS 'STREAM-HANDLE (CL:CONS 'STR NIL)) NIL))) NIL)) NIL)) (CL:CONS ':FUN-EOF (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '_ NIL) (CL:CONS (CL:CONS '%FEOF (CL:CONS (CL:CONS 'STREAM-HANDLE (CL:CONS '_ NIL)) NIL)) NIL)) NIL)) NIL))))))))))))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'MAKE-STREAM-STREAM))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '%FOPEN-DIRECTION (CL:CONS (CL:CONS 'DIRECTION NIL) NIL)))) (CL:PROGN (CL:DEFUN %FOPEN-DIRECTION (DIRECTION) (CL:BLOCK %FOPEN-DIRECTION (CL:BLOCK NIL (CL:LABELS ((G3784 (~G1564) (? (EQUAL ~G1564 'INPUT) "r" (EQUAL ~G1564 'OUTPUT) "w" (EQUAL ~G1564 'APPEND) "a" (ERROR ":DIRECTION isn't specified.")))) (G3784 DIRECTION))))) (CL:SETF (CL:GETHASH #'%FOPEN-DIRECTION *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'DIRECTION NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '%FOPEN-DIRECTION (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1564 NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQUAL (CL:CONS '~G1564 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'INPUT NIL)) NIL))) (CL:CONS "r" (CL:CONS (CL:CONS 'EQUAL (CL:CONS '~G1564 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'OUTPUT NIL)) NIL))) (CL:CONS "w" (CL:CONS (CL:CONS 'EQUAL (CL:CONS '~G1564 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'APPEND NIL)) NIL))) (CL:CONS "a" (CL:CONS (CL:CONS 'ERROR (CL:CONS ":DIRECTION isn't specified." NIL)) NIL)))))))) NIL)) NIL)) (CL:CONS 'DIRECTION NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '%FOPEN-DIRECTION))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'OPEN (CL:CONS (CL:CONS 'PATH (CL:CONS 'CL:&KEY (CL:CONS 'DIRECTION NIL))) NIL)))) (CL:PROGN (CL:DEFUN OPEN (PATH CL:&KEY DIRECTION) (CL:BLOCK OPEN (CL:BLOCK NIL (CL:LABELS ((G3785 (!) (? ! (MAKE-STREAM-STREAM :STREAM ! :INPUT-LOCATION (MAKE-STREAM-LOCATION :ID PATH)) (ERROR "Couldn't open file `~A'." PATH)))) (G3785 (%FOPEN PATH (%FOPEN-DIRECTION DIRECTION))))))) (CL:SETF (CL:GETHASH #'OPEN *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'PATH (CL:CONS 'CL:&KEY (CL:CONS 'DIRECTION NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'OPEN (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET (CL:CONS '! (CL:CONS (CL:CONS '%FOPEN (CL:CONS 'PATH (CL:CONS (CL:CONS '%FOPEN-DIRECTION (CL:CONS 'DIRECTION NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS '! (CL:CONS (CL:CONS 'MAKE-STREAM-STREAM (CL:CONS ':STREAM (CL:CONS '! (CL:CONS ':INPUT-LOCATION (CL:CONS (CL:CONS 'MAKE-STREAM-LOCATION (CL:CONS ':ID (CL:CONS 'PATH NIL))) NIL))))) (CL:CONS (CL:CONS '%!? (CL:CONS (CL:CONS 'ERROR (CL:CONS "Couldn't open file `~A'." (CL:CONS 'PATH NIL))) NIL)) NIL)))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'OPEN))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'CLOSE (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN CLOSE (STR) (CL:BLOCK CLOSE (CL:BLOCK NIL (%FCLOSE (STREAM-HANDLE STR))))) (CL:SETF (CL:GETHASH #'CLOSE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'CLOSE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '%FCLOSE (CL:CONS (CL:CONS 'STREAM-HANDLE (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'CLOSE))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'NUMBER-DIGIT (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN NUMBER-DIGIT (X) (CL:BLOCK NUMBER-DIGIT (CL:BLOCK NIL (CODE-CHAR (+ X #\0))))) (CL:SETF (CL:GETHASH #'NUMBER-DIGIT *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'NUMBER-DIGIT (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CODE-CHAR (CL:CONS (CL:CONS '+ (CL:CONS 'X (CL:CONS #\0 NIL))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'NUMBER-DIGIT))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'INTEGER-CHARS-0 (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN INTEGER-CHARS-0 (X) (CL:BLOCK INTEGER-CHARS-0 (CL:BLOCK NIL (CL:LABELS ((G3786 (!) (CL:CONS (NUMBER-DIGIT !) (? (<= 10 X) (INTEGER-CHARS-0 (/ (- X !) 10)))))) (G3786 (INTEGER (CL:MOD X 10))))))) (CL:SETF (CL:GETHASH #'INTEGER-CHARS-0 *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'INTEGER-CHARS-0 (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'NUMBER-DIGIT (CL:CONS '! NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '<= (CL:CONS 10 (CL:CONS 'X NIL))) (CL:CONS (CL:CONS 'INTEGER-CHARS-0 (CL:CONS (CL:CONS '/ (CL:CONS (CL:CONS '- (CL:CONS 'X (CL:CONS '! NIL))) (CL:CONS 10 NIL))) NIL)) NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'INTEGER (CL:CONS (CL:CONS 'CL:MOD (CL:CONS 'X (CL:CONS 10 NIL))) NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'INTEGER-CHARS-0))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'INTEGER-CHARS (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN INTEGER-CHARS (X) (CL:BLOCK INTEGER-CHARS (CL:BLOCK NIL (REVERSE (INTEGER-CHARS-0 (INTEGER (ABS X))))))) (CL:SETF (CL:GETHASH #'INTEGER-CHARS *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'INTEGER-CHARS (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'REVERSE (CL:CONS (CL:CONS 'INTEGER-CHARS-0 (CL:CONS (CL:CONS 'INTEGER (CL:CONS (CL:CONS 'ABS (CL:CONS 'X NIL)) NIL)) NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'INTEGER-CHARS))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'FRACTION-CHARS-0 (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN FRACTION-CHARS-0 (X) (CL:BLOCK FRACTION-CHARS-0 (CL:BLOCK NIL (CL:LABELS ((G3787 (!) (? (< 0 !) (CL:CONS (NUMBER-DIGIT !) (FRACTION-CHARS-0 !))))) (G3787 (CL:MOD (* X 10) 10)))))) (CL:SETF (CL:GETHASH #'FRACTION-CHARS-0 *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'FRACTION-CHARS-0 (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '< (CL:CONS 0 (CL:CONS '! NIL))) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'NUMBER-DIGIT (CL:CONS '! NIL)) (CL:CONS (CL:CONS 'FRACTION-CHARS-0 (CL:CONS '! NIL)) NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:MOD (CL:CONS (CL:CONS '* (CL:CONS 'X (CL:CONS 10 NIL))) (CL:CONS 10 NIL))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'FRACTION-CHARS-0))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'FRACTION-CHARS (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN FRACTION-CHARS (X) (CL:BLOCK FRACTION-CHARS (CL:BLOCK NIL (FRACTION-CHARS-0 (CL:MOD (ABS X) 1))))) (CL:SETF (CL:GETHASH #'FRACTION-CHARS *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'FRACTION-CHARS (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'FRACTION-CHARS-0 (CL:CONS (CL:CONS 'CL:MOD (CL:CONS (CL:CONS 'ABS (CL:CONS 'X NIL)) (CL:CONS 1 NIL))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'FRACTION-CHARS))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'PRINC-NUMBER (CL:CONS (CL:CONS 'X (CL:CONS 'STR NIL)) NIL)))) (CL:PROGN (CL:DEFUN PRINC-NUMBER (X STR) (CL:BLOCK PRINC-NUMBER (CL:BLOCK NIL (? (< X 0) (PRINC #\- STR)) (STREAM-PRINC (INTEGER-CHARS X) STR) (CL:LABELS ((G3788 (!) (? (NOT (ZERO? !)) (CL:PROGN (PRINC #\. STR) (STREAM-PRINC (FRACTION-CHARS !) STR))))) (G3788 (CL:MOD X 1)))))) (CL:SETF (CL:GETHASH #'PRINC-NUMBER *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'PRINC-NUMBER (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '< (CL:CONS 'X (CL:CONS 0 NIL))) (CL:CONS (CL:CONS 'PRINC (CL:CONS #\- (CL:CONS 'STR NIL))) NIL))) (CL:CONS (CL:CONS 'STREAM-PRINC (CL:CONS (CL:CONS 'INTEGER-CHARS (CL:CONS 'X NIL)) (CL:CONS 'STR NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '& (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS 'ZERO? (CL:CONS '! NIL)) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'PRINC (CL:CONS #\. (CL:CONS 'STR NIL))) (CL:CONS (CL:CONS 'STREAM-PRINC (CL:CONS (CL:CONS 'FRACTION-CHARS (CL:CONS '! NIL)) (CL:CONS 'STR NIL))) NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:MOD (CL:CONS 'X (CL:CONS 1 NIL))) NIL)) NIL))))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'PRINC-NUMBER))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'PRINC (CL:CONS (CL:CONS 'X (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-OUTPUT* NIL)) NIL))) NIL)))) (CL:PROGN (CL:DEFUN PRINC (X CL:&OPTIONAL (STR *STANDARD-OUTPUT*)) (CL:BLOCK PRINC (CL:BLOCK NIL (CL:LABELS ((G3789 (~G1565) (CL:LABELS ((G3790 (S) (CL:LABELS ((G3791 (~G1566) (? ~G1565 ~G1566 (GET-STREAM-STRING S)))) (G3791 (CL:PROGN (? (STRING? X) (STREAM-PRINC X S) (CHARACTER? X) (STREAM-PRINC X S) (NUMBER? X) (PRINC-NUMBER X S) (SYMBOL? X) (STREAM-PRINC (SYMBOL-NAME X) S)) X))))) (G3790 (DEFAULT-STREAM ~G1565))))) (G3789 STR))))) (CL:SETF (CL:GETHASH #'PRINC *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-OUTPUT* NIL)) NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'PRINC (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET (CL:CONS '~G1565 (CL:CONS 'STR (CL:CONS (CL:CONS 'WITH (CL:CONS (CL:CONS 'S (CL:CONS (CL:CONS 'DEFAULT-STREAM (CL:CONS '~G1565 NIL)) (CL:CONS '~G1566 (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'STRING? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'STREAM-PRINC (CL:CONS 'X (CL:CONS 'S NIL))) (CL:CONS (CL:CONS 'CHARACTER? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'STREAM-PRINC (CL:CONS 'X (CL:CONS 'S NIL))) (CL:CONS (CL:CONS 'NUMBER? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'PRINC-NUMBER (CL:CONS 'X (CL:CONS 'S NIL))) (CL:CONS (CL:CONS 'SYMBOL? (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'STREAM-PRINC (CL:CONS (CL:CONS 'SYMBOL-NAME (CL:CONS 'X NIL)) (CL:CONS 'S NIL))) NIL))))))))) (CL:CONS 'X NIL))) NIL)))) (CL:CONS (CL:CONS '? (CL:CONS '~G1565 (CL:CONS '~G1566 (CL:CONS (CL:CONS 'GET-STREAM-STRING (CL:CONS 'S NIL)) NIL)))) NIL))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'PRINC))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'SPLIT-IF (CL:CONS (CL:CONS 'PREDICATE (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'INCLUDE? (CL:CONS NIL NIL)) NIL)))) NIL)))) (CL:PROGN (CL:DEFUN SPLIT-IF (PREDICATE SEQ CL:&KEY (INCLUDE? NIL)) (CL:BLOCK SPLIT-IF (CL:BLOCK NIL (? SEQ (CL:LABELS ((G3792 (!) (? ! (CL:CONS (SUBSEQ SEQ 0 (? INCLUDE? (++ !) !)) (SPLIT-IF PREDICATE (SUBSEQ SEQ (++ !)) :INCLUDE? INCLUDE?)) (CL:LIST SEQ)))) (G3792 (POSITION-IF PREDICATE SEQ))))))) (CL:SETF (CL:GETHASH #'SPLIT-IF *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'PREDICATE (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'INCLUDE? (CL:CONS NIL NIL)) NIL)))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'SPLIT-IF (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS 'SEQ (CL:CONS (CL:CONS 'LET (CL:CONS '! (CL:CONS (CL:CONS 'POSITION-IF (CL:CONS 'PREDICATE (CL:CONS 'SEQ NIL))) (CL:CONS (CL:CONS '? (CL:CONS '! (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'SUBSEQ (CL:CONS 'SEQ (CL:CONS 0 (CL:CONS (CL:CONS '? (CL:CONS 'INCLUDE? (CL:CONS (CL:CONS '++ (CL:CONS '! NIL)) (CL:CONS '! NIL)))) NIL)))) (CL:CONS (CL:CONS 'SPLIT-IF (CL:CONS 'PREDICATE (CL:CONS (CL:CONS 'SUBSEQ (CL:CONS 'SEQ (CL:CONS (CL:CONS '++ (CL:CONS '! NIL)) NIL))) (CL:CONS ':INCLUDE? (CL:CONS 'INCLUDE? NIL))))) NIL))) (CL:CONS (CL:CONS '%!? (CL:CONS (CL:CONS 'CL:LIST (CL:CONS 'SEQ NIL)) NIL)) NIL)))) NIL)))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'SPLIT-IF))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'GENERIC-SPLIT (CL:CONS (CL:CONS 'OBJ (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'TEST (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'EQL NIL)) NIL)) (CL:CONS (CL:CONS 'INCLUDE? (CL:CONS NIL NIL)) NIL))))) NIL)))) (CL:PROGN (CL:DEFUN GENERIC-SPLIT (OBJ SEQ CL:&KEY (TEST #'EQL) (INCLUDE? NIL)) (CL:BLOCK GENERIC-SPLIT (CL:BLOCK NIL (? SEQ (CL:LABELS ((G3793 (!) (? ! (CL:CONS (SUBSEQ SEQ 0 (? INCLUDE? (++ !) !)) (GENERIC-SPLIT OBJ (SUBSEQ SEQ (++ !)) :TEST TEST :INCLUDE? INCLUDE?)) (CL:LIST SEQ)))) (G3793 (POSITION OBJ SEQ :TEST TEST))))))) (CL:SETF (CL:GETHASH #'GENERIC-SPLIT *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'OBJ (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'TEST (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'EQL NIL)) NIL)) (CL:CONS (CL:CONS 'INCLUDE? (CL:CONS NIL NIL)) NIL))))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'GENERIC-SPLIT (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS 'SEQ (CL:CONS (CL:CONS 'LET (CL:CONS '! (CL:CONS (CL:CONS 'POSITION (CL:CONS 'OBJ (CL:CONS 'SEQ (CL:CONS ':TEST (CL:CONS 'TEST NIL))))) (CL:CONS (CL:CONS '? (CL:CONS '! (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'SUBSEQ (CL:CONS 'SEQ (CL:CONS 0 (CL:CONS (CL:CONS '? (CL:CONS 'INCLUDE? (CL:CONS (CL:CONS '++ (CL:CONS '! NIL)) (CL:CONS '! NIL)))) NIL)))) (CL:CONS (CL:CONS 'GENERIC-SPLIT (CL:CONS 'OBJ (CL:CONS (CL:CONS 'SUBSEQ (CL:CONS 'SEQ (CL:CONS (CL:CONS '++ (CL:CONS '! NIL)) NIL))) (CL:CONS ':TEST (CL:CONS 'TEST (CL:CONS ':INCLUDE? (CL:CONS 'INCLUDE? NIL))))))) NIL))) (CL:CONS (CL:CONS '%!? (CL:CONS (CL:CONS 'CL:LIST (CL:CONS 'SEQ NIL)) NIL)) NIL)))) NIL)))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'GENERIC-SPLIT))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'SPLIT (CL:CONS (CL:CONS 'OBJ (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'TEST (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'EQL NIL)) NIL)) (CL:CONS (CL:CONS 'INCLUDE? (CL:CONS NIL NIL)) NIL))))) NIL)))) (CL:PROGN (CL:DEFUN SPLIT (OBJ SEQ CL:&KEY (TEST #'EQL) (INCLUDE? NIL)) (CL:BLOCK SPLIT (CL:BLOCK NIL (GENERIC-SPLIT OBJ SEQ :TEST TEST :INCLUDE? INCLUDE?)))) (CL:SETF (CL:GETHASH #'SPLIT *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'OBJ (CL:CONS 'SEQ (CL:CONS 'CL:&KEY (CL:CONS (CL:CONS 'TEST (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS 'EQL NIL)) NIL)) (CL:CONS (CL:CONS 'INCLUDE? (CL:CONS NIL NIL)) NIL))))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'SPLIT (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'GENERIC-SPLIT (CL:CONS 'OBJ (CL:CONS 'SEQ (CL:CONS ':TEST (CL:CONS 'TEST (CL:CONS ':INCLUDE? (CL:CONS 'INCLUDE? NIL))))))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'SPLIT))
(CL:SETQ *FUNCTIONALS* (%NCONC (CL:CONS 'DIGIT-NUMBER NIL) *FUNCTIONALS*))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'DIGIT-NUMBER (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN DIGIT-NUMBER (X) (CL:BLOCK DIGIT-NUMBER (CL:BLOCK NIL (- X #\0)))) (CL:SETF (CL:GETHASH #'DIGIT-NUMBER *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'DIGIT-NUMBER (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '- (CL:CONS 'X (CL:CONS #\0 NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'DIGIT-NUMBER))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'PEEK-DIGIT (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN PEEK-DIGIT (STR) (CL:BLOCK PEEK-DIGIT (CL:BLOCK NIL (CL:LABELS ((G3794 (!) (? ! (CL:PROGN (? (DIGIT-CHAR? !) !))))) (G3794 (PEEK-CHAR STR)))))) (CL:SETF (CL:GETHASH #'PEEK-DIGIT *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'PEEK-DIGIT (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '& (CL:CONS '! (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'DIGIT-CHAR? (CL:CONS '! NIL)) (CL:CONS '! NIL))) NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'PEEK-DIGIT))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'PEEK-DOT (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN PEEK-DOT (STR) (CL:BLOCK PEEK-DOT (CL:BLOCK NIL (CL:LABELS ((G3795 (!) (? ! (CL:PROGN (== #\. !))))) (G3795 (PEEK-CHAR STR)))))) (CL:SETF (CL:GETHASH #'PEEK-DOT *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'PEEK-DOT (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '& (CL:CONS '! (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '== (CL:CONS #\. (CL:CONS '! NIL))) NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'PEEK-DOT))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-DECIMAL-PLACES-0 (CL:CONS (CL:CONS 'STR (CL:CONS 'V (CL:CONS 'S NIL))) NIL)))) (CL:PROGN (CL:DEFUN READ-DECIMAL-PLACES-0 (STR V S) (CL:BLOCK READ-DECIMAL-PLACES-0 (CL:BLOCK NIL (? (PEEK-DIGIT STR) (READ-DECIMAL-PLACES-0 STR (+ V (* S (DIGIT-NUMBER (READ-CHAR STR)))) (/ S 10)) V)))) (CL:SETF (CL:GETHASH #'READ-DECIMAL-PLACES-0 *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR (CL:CONS 'V (CL:CONS 'S NIL))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-DECIMAL-PLACES-0 (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'PEEK-DIGIT (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'READ-DECIMAL-PLACES-0 (CL:CONS 'STR (CL:CONS (CL:CONS '+ (CL:CONS 'V (CL:CONS (CL:CONS '* (CL:CONS 'S (CL:CONS (CL:CONS 'DIGIT-NUMBER (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) (CL:CONS (CL:CONS '/ (CL:CONS 'S (CL:CONS 10 NIL))) NIL)))) (CL:CONS 'V NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-DECIMAL-PLACES-0))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-DECIMAL-PLACES (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-INPUT* NIL)) NIL)) NIL)))) (CL:PROGN (CL:DEFUN READ-DECIMAL-PLACES (CL:&OPTIONAL (STR *STANDARD-INPUT*)) (CL:BLOCK READ-DECIMAL-PLACES (CL:BLOCK NIL (? (CL:LABELS ((G3796 (!) (? ! (DIGIT-CHAR? !)))) (G3796 (PEEK-CHAR STR))) (READ-DECIMAL-PLACES-0 STR 0 0.1))))) (CL:SETF (CL:GETHASH #'READ-DECIMAL-PLACES *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-INPUT* NIL)) NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-DECIMAL-PLACES (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'LET (CL:CONS '! (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS '? (CL:CONS '! (CL:CONS (CL:CONS 'DIGIT-CHAR? (CL:CONS '! NIL)) NIL))) NIL)))) (CL:CONS (CL:CONS 'READ-DECIMAL-PLACES-0 (CL:CONS 'STR (CL:CONS 0 (CL:CONS 0.1 NIL)))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-DECIMAL-PLACES))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-INTEGER-0 (CL:CONS (CL:CONS 'STR (CL:CONS 'V NIL)) NIL)))) (CL:PROGN (CL:DEFUN READ-INTEGER-0 (STR V) (CL:BLOCK READ-INTEGER-0 (CL:BLOCK NIL (? (PEEK-DIGIT STR) (READ-INTEGER-0 STR (+ (* V 10) (DIGIT-NUMBER (READ-CHAR STR)))) V)))) (CL:SETF (CL:GETHASH #'READ-INTEGER-0 *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR (CL:CONS 'V NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-INTEGER-0 (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'PEEK-DIGIT (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'READ-INTEGER-0 (CL:CONS 'STR (CL:CONS (CL:CONS '+ (CL:CONS (CL:CONS '* (CL:CONS 'V (CL:CONS 10 NIL))) (CL:CONS (CL:CONS 'DIGIT-NUMBER (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) (CL:CONS 'V NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-INTEGER-0))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-INTEGER (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-INPUT* NIL)) NIL)) NIL)))) (CL:PROGN (CL:DEFUN READ-INTEGER (CL:&OPTIONAL (STR *STANDARD-INPUT*)) (CL:BLOCK READ-INTEGER (CL:BLOCK NIL (? (PEEK-DIGIT STR) (INTEGER (READ-INTEGER-0 STR 0)))))) (CL:SETF (CL:GETHASH #'READ-INTEGER *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-INPUT* NIL)) NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-INTEGER (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'PEEK-DIGIT (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'INTEGER (CL:CONS (CL:CONS 'READ-INTEGER-0 (CL:CONS 'STR (CL:CONS 0 NIL))) NIL)) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-INTEGER))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-NUMBER (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-INPUT* NIL)) NIL)) NIL)))) (CL:PROGN (CL:DEFUN READ-NUMBER (CL:&OPTIONAL (STR *STANDARD-INPUT*)) (CL:BLOCK READ-NUMBER (CL:BLOCK NIL (* (? (== #\- (PEEK-CHAR STR)) (CL:PROGN (READ-CHAR STR) -1) 1) (+ (READ-INTEGER STR) (CL:LABELS ((G3797 (~G1567) (? ~G1567 ~G1567 0))) (G3797 (? (PEEK-DOT STR) (? (READ-CHAR STR) (READ-DECIMAL-PLACES STR)))))))))) (CL:SETF (CL:GETHASH #'READ-NUMBER *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-INPUT* NIL)) NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-NUMBER (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '* (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS #\- (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'STR NIL)) NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) (CL:CONS -1 NIL))) (CL:CONS 1 NIL)))) (CL:CONS (CL:CONS '+ (CL:CONS (CL:CONS 'READ-INTEGER (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1567 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1567 (CL:CONS '~G1567 (CL:CONS 0 NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'PEEK-DOT (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'READ-DECIMAL-PLACES (CL:CONS 'STR NIL)) NIL))) NIL))) NIL)) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-NUMBER))
(%DEFVAR *READER-FINDS-SYMBOLS?* NIL)
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'TOKEN-IS-QUOTE? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN TOKEN-IS-QUOTE? (X) (CL:BLOCK TOKEN-IS-QUOTE? (CL:BLOCK NIL (CL:LABELS ((G3798 (~G1596) (? ~G1596 ~G1596 (CL:LABELS ((G3799 (~G1597) (? ~G1597 ~G1597 (CL:LABELS ((G3800 (~G1598) (? ~G1598 ~G1598 (CL:LABELS ((G3801 (~G1599) (? ~G1599 ~G1599 (EQ X 'ACCENT-CIRCONFLEX)))) (G3801 (EQ X 'QUASIQUOTE-SPLICE)))))) (G3800 (EQ X 'QUASIQUOTE)))))) (G3799 (EQ X 'BACKQUOTE)))))) (G3798 (EQ X 'CL:QUOTE)))))) (CL:SETF (CL:GETHASH #'TOKEN-IS-QUOTE? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'TOKEN-IS-QUOTE? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET (CL:CONS '~G1596 (CL:CONS (CL:CONS 'EQ (CL:CONS 'X (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CL:QUOTE NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1596 (CL:CONS '~G1596 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1597 (CL:CONS (CL:CONS 'EQ (CL:CONS 'X (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'BACKQUOTE NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1597 (CL:CONS '~G1597 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1598 (CL:CONS (CL:CONS 'EQ (CL:CONS 'X (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'QUASIQUOTE NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1598 (CL:CONS '~G1598 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1599 (CL:CONS (CL:CONS 'EQ (CL:CONS 'X (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'QUASIQUOTE-SPLICE NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1599 (CL:CONS '~G1599 (CL:CONS (CL:CONS 'EQ (CL:CONS 'X (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'ACCENT-CIRCONFLEX NIL)) NIL))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'TOKEN-IS-QUOTE?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '%READ-CLOSING-BRACKET? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN %READ-CLOSING-BRACKET? (X) (CL:BLOCK %READ-CLOSING-BRACKET? (CL:BLOCK NIL (CL:LABELS ((G3802 (~G1600) (? ~G1600 ~G1600 (CL:LABELS ((G3803 (~G1601) (? ~G1601 ~G1601 (EQ X 'CURLY-BRACKET-CLOSE)))) (G3803 (EQ X 'SQUARE-BRACKET-CLOSE)))))) (G3802 (EQ X 'BRACKET-CLOSE)))))) (CL:SETF (CL:GETHASH #'%READ-CLOSING-BRACKET? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '%READ-CLOSING-BRACKET? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET (CL:CONS '~G1600 (CL:CONS (CL:CONS 'EQ (CL:CONS 'X (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'BRACKET-CLOSE NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1600 (CL:CONS '~G1600 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1601 (CL:CONS (CL:CONS 'EQ (CL:CONS 'X (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'SQUARE-BRACKET-CLOSE NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1601 (CL:CONS '~G1601 (CL:CONS (CL:CONS 'EQ (CL:CONS 'X (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CURLY-BRACKET-CLOSE NIL)) NIL))) NIL)))) NIL)))) NIL)))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '%READ-CLOSING-BRACKET?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'SPECIAL-CHAR? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN SPECIAL-CHAR? (X) (CL:BLOCK SPECIAL-CHAR? (CL:BLOCK NIL (CL:LABELS ((G3804 (~G1602) (? ~G1602 ~G1602 (CL:LABELS ((G3805 (~G1603) (? ~G1603 ~G1603 (CL:LABELS ((G3806 (~G1604) (? ~G1604 ~G1604 (CL:LABELS ((G3807 (~G1605) (? ~G1605 ~G1605 (CL:LABELS ((G3808 (~G1606) (? ~G1606 ~G1606 (CL:LABELS ((G3809 (~G1607) (? ~G1607 ~G1607 (CL:LABELS ((G3810 (~G1608) (? ~G1608 ~G1608 (CL:LABELS ((G3811 (~G1609) (? ~G1609 ~G1609 (CL:LABELS ((G3812 (~G1610) (? ~G1610 ~G1610 (CL:LABELS ((G3813 (~G1611) (? ~G1611 ~G1611 (CL:LABELS ((G3814 (~G1612) (? ~G1612 ~G1612 (CL:LABELS ((G3815 (~G1613) (? ~G1613 ~G1613 (CL:LABELS ((G3816 (~G1614) (? ~G1614 ~G1614 (== X #\^)))) (G3816 (== X #\#)))))) (G3815 (== X #\")))))) (G3814 (== X #\;)))))) (G3813 (== X #\:)))))) (G3812 (== X #\,)))))) (G3811 (== X #\`)))))) (G3810 (== X #\')))))) (G3809 (== X #\})))))) (G3808 (== X #\{)))))) (G3807 (== X #\])))))) (G3806 (== X #\[)))))) (G3805 (== X #\))))))) (G3804 (== X #\()))))) (CL:SETF (CL:GETHASH #'SPECIAL-CHAR? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'SPECIAL-CHAR? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET (CL:CONS '~G1602 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\( NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1602 (CL:CONS '~G1602 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1603 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\) NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1603 (CL:CONS '~G1603 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1604 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\[ NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1604 (CL:CONS '~G1604 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1605 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\] NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1605 (CL:CONS '~G1605 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1606 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\{ NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1606 (CL:CONS '~G1606 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1607 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\} NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1607 (CL:CONS '~G1607 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1608 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\' NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1608 (CL:CONS '~G1608 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1609 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\` NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1609 (CL:CONS '~G1609 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1610 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\, NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1610 (CL:CONS '~G1610 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1611 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\: NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1611 (CL:CONS '~G1611 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1612 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\; NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1612 (CL:CONS '~G1612 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1613 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\" NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1613 (CL:CONS '~G1613 (CL:CONS (CL:CONS 'LET (CL:CONS '~G1614 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\# NIL))) (CL:CONS (CL:CONS '? (CL:CONS '~G1614 (CL:CONS '~G1614 (CL:CONS (CL:CONS '== (CL:CONS 'X (CL:CONS #\^ NIL))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'SPECIAL-CHAR?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'SYMBOL-CHAR? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN SYMBOL-CHAR? (X) (CL:BLOCK SYMBOL-CHAR? (CL:BLOCK NIL (? (> X 32) (NOT (SPECIAL-CHAR? X)))))) (CL:SETF (CL:GETHASH #'SYMBOL-CHAR? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'SYMBOL-CHAR? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '> (CL:CONS 'X (CL:CONS 32 NIL))) (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS 'SPECIAL-CHAR? (CL:CONS 'X NIL)) NIL)) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'SYMBOL-CHAR?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'SKIP-COMMENT (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN SKIP-COMMENT (STR) (CL:BLOCK SKIP-COMMENT (CL:BLOCK NIL (CL:LABELS ((G3817 (C) (? C (CL:PROGN (? (== C 10) (SKIP-SPACES STR) (SKIP-COMMENT STR)))))) (G3817 (READ-CHAR STR)))))) (CL:SETF (CL:GETHASH #'SKIP-COMMENT *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'SKIP-COMMENT (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'C NIL) (CL:CONS (CL:CONS '& (CL:CONS 'C (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS 'C (CL:CONS 10 NIL))) (CL:CONS (CL:CONS 'SKIP-SPACES (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'SKIP-COMMENT (CL:CONS 'STR NIL)) NIL)))) NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'SKIP-COMMENT))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'SKIP-SPACES (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN SKIP-SPACES (STR) (CL:BLOCK SKIP-SPACES (CL:BLOCK NIL (CL:LABELS ((G3818 (C) (? C (CL:PROGN (? (== #\; C) (CL:PROGN (SKIP-COMMENT STR))) (? (WHITESPACE? C) (CL:PROGN (READ-CHAR STR) (SKIP-SPACES STR))))))) (G3818 (PEEK-CHAR STR)))))) (CL:SETF (CL:GETHASH #'SKIP-SPACES *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'SKIP-SPACES (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'C NIL) (CL:CONS (CL:CONS '& (CL:CONS 'C (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS #\; (CL:CONS 'C NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'SKIP-COMMENT (CL:CONS 'STR NIL)) NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'WHITESPACE? (CL:CONS 'C NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'SKIP-SPACES (CL:CONS 'STR NIL)) NIL))) NIL))) NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'SKIP-SPACES))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'GET-SYMBOL-0 (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN GET-SYMBOL-0 (STR) (CL:BLOCK GET-SYMBOL-0 (CL:BLOCK NIL (CL:LABELS ((G3819 (C) (? (== #\; C) (CL:PROGN (SKIP-COMMENT STR) (GET-SYMBOL-0 STR)) (? (SYMBOL-CHAR? C) (CL:CONS (CHAR-UPCASE (READ-CHAR STR)) (GET-SYMBOL-0 STR)))))) (G3819 (CHAR-UPCASE (PEEK-CHAR STR))))))) (CL:SETF (CL:GETHASH #'GET-SYMBOL-0 *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'GET-SYMBOL-0 (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'C NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS #\; (CL:CONS 'C NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'SKIP-COMMENT (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'GET-SYMBOL-0 (CL:CONS 'STR NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'SYMBOL-CHAR? (CL:CONS 'C NIL)) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'CHAR-UPCASE (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) NIL)) (CL:CONS (CL:CONS 'GET-SYMBOL-0 (CL:CONS 'STR NIL)) NIL))) NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CHAR-UPCASE (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'STR NIL)) NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'GET-SYMBOL-0))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'GET-SYMBOL (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN GET-SYMBOL (STR) (CL:BLOCK GET-SYMBOL (CL:BLOCK NIL (CL:LABELS ((G3820 (C) (? C (CL:PROGN (? (NOT (SPECIAL-CHAR? C)) (CL:PROGN (GET-SYMBOL-0 STR))))))) (G3820 (PEEK-CHAR STR)))))) (CL:SETF (CL:GETHASH #'GET-SYMBOL *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'GET-SYMBOL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'C NIL) (CL:CONS (CL:CONS '& (CL:CONS 'C (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '& (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS 'SPECIAL-CHAR? (CL:CONS 'C NIL)) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'GET-SYMBOL-0 (CL:CONS 'STR NIL)) NIL)) NIL))) NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'GET-SYMBOL))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'GET-SYMBOL-AND-PACKAGE (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN GET-SYMBOL-AND-PACKAGE (STR) (CL:BLOCK GET-SYMBOL-AND-PACKAGE (CL:BLOCK NIL (SKIP-SPACES STR) (CL:LABELS ((G3821 (SYM) (CL:LABELS ((G3822 (!) (? ! (CL:PROGN (? (== ! #\:) (VALUES (CL:LABELS ((G3823 (~G1568) (? ~G1568 ~G1568 T))) (G3823 SYM)) (? (READ-CHAR STR) (GET-SYMBOL STR))) (VALUES NIL SYM)))))) (G3822 (PEEK-CHAR STR))))) (G3821 (GET-SYMBOL STR)))))) (CL:SETF (CL:GETHASH #'GET-SYMBOL-AND-PACKAGE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'GET-SYMBOL-AND-PACKAGE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'SKIP-SPACES (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'SYM NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '& (CL:CONS '! (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS '! (CL:CONS #\: NIL))) (CL:CONS (CL:CONS 'VALUES (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1568 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1568 (CL:CONS '~G1568 (CL:CONS T NIL)))) NIL)) NIL)) (CL:CONS 'SYM NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'GET-SYMBOL (CL:CONS 'STR NIL)) NIL))) NIL))) (CL:CONS (CL:CONS 'VALUES (CL:CONS NIL (CL:CONS 'SYM NIL))) NIL)))) NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'STR NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'GET-SYMBOL (CL:CONS 'STR NIL)) NIL)) NIL)))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'GET-SYMBOL-AND-PACKAGE))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-STRING-0 (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN READ-STRING-0 (STR) (CL:BLOCK READ-STRING-0 (CL:BLOCK NIL (CL:LABELS ((G3824 (C) (? (NOT (== C #\")) (CL:PROGN (CL:CONS (? (== C #\\) (READ-CHAR STR) C) (READ-STRING-0 STR)))))) (G3824 (READ-CHAR STR)))))) (CL:SETF (CL:GETHASH #'READ-STRING-0 *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-STRING-0 (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'C NIL) (CL:CONS (CL:CONS '& (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS '== (CL:CONS 'C (CL:CONS #\" NIL))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS 'C (CL:CONS #\\ NIL))) (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) (CL:CONS 'C NIL)))) (CL:CONS (CL:CONS 'READ-STRING-0 (CL:CONS 'STR NIL)) NIL))) NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-STRING-0))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-STRING (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN READ-STRING (STR) (CL:BLOCK READ-STRING (CL:BLOCK NIL (LIST-STRING (READ-STRING-0 STR))))) (CL:SETF (CL:GETHASH #'READ-STRING *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-STRING (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LIST-STRING (CL:CONS (CL:CONS 'READ-STRING-0 (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-STRING))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-COMMENT-BLOCK (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN READ-COMMENT-BLOCK (STR) (CL:BLOCK READ-COMMENT-BLOCK (CL:BLOCK NIL (CL:BLOCK NIL (CL:PROGN (CL:TAGBODY ~G1615 (? (NOT (NOT (? (== #\| (READ-CHAR STR)) (== #\# (PEEK-CHAR STR))))) (CL:RETURN-FROM NIL (CL:PROGN (READ-CHAR STR)))) NIL (CL:GO ~G1615))))))) (CL:SETF (CL:GETHASH #'READ-COMMENT-BLOCK *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-COMMENT-BLOCK (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS NIL (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1615 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS #\| (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) NIL))) (CL:CONS (CL:CONS '== (CL:CONS #\# (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'STR NIL)) NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:RETURN (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) NIL)) NIL)) NIL))) (CL:CONS NIL (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1615 NIL)) NIL))))) NIL))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-COMMENT-BLOCK))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'LIST-NUMBER? (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN LIST-NUMBER? (X) (CL:BLOCK LIST-NUMBER? (CL:BLOCK NIL (? (CL:LABELS ((G3825 (~G1570) (? ~G1570 ~G1570 (DIGIT-CHAR? (CL:CAR X))))) (G3825 (? (CL:CDR X) (CL:LABELS ((G3826 (~G1569) (? ~G1569 ~G1569 (== #\. (CL:CAR X))))) (G3826 (== #\- (CL:CAR X))))))) (? (CL:CDR X) (EVERY #'(CL:LAMBDA (_) (CL:LABELS ((G3827 (~G1636) (? ~G1636 ~G1636 (== #\. _)))) (G3827 (DIGIT-CHAR? _)))) (CL:CDR X)) T))))) (CL:SETF (CL:GETHASH #'LIST-NUMBER? *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'LIST-NUMBER? (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1570 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1570 (CL:CONS '~G1570 (CL:CONS (CL:CONS 'DIGIT-CHAR? (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1569 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1569 (CL:CONS '~G1569 (CL:CONS (CL:CONS '== (CL:CONS #\. (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '== (CL:CONS #\- (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL))) NIL)) NIL))) NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'EVERY (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '_ NIL) (CL:CONS (CL:CONS '|\|| (CL:CONS (CL:CONS 'DIGIT-CHAR? (CL:CONS '_ NIL)) (CL:CONS (CL:CONS '== (CL:CONS #\. (CL:CONS '_ NIL))) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) NIL))) (CL:CONS T NIL)))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'LIST-NUMBER?))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-TOKEN (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN READ-TOKEN (STR) (CL:BLOCK READ-TOKEN (CL:BLOCK NIL (CL:LABELS ((G3828 (!) (? ! (CL:PROGN (CL:LABELS ((G3829 (~G1616) (CL:LABELS ((G3830 (~G1617) (? (NOT (EQ (CL:CAR ~G1616) 'VALUES)) (CL:PROGN (ERROR "VALUES expected instead of ~A." ~G1616))) (CL:LABELS ((G3831 (PKG) (CL:LABELS ((G3832 (~G1618) (CL:LABELS ((G3833 (SYM) (VALUES (? (? SYM (? (NOT (CL:CDR SYM)) (== #\. (CL:CAR SYM)))) 'DOT (? SYM (? (LIST-NUMBER? SYM) 'NUMBER 'SYMBOL) (CL:LABELS ((G3834 (~G1572) (? (CHARACTER== ~G1572 #\() 'BRACKET-OPEN (CHARACTER== ~G1572 #\)) 'BRACKET-CLOSE (CHARACTER== ~G1572 #\[) 'SQUARE-BRACKET-OPEN (CHARACTER== ~G1572 #\]) 'SQUARE-BRACKET-CLOSE (CHARACTER== ~G1572 #\{) 'CURLY-BRACKET-OPEN (CHARACTER== ~G1572 #\}) 'CURLY-BRACKET-CLOSE (CHARACTER== ~G1572 #\') 'CL:QUOTE (CHARACTER== ~G1572 #\`) 'BACKQUOTE (CHARACTER== ~G1572 #\^) 'ACCENT-CIRCONFLEX (CHARACTER== ~G1572 #\") 'DBLQUOTE (CHARACTER== ~G1572 #\,) (? (== #\@ (PEEK-CHAR STR)) (? (READ-CHAR STR) 'QUASIQUOTE-SPLICE) 'QUASIQUOTE) (CHARACTER== ~G1572 #\#) (CL:LABELS ((G3835 (~G1571) (? (CHARACTER== ~G1571 #\\) 'CHAR (CHARACTER== ~G1571 #\x) 'HEXNUM (CHARACTER== ~G1571 #\') 'CL:FUNCTION (CHARACTER== ~G1571 #\|) (READ-COMMENT-BLOCK STR) (ERROR "Invalid character after '#'.")))) (G3835 (READ-CHAR STR))) (CHARACTER== ~G1572 -1) 'EOF))) (G3834 (READ-CHAR STR))))) PKG SYM))) (G3833 (CL:CAR ~G1618))))) (G3832 (CL:LABELS ((G3836 (~G1637) (? ~G1637 ~G1637 (%ERROR "Not enough VALUES.")))) (G3836 (CL:CDR ~G1617))))))) (G3831 (CL:CAR ~G1617))))) (G3830 (CL:CDR ~G1616))))) (G3829 !)))))) (G3828 (GET-SYMBOL-AND-PACKAGE STR)))))) (CL:SETF (CL:GETHASH #'READ-TOKEN *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-TOKEN (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '& (CL:CONS '! (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1616 (CL:CONS '! NIL)) (CL:CONS (CL:CONS '~G1617 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1616 NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'UNLESS (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1616 NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'VALUES NIL)) NIL))) (CL:CONS (CL:CONS 'ERROR (CL:CONS "VALUES expected instead of ~A." (CL:CONS '~G1616 NIL))) NIL))) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'PKG (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1617 NIL)) NIL)) (CL:CONS (CL:CONS '~G1618 (CL:CONS (CL:CONS '|\|| (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1617 NIL)) (CL:CONS (CL:CONS '%ERROR (CL:CONS "Not enough VALUES." NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'SYM (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1618 NIL)) NIL)) NIL) (CL:CONS (CL:CONS 'VALUES (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '? (CL:CONS 'SYM (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'SYM NIL)) NIL)) (CL:CONS (CL:CONS '== (CL:CONS #\. (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'SYM NIL)) NIL))) NIL))) NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'DOT NIL)) (CL:CONS (CL:CONS '? (CL:CONS 'SYM (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'LIST-NUMBER? (CL:CONS 'SYM NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'NUMBER NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'SYMBOL NIL)) NIL)))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1572 NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1572 (CL:CONS #\( NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'BRACKET-OPEN NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1572 (CL:CONS #\) NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'BRACKET-CLOSE NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1572 (CL:CONS #\[ NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'SQUARE-BRACKET-OPEN NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1572 (CL:CONS #\] NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'SQUARE-BRACKET-CLOSE NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1572 (CL:CONS #\{ NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CURLY-BRACKET-OPEN NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1572 (CL:CONS #\} NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CURLY-BRACKET-CLOSE NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1572 (CL:CONS #\' NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CL:QUOTE NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1572 (CL:CONS #\` NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'BACKQUOTE NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1572 (CL:CONS #\^ NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'ACCENT-CIRCONFLEX NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1572 (CL:CONS #\" NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'DBLQUOTE NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1572 (CL:CONS #\, NIL))) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS #\@ (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'STR NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'QUASIQUOTE-SPLICE NIL)) NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'QUASIQUOTE NIL)) NIL)))) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1572 (CL:CONS #\# NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1571 NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1571 (CL:CONS #\\ NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CHAR NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1571 (CL:CONS #\x NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'HEXNUM NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1571 (CL:CONS #\' NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CL:FUNCTION NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1571 (CL:CONS #\| NIL))) (CL:CONS (CL:CONS 'READ-COMMENT-BLOCK (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'ERROR (CL:CONS "Invalid character after '#'." NIL)) NIL)))))))))) NIL)) NIL)) (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) NIL)) (CL:CONS (CL:CONS 'CHARACTER== (CL:CONS '~G1572 (CL:CONS -1 NIL))) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'EOF NIL)) NIL))))))))))))))))))))))))))) NIL)) NIL)) (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) NIL)) NIL)))) NIL)))) (CL:CONS 'PKG (CL:CONS 'SYM NIL)))) NIL))) NIL))) NIL)))) NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'GET-SYMBOL-AND-PACKAGE (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-TOKEN))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-SLOT-VALUE (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN READ-SLOT-VALUE (X) (CL:BLOCK READ-SLOT-VALUE (CL:BLOCK NIL (? X (? (CL:CDR X) (CL:CONS 'SLOT-VALUE (CL:CONS (READ-SLOT-VALUE (BUTLAST X)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS (MAKE-SYMBOL (CL:CAR (CL:LAST X))) NIL)) NIL))) (? (STRING? (CL:CAR X)) (MAKE-SYMBOL (CL:CAR X)) (CL:CAR X))))))) (CL:SETF (CL:GETHASH #'READ-SLOT-VALUE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-SLOT-VALUE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS 'X (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CL:CDR (CL:CONS 'X NIL)) (CL:CONS (CL:CONS 'BACKQUOTE (CL:CONS (CL:CONS 'SLOT-VALUE (CL:CONS (CL:CONS 'QUASIQUOTE (CL:CONS (CL:CONS 'READ-SLOT-VALUE (CL:CONS (CL:CONS 'BUTLAST (CL:CONS 'X NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS (CL:CONS 'QUASIQUOTE (CL:CONS (CL:CONS 'MAKE-SYMBOL (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:LAST (CL:CONS 'X NIL)) NIL)) NIL)) NIL)) NIL)) NIL))) NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'STRING? (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) (CL:CONS (CL:CONS 'MAKE-SYMBOL (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS 'X NIL)) NIL)))) NIL)))) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-SLOT-VALUE))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-SYMBOL-OR-SLOT-VALUE (CL:CONS (CL:CONS 'SYM (CL:CONS 'PKG NIL)) NIL)))) (CL:PROGN (CL:DEFUN READ-SYMBOL-OR-SLOT-VALUE (SYM PKG) (CL:BLOCK READ-SYMBOL-OR-SLOT-VALUE (CL:BLOCK NIL (CL:LABELS ((G3837 (!) (? (? (CL:CDR !) (? (CL:CAR !) (CL:CAR (CL:LAST !)))) (READ-SLOT-VALUE !) (? *READER-FINDS-SYMBOLS?* (CL:FIND-SYMBOL (LIST-STRING SYM) (? (NOT PKG) CL:*PACKAGE* (CL:FIND-PACKAGE (? (EQ T PKG) *KEYWORD-PACKAGE* (LIST-STRING PKG))))) (MAKE-SYMBOL (LIST-STRING SYM) (? (NOT PKG) NIL (EQ T PKG) *KEYWORD-PACKAGE* (LIST-STRING PKG))))))) (G3837 (CL:MAPCAR #'(CL:LAMBDA (_) (? _ (LIST-STRING _))) (SPLIT #\. SYM))))))) (CL:SETF (CL:GETHASH #'READ-SYMBOL-OR-SLOT-VALUE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'SYM (CL:CONS 'PKG NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-SYMBOL-OR-SLOT-VALUE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '! NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '! NIL)) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS (CL:CONS 'CL:LAST (CL:CONS '! NIL)) NIL)) NIL))) NIL))) (CL:CONS (CL:CONS 'READ-SLOT-VALUE (CL:CONS '! NIL)) (CL:CONS (CL:CONS '? (CL:CONS '*READER-FINDS-SYMBOLS?* (CL:CONS (CL:CONS 'CL:FIND-SYMBOL (CL:CONS (CL:CONS 'LIST-STRING (CL:CONS 'SYM NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS 'PKG NIL)) (CL:CONS 'CL:*PACKAGE* (CL:CONS (CL:CONS 'CL:FIND-PACKAGE (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS T (CL:CONS 'PKG NIL))) (CL:CONS '*KEYWORD-PACKAGE* (CL:CONS (CL:CONS 'LIST-STRING (CL:CONS 'PKG NIL)) NIL)))) NIL)) NIL)))) NIL))) (CL:CONS (CL:CONS 'MAKE-SYMBOL (CL:CONS (CL:CONS 'LIST-STRING (CL:CONS 'SYM NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS 'PKG NIL)) (CL:CONS NIL (CL:CONS (CL:CONS 'EQ (CL:CONS T (CL:CONS 'PKG NIL))) (CL:CONS '*KEYWORD-PACKAGE* (CL:CONS (CL:CONS 'LIST-STRING (CL:CONS 'PKG NIL)) NIL)))))) NIL))) NIL)))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:MAPCAR (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '_ NIL) (CL:CONS (CL:CONS '? (CL:CONS '_ (CL:CONS (CL:CONS 'LIST-STRING (CL:CONS '_ NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'SPLIT (CL:CONS #\. (CL:CONS 'SYM NIL))) NIL))) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-SYMBOL-OR-SLOT-VALUE))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-ATOM (CL:CONS (CL:CONS 'STR (CL:CONS 'TOKEN (CL:CONS 'PKG (CL:CONS 'SYM NIL)))) NIL)))) (CL:PROGN (CL:DEFUN READ-ATOM (STR TOKEN PKG SYM) (CL:BLOCK READ-ATOM (CL:BLOCK NIL (CL:LABELS ((G3838 (~G1573) (? (EQ ~G1573 'DBLQUOTE) (READ-STRING STR) (EQ ~G1573 'CHAR) (READ-CHAR STR) (EQ ~G1573 'NUMBER) (CL:LABELS ((G3839 (S) (PRINC (LIST-STRING SYM) S) (CL:PROGN (READ-NUMBER S)))) (G3839 (MAKE-STRING-STREAM))) (EQ ~G1573 'HEXNUM) (READ-HEX STR) (EQ ~G1573 'CL:FUNCTION) (CL:CONS 'CL:FUNCTION (CL:CONS (READ-EXPR STR) NIL)) (EQ ~G1573 'SYMBOL) (READ-SYMBOL-OR-SLOT-VALUE SYM PKG) (ERROR "Syntax error: token ~A, sym ~A." TOKEN SYM)))) (G3838 TOKEN))))) (CL:SETF (CL:GETHASH #'READ-ATOM *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR (CL:CONS 'TOKEN (CL:CONS 'PKG (CL:CONS 'SYM NIL)))) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-ATOM (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1573 NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1573 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'DBLQUOTE NIL)) NIL))) (CL:CONS (CL:CONS 'READ-STRING (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1573 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CHAR NIL)) NIL))) (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1573 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'NUMBER NIL)) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'S NIL) (CL:CONS (CL:CONS 'PRINC (CL:CONS (CL:CONS 'LIST-STRING (CL:CONS 'SYM NIL)) (CL:CONS 'S NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'READ-NUMBER (CL:CONS 'S NIL)) NIL)) NIL))) NIL)) (CL:CONS (CL:CONS 'MAKE-STRING-STREAM NIL) NIL)) (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1573 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'HEXNUM NIL)) NIL))) (CL:CONS (CL:CONS 'READ-HEX (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1573 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CL:FUNCTION NIL)) NIL))) (CL:CONS (CL:CONS 'BACKQUOTE (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS 'QUASIQUOTE (CL:CONS (CL:CONS 'READ-EXPR (CL:CONS 'STR NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1573 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'SYMBOL NIL)) NIL))) (CL:CONS (CL:CONS 'READ-SYMBOL-OR-SLOT-VALUE (CL:CONS 'SYM (CL:CONS 'PKG NIL))) (CL:CONS (CL:CONS 'ERROR (CL:CONS "Syntax error: token ~A, sym ~A." (CL:CONS 'TOKEN (CL:CONS 'SYM NIL)))) NIL)))))))))))))) NIL)) NIL)) (CL:CONS 'TOKEN NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-ATOM))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-QUOTE (CL:CONS (CL:CONS 'STR (CL:CONS 'TOKEN NIL)) NIL)))) (CL:PROGN (CL:DEFUN READ-QUOTE (STR TOKEN) (CL:BLOCK READ-QUOTE (CL:BLOCK NIL (CL:LIST TOKEN (READ-EXPR STR))))) (CL:SETF (CL:GETHASH #'READ-QUOTE *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR (CL:CONS 'TOKEN NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-QUOTE (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'CL:LIST (CL:CONS 'TOKEN (CL:CONS (CL:CONS 'READ-EXPR (CL:CONS 'STR NIL)) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-QUOTE))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-SET-LISTPROP (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN READ-SET-LISTPROP (STR) (CL:BLOCK READ-SET-LISTPROP (CL:BLOCK NIL (CL:LABELS ((G3840 (!) (CL:PROGN (CL:SETQ *DEFAULT-LISTPROP* (CL:CONS (STREAM-LOCATION-ID !) (CL:CONS (MEMORIZED-NUMBER (STREAM-LOCATION-COLUMN !)) (MEMORIZED-NUMBER (STREAM-LOCATION-LINE !)))))))) (G3840 (STREAM-INPUT-LOCATION STR)))))) (CL:SETF (CL:GETHASH #'READ-SET-LISTPROP *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-SET-LISTPROP (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '*DEFAULT-LISTPROP* (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'STREAM-LOCATION-ID (CL:CONS '! NIL)) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'MEMORIZED-NUMBER (CL:CONS (CL:CONS 'STREAM-LOCATION-COLUMN (CL:CONS '! NIL)) NIL)) (CL:CONS (CL:CONS 'MEMORIZED-NUMBER (CL:CONS (CL:CONS 'STREAM-LOCATION-LINE (CL:CONS '! NIL)) NIL)) NIL))) NIL))) NIL))) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'STREAM-INPUT-LOCATION (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-SET-LISTPROP))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-CONS (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN READ-CONS (STR) (CL:BLOCK READ-CONS (CL:BLOCK NIL (CL:LABELS ((G3841 (LOC) (CL:LABELS ((G3842 (LINE) (CL:LABELS ((G3843 (COLUMN) (CL:LABELS ((G3844 (FILE) (CL:LABELS ((ERR (_) (ERROR "~A in form starting at line ~A, column ~A in file ~A." _ LINE COLUMN FILE)) (F (TOKEN PKG SYM) (? (NOT (%READ-CLOSING-BRACKET? TOKEN)) (CL:PROGN (CL:CONS (CL:LABELS ((G3845 (~G1575) (CL:PROGN (CL:SETQ *DEFAULT-LISTPROP* *DEFAULT-LISTPROP*)) (CL:LABELS ((G3846 (~G1578) (CL:PROGN (CL:SETQ *DEFAULT-LISTPROP* ~G1575)) ~G1578)) (G3846 (CL:PROGN (CL:LABELS ((G3847 (~G1574) (? (EQ ~G1574 'BRACKET-OPEN) (READ-CONS-SLOT STR) (EQ ~G1574 'SQUARE-BRACKET-OPEN) (CL:CONS 'SQUARE (READ-CONS-SLOT STR)) (EQ ~G1574 'CURLY-BRACKET-OPEN) (CL:CONS 'CURLY (READ-CONS-SLOT STR)) (? (TOKEN-IS-QUOTE? TOKEN) (READ-QUOTE STR TOKEN) (READ-ATOM STR TOKEN PKG SYM))))) (G3847 TOKEN))))))) (G3845 *DEFAULT-LISTPROP*)) (CL:LABELS ((G3848 (~G1577) (CL:PROGN (CL:SETQ *DEFAULT-LISTPROP* *DEFAULT-LISTPROP*)) (CL:LABELS ((G3849 (~G1584) (CL:PROGN (CL:SETQ *DEFAULT-LISTPROP* ~G1577)) ~G1584)) (G3849 (CL:PROGN (CL:LABELS ((G3850 (!) (? ! (CL:LABELS ((G3851 (~G1579) (CL:LABELS ((G3852 (~G1580) (? (NOT (EQ (CL:CAR ~G1579) 'VALUES)) (CL:PROGN (ERROR "VALUES expected instead of ~A." ~G1579))) (CL:LABELS ((G3853 (TOKEN) (CL:LABELS ((G3854 (~G1581) (CL:LABELS ((G3855 (PKG) (CL:LABELS ((G3856 (~G1582) (CL:LABELS ((G3857 (SYM) (? (EQ 'DOT TOKEN) (CL:LABELS ((G3858 (X) (CL:LABELS ((G3859 (~G1587) (CL:LABELS ((G3860 (~G1588) (? (NOT (EQ (CL:CAR ~G1587) 'VALUES)) (CL:PROGN (ERROR "VALUES expected instead of ~A." ~G1587))) (CL:LABELS ((G3861 (TOKEN) (CL:LABELS ((G3862 (~G1589) (CL:LABELS ((G3863 (PKG) (CL:LABELS ((G3864 (~G1590) (CL:LABELS ((G3865 (SYM) (CL:LABELS ((G3866 (~G1576) (? ~G1576 ~G1576 (ERR "Only one value allowed after dotted cons")))) (G3866 (%READ-CLOSING-BRACKET? TOKEN))) X)) (G3865 (CL:CAR ~G1590))))) (G3864 (CL:LABELS ((G3867 (~G1593) (? ~G1593 ~G1593 (%ERROR "Not enough VALUES.")))) (G3867 (CL:CDR ~G1589))))))) (G3863 (CL:CAR ~G1589))))) (G3862 (CL:LABELS ((G3868 (~G1592) (? ~G1592 ~G1592 (%ERROR "Not enough VALUES.")))) (G3868 (CL:CDR ~G1588))))))) (G3861 (CL:CAR ~G1588))))) (G3860 (CL:CDR ~G1587))))) (G3859 (READ-TOKEN STR))))) (G3858 (READ-EXPR STR))) (F TOKEN PKG SYM)))) (G3857 (CL:CAR ~G1582))))) (G3856 (CL:LABELS ((G3869 (~G1586) (? ~G1586 ~G1586 (%ERROR "Not enough VALUES.")))) (G3869 (CL:CDR ~G1581))))))) (G3855 (CL:CAR ~G1581))))) (G3854 (CL:LABELS ((G3870 (~G1585) (? ~G1585 ~G1585 (%ERROR "Not enough VALUES.")))) (G3870 (CL:CDR ~G1580))))))) (G3853 (CL:CAR ~G1580))))) (G3852 (CL:CDR ~G1579))))) (G3851 !)) (ERR "Missing closing bracket")))) (G3850 (READ-TOKEN STR)))))))) (G3848 *DEFAULT-LISTPROP*))))))) (CL:LABELS ((G3871 (~G1620) (CL:LABELS ((G3872 (~G1621) (? (NOT (EQ (CL:CAR ~G1620) 'VALUES)) (CL:PROGN (ERROR "VALUES expected instead of ~A." ~G1620))) (CL:LABELS ((G3873 (TOKEN) (CL:LABELS ((G3874 (~G1622) (CL:LABELS ((G3875 (PKG) (CL:LABELS ((G3876 (~G1623) (CL:LABELS ((G3877 (SYM) (? (EQ TOKEN 'DOT) (CL:CONS 'CL:CONS (READ-CONS STR)) (F TOKEN PKG SYM)))) (G3877 (CL:CAR ~G1623))))) (G3876 (CL:LABELS ((G3878 (~G1639) (? ~G1639 ~G1639 (%ERROR "Not enough VALUES.")))) (G3878 (CL:CDR ~G1622))))))) (G3875 (CL:CAR ~G1622))))) (G3874 (CL:LABELS ((G3879 (~G1638) (? ~G1638 ~G1638 (%ERROR "Not enough VALUES.")))) (G3879 (CL:CDR ~G1621))))))) (G3873 (CL:CAR ~G1621))))) (G3872 (CL:CDR ~G1620))))) (G3871 (READ-TOKEN STR)))))) (G3844 (STREAM-LOCATION-ID LOC))))) (G3843 (STREAM-LOCATION-COLUMN LOC))))) (G3842 (STREAM-LOCATION-LINE LOC))))) (G3841 (STREAM-INPUT-LOCATION STR)))))) (CL:SETF (CL:GETHASH #'READ-CONS *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-CONS (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'LOC NIL) (CL:CONS (CL:CONS 'LET (CL:CONS 'LINE (CL:CONS (CL:CONS 'STREAM-LOCATION-LINE (CL:CONS 'LOC NIL)) (CL:CONS (CL:CONS 'WITH (CL:CONS (CL:CONS 'COLUMN (CL:CONS (CL:CONS 'STREAM-LOCATION-COLUMN (CL:CONS 'LOC NIL)) (CL:CONS 'FILE (CL:CONS (CL:CONS 'STREAM-LOCATION-ID (CL:CONS 'LOC NIL)) (CL:CONS 'ERR (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '_ NIL) (CL:CONS (CL:CONS 'ERROR (CL:CONS "~A in form starting at line ~A, column ~A in file ~A." (CL:CONS '_ (CL:CONS 'LINE (CL:CONS 'COLUMN (CL:CONS 'FILE NIL)))))) NIL)) NIL)) (CL:CONS 'F (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'TOKEN (CL:CONS 'PKG (CL:CONS 'SYM NIL))) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS '%READ-CLOSING-BRACKET? (CL:CONS 'TOKEN NIL)) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1575 NIL) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '*DEFAULT-LISTPROP* (CL:CONS '*DEFAULT-LISTPROP* NIL))) NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1578 NIL) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '*DEFAULT-LISTPROP* (CL:CONS '~G1575 NIL))) NIL)) (CL:CONS '~G1578 NIL))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1574 NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1574 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'BRACKET-OPEN NIL)) NIL))) (CL:CONS (CL:CONS 'READ-CONS-SLOT (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1574 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'SQUARE-BRACKET-OPEN NIL)) NIL))) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'SQUARE NIL)) (CL:CONS (CL:CONS 'READ-CONS-SLOT (CL:CONS 'STR NIL)) NIL))) (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1574 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CURLY-BRACKET-OPEN NIL)) NIL))) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CURLY NIL)) (CL:CONS (CL:CONS 'READ-CONS-SLOT (CL:CONS 'STR NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'TOKEN-IS-QUOTE? (CL:CONS 'TOKEN NIL)) (CL:CONS (CL:CONS 'READ-QUOTE (CL:CONS 'STR (CL:CONS 'TOKEN NIL))) (CL:CONS (CL:CONS 'READ-ATOM (CL:CONS 'STR (CL:CONS 'TOKEN (CL:CONS 'PKG (CL:CONS 'SYM NIL))))) NIL)))) NIL)))))))) NIL)) NIL)) (CL:CONS 'TOKEN NIL)) NIL)) NIL)) NIL))) NIL)) (CL:CONS '*DEFAULT-LISTPROP* NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1577 NIL) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '*DEFAULT-LISTPROP* (CL:CONS '*DEFAULT-LISTPROP* NIL))) NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1584 NIL) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '*DEFAULT-LISTPROP* (CL:CONS '~G1577 NIL))) NIL)) (CL:CONS '~G1584 NIL))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '? (CL:CONS '! (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1579 NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1580 NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1579 NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'VALUES NIL)) NIL))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'ERROR (CL:CONS "VALUES expected instead of ~A." (CL:CONS '~G1579 NIL))) NIL)) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'TOKEN NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1581 NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'PKG NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1582 NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'SYM NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'DOT NIL)) (CL:CONS 'TOKEN NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1587 NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1588 NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1587 NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'VALUES NIL)) NIL))) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'ERROR (CL:CONS "VALUES expected instead of ~A." (CL:CONS '~G1587 NIL))) NIL)) NIL))) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'TOKEN NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1589 NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'PKG NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1590 NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS 'SYM NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1576 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1576 (CL:CONS '~G1576 (CL:CONS (CL:CONS 'ERR (CL:CONS "Only one value allowed after dotted cons" NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS '%READ-CLOSING-BRACKET? (CL:CONS 'TOKEN NIL)) NIL)) (CL:CONS 'X NIL))) NIL)) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1590 NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1593 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1593 (CL:CONS '~G1593 (CL:CONS (CL:CONS '%ERROR (CL:CONS "Not enough VALUES." NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1589 NIL)) NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1589 NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1592 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1592 (CL:CONS '~G1592 (CL:CONS (CL:CONS '%ERROR (CL:CONS "Not enough VALUES." NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1588 NIL)) NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1588 NIL)) NIL)) NIL))) NIL)) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1587 NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'READ-TOKEN (CL:CONS 'STR NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'READ-EXPR (CL:CONS 'STR NIL)) NIL)) (CL:CONS (CL:CONS 'F (CL:CONS 'TOKEN (CL:CONS 'PKG (CL:CONS 'SYM NIL)))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1582 NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1586 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1586 (CL:CONS '~G1586 (CL:CONS (CL:CONS '%ERROR (CL:CONS "Not enough VALUES." NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1581 NIL)) NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1581 NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1585 NIL) (CL:CONS (CL:CONS '? (CL:CONS '~G1585 (CL:CONS '~G1585 (CL:CONS (CL:CONS '%ERROR (CL:CONS "Not enough VALUES." NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1580 NIL)) NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1580 NIL)) NIL)) NIL))) NIL)) (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1579 NIL)) NIL)) NIL)) NIL)) (CL:CONS '! NIL)) (CL:CONS (CL:CONS 'ERR (CL:CONS "Missing closing bracket" NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'READ-TOKEN (CL:CONS 'STR NIL)) NIL)) NIL)) NIL)) NIL))) NIL)) (CL:CONS '*DEFAULT-LISTPROP* NIL)) NIL))) NIL)) NIL))) NIL)) NIL)) NIL)))))))) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1620 (CL:CONS (CL:CONS 'READ-TOKEN (CL:CONS 'STR NIL)) NIL)) (CL:CONS (CL:CONS '~G1621 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1620 NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'UNLESS (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1620 NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'VALUES NIL)) NIL))) (CL:CONS (CL:CONS 'ERROR (CL:CONS "VALUES expected instead of ~A." (CL:CONS '~G1620 NIL))) NIL))) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'TOKEN (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1621 NIL)) NIL)) (CL:CONS (CL:CONS '~G1622 (CL:CONS (CL:CONS '|\|| (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1621 NIL)) (CL:CONS (CL:CONS '%ERROR (CL:CONS "Not enough VALUES." NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'PKG (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1622 NIL)) NIL)) (CL:CONS (CL:CONS '~G1623 (CL:CONS (CL:CONS '|\|| (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1622 NIL)) (CL:CONS (CL:CONS '%ERROR (CL:CONS "Not enough VALUES." NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'SYM (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1623 NIL)) NIL)) NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS 'TOKEN (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'DOT NIL)) NIL))) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CL:CONS NIL)) (CL:CONS (CL:CONS 'READ-CONS (CL:CONS 'STR NIL)) NIL))) (CL:CONS (CL:CONS 'F (CL:CONS 'TOKEN (CL:CONS 'PKG (CL:CONS 'SYM NIL)))) NIL)))) NIL))) NIL))) NIL))) NIL)))) NIL))) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'STREAM-INPUT-LOCATION (CL:CONS 'STR NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-CONS))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-CONS-SLOT (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN READ-CONS-SLOT (STR) (CL:BLOCK READ-CONS-SLOT (CL:BLOCK NIL (READ-SET-LISTPROP STR) (CL:LABELS ((G3880 (~G1594) (CL:PROGN (CL:SETQ *DEFAULT-LISTPROP* *DEFAULT-LISTPROP*)) (CL:LABELS ((G3881 (~G1630) (CL:PROGN (CL:SETQ *DEFAULT-LISTPROP* ~G1594)) ~G1630)) (G3881 (CL:PROGN (CL:LABELS ((G3882 (!) (? (== #\. (PEEK-CHAR STR)) (CL:PROGN (READ-CHAR STR) (CL:LABELS ((G3883 (~G1625) (CL:LABELS ((G3884 (~G1626) (? (NOT (EQ (CL:CAR ~G1625) 'VALUES)) (CL:PROGN (ERROR "VALUES expected instead of ~A." ~G1625))) (CL:LABELS ((G3885 (TOKEN) (CL:LABELS ((G3886 (~G1627) (CL:LABELS ((G3887 (PKG) (CL:LABELS ((G3888 (~G1628) (CL:LABELS ((G3889 (SYM) (READ-SLOT-VALUE (CL:LIST ! (LIST-STRING SYM))))) (G3889 (CL:CAR ~G1628))))) (G3888 (CL:LABELS ((G3890 (~G1641) (? ~G1641 ~G1641 (%ERROR "Not enough VALUES.")))) (G3890 (CL:CDR ~G1627))))))) (G3887 (CL:CAR ~G1627))))) (G3886 (CL:LABELS ((G3891 (~G1640) (? ~G1640 ~G1640 (%ERROR "Not enough VALUES.")))) (G3891 (CL:CDR ~G1626))))))) (G3885 (CL:CAR ~G1626))))) (G3884 (CL:CDR ~G1625))))) (G3883 (READ-TOKEN STR)))) !))) (G3882 (READ-CONS STR)))))))) (G3880 *DEFAULT-LISTPROP*))))) (CL:SETF (CL:GETHASH #'READ-CONS-SLOT *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-CONS-SLOT (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'READ-SET-LISTPROP (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'LET (CL:CONS '~G1594 (CL:CONS '*DEFAULT-LISTPROP* (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '*DEFAULT-LISTPROP* (CL:CONS '*DEFAULT-LISTPROP* NIL))) NIL)) (CL:CONS (CL:CONS 'LET (CL:CONS '~G1630 (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS '== (CL:CONS #\. (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'STR NIL)) NIL))) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'READ-CHAR (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1625 (CL:CONS (CL:CONS 'READ-TOKEN (CL:CONS 'STR NIL)) NIL)) (CL:CONS (CL:CONS '~G1626 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1625 NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'UNLESS (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1625 NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'VALUES NIL)) NIL))) (CL:CONS (CL:CONS 'ERROR (CL:CONS "VALUES expected instead of ~A." (CL:CONS '~G1625 NIL))) NIL))) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'TOKEN (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1626 NIL)) NIL)) (CL:CONS (CL:CONS '~G1627 (CL:CONS (CL:CONS '|\|| (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1626 NIL)) (CL:CONS (CL:CONS '%ERROR (CL:CONS "Not enough VALUES." NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'PKG (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1627 NIL)) NIL)) (CL:CONS (CL:CONS '~G1628 (CL:CONS (CL:CONS '|\|| (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1627 NIL)) (CL:CONS (CL:CONS '%ERROR (CL:CONS "Not enough VALUES." NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'SYM (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1628 NIL)) NIL)) NIL) (CL:CONS (CL:CONS 'READ-SLOT-VALUE (CL:CONS (CL:CONS 'CL:LIST (CL:CONS '! (CL:CONS (CL:CONS 'LIST-STRING (CL:CONS 'SYM NIL)) NIL))) NIL)) NIL))) NIL))) NIL))) NIL)))) NIL))) (CL:CONS '! NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'READ-CONS (CL:CONS 'STR NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '*DEFAULT-LISTPROP* (CL:CONS '~G1594 NIL))) NIL)) (CL:CONS '~G1630 NIL))))) NIL))))) NIL)))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-CONS-SLOT))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-EXPR (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN READ-EXPR (STR) (CL:BLOCK READ-EXPR (CL:BLOCK NIL (CL:LABELS ((G3892 (~G1631) (CL:LABELS ((G3893 (~G1632) (? (NOT (EQ (CL:CAR ~G1631) 'VALUES)) (CL:PROGN (ERROR "VALUES expected instead of ~A." ~G1631))) (CL:LABELS ((G3894 (TOKEN) (CL:LABELS ((G3895 (~G1633) (CL:LABELS ((G3896 (PKG) (CL:LABELS ((G3897 (~G1634) (CL:LABELS ((G3898 (SYM) (CL:LABELS ((G3899 (~G1595) (? (EQ ~G1595 NIL) NIL (EQ ~G1595 'EOF) NIL (EQ ~G1595 'BRACKET-OPEN) (READ-CONS-SLOT STR) (EQ ~G1595 'SQUARE-BRACKET-OPEN) (CL:CONS 'SQUARE (READ-CONS-SLOT STR)) (EQ ~G1595 'CURLY-BRACKET-OPEN) (CL:CONS 'CURLY (READ-CONS-SLOT STR)) (? (TOKEN-IS-QUOTE? TOKEN) (READ-QUOTE STR TOKEN) (READ-ATOM STR TOKEN PKG SYM))))) (G3899 TOKEN)))) (G3898 (CL:CAR ~G1634))))) (G3897 (CL:LABELS ((G3900 (~G1643) (? ~G1643 ~G1643 (%ERROR "Not enough VALUES.")))) (G3900 (CL:CDR ~G1633))))))) (G3896 (CL:CAR ~G1633))))) (G3895 (CL:LABELS ((G3901 (~G1642) (? ~G1642 ~G1642 (%ERROR "Not enough VALUES.")))) (G3901 (CL:CDR ~G1632))))))) (G3894 (CL:CAR ~G1632))))) (G3893 (CL:CDR ~G1631))))) (G3892 (READ-TOKEN STR)))))) (CL:SETF (CL:GETHASH #'READ-EXPR *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-EXPR (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS '~G1631 (CL:CONS (CL:CONS 'READ-TOKEN (CL:CONS 'STR NIL)) NIL)) (CL:CONS (CL:CONS '~G1632 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1631 NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'UNLESS (CL:CONS (CL:CONS 'EQ (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1631 NIL)) (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'VALUES NIL)) NIL))) (CL:CONS (CL:CONS 'ERROR (CL:CONS "VALUES expected instead of ~A." (CL:CONS '~G1631 NIL))) NIL))) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'TOKEN (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1632 NIL)) NIL)) (CL:CONS (CL:CONS '~G1633 (CL:CONS (CL:CONS '|\|| (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1632 NIL)) (CL:CONS (CL:CONS '%ERROR (CL:CONS "Not enough VALUES." NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'PKG (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1633 NIL)) NIL)) (CL:CONS (CL:CONS '~G1634 (CL:CONS (CL:CONS '|\|| (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1633 NIL)) (CL:CONS (CL:CONS '%ERROR (CL:CONS "Not enough VALUES." NIL)) NIL))) NIL)) NIL)) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'SYM (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1634 NIL)) NIL)) NIL) (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '~G1595 NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1595 (CL:CONS NIL NIL))) (CL:CONS NIL (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1595 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'EOF NIL)) NIL))) (CL:CONS NIL (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1595 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'BRACKET-OPEN NIL)) NIL))) (CL:CONS (CL:CONS 'READ-CONS-SLOT (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1595 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'SQUARE-BRACKET-OPEN NIL)) NIL))) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'SQUARE NIL)) (CL:CONS (CL:CONS 'READ-CONS-SLOT (CL:CONS 'STR NIL)) NIL))) (CL:CONS (CL:CONS 'EQ (CL:CONS '~G1595 (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CURLY-BRACKET-OPEN NIL)) NIL))) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'CURLY NIL)) (CL:CONS (CL:CONS 'READ-CONS-SLOT (CL:CONS 'STR NIL)) NIL))) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'TOKEN-IS-QUOTE? (CL:CONS 'TOKEN NIL)) (CL:CONS (CL:CONS 'READ-QUOTE (CL:CONS 'STR (CL:CONS 'TOKEN NIL))) (CL:CONS (CL:CONS 'READ-ATOM (CL:CONS 'STR (CL:CONS 'TOKEN (CL:CONS 'PKG (CL:CONS 'SYM NIL))))) NIL)))) NIL)))))))))))) NIL)) NIL)) (CL:CONS 'TOKEN NIL)) NIL))) NIL))) NIL))) NIL)))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-EXPR))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-INPUT* NIL)) NIL)) NIL)))) (CL:PROGN (CL:DEFUN READ (CL:&OPTIONAL (STR *STANDARD-INPUT*)) (CL:BLOCK READ (CL:BLOCK NIL (SKIP-SPACES STR) (? (PEEK-CHAR STR) (READ-EXPR STR))))) (CL:SETF (CL:GETHASH #'READ *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'CL:&OPTIONAL (CL:CONS (CL:CONS 'STR (CL:CONS '*STANDARD-INPUT* NIL)) NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'SKIP-SPACES (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'READ-EXPR (CL:CONS 'STR NIL)) NIL))) NIL)))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS 'READ-ALL (CL:CONS (CL:CONS 'STR NIL) NIL)))) (CL:PROGN (CL:DEFUN READ-ALL (STR) (CL:BLOCK READ-ALL (CL:BLOCK NIL (SKIP-SPACES STR) (? (PEEK-CHAR STR) (CL:CONS (READ STR) (READ-ALL STR)))))) (CL:SETF (CL:GETHASH #'READ-ALL *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'STR NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS 'READ-ALL (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'SKIP-SPACES (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'READ (CL:CONS 'STR NIL)) (CL:CONS (CL:CONS 'READ-ALL (CL:CONS 'STR NIL)) NIL))) NIL))) NIL)))) NIL))) NIL)))) (CL:RETURN-FROM NIL 'READ-ALL))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '%LOAD-R (CL:CONS (CL:CONS 'S NIL) NIL)))) (CL:PROGN (CL:DEFUN %LOAD-R (S) (CL:BLOCK %LOAD-R (CL:BLOCK NIL (? (PEEK-CHAR S) (CL:PROGN (CL:CONS (READ S) (%LOAD-R S))))))) (CL:SETF (CL:GETHASH #'%LOAD-R *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'S NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '%LOAD-R (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'PEEK-CHAR (CL:CONS 'S NIL)) (CL:CONS (CL:CONS 'CL:PROGN (CL:CONS (CL:CONS 'CL:CONS (CL:CONS (CL:CONS 'READ (CL:CONS 'S NIL)) (CL:CONS (CL:CONS '%LOAD-R (CL:CONS 'S NIL)) NIL))) NIL)) NIL))) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '%LOAD-R))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '%EXPAND (CL:CONS (CL:CONS 'X NIL) NIL)))) (CL:PROGN (CL:DEFUN %EXPAND (X) (CL:BLOCK %EXPAND (CL:BLOCK NIL (CL:LABELS ((G3902 (!) (? (EQUAL X !) X (%EXPAND !)))) (G3902 (QUASIQUOTE-EXPAND (MACROEXPAND (DOT-EXPAND X)))))))) (CL:SETF (CL:GETHASH #'%EXPAND *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'X NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '%EXPAND (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS (CL:CONS 'CL:FUNCTION (CL:CONS (CL:CONS (CL:CONS '! NIL) (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'EQUAL (CL:CONS 'X (CL:CONS '! NIL))) (CL:CONS 'X (CL:CONS (CL:CONS '%EXPAND (CL:CONS '! NIL)) NIL)))) NIL)) NIL)) (CL:CONS (CL:CONS 'QUASIQUOTE-EXPAND (CL:CONS (CL:CONS 'MACROEXPAND (CL:CONS (CL:CONS 'DOT-EXPAND (CL:CONS 'X NIL)) NIL)) NIL)) NIL)) NIL))) NIL))) NIL)))) (CL:RETURN-FROM NIL '%EXPAND))
(CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS 'DEFUN (CL:CONS '%LOAD (CL:CONS (CL:CONS 'PATHNAME NIL) NIL)))) (CL:PROGN (CL:DEFUN %LOAD (PATHNAME) (CL:BLOCK %LOAD (CL:BLOCK NIL (PRINT-DEFINITION (CL:CONS '%LOAD (CL:CONS PATHNAME NIL))) (CL:BLOCK NIL (CL:LABELS ((G3903 (~G1646) (CL:LABELS ((G3904 (I) (CL:TAGBODY ~G1644 (? (NOT ~G1646) (CL:GO ~G1645)) (CL:SETQ I (CL:CAR ~G1646)) (%EVAL (%EXPAND I)) (CL:SETQ ~G1646 (CL:CDR ~G1646)) (CL:GO ~G1644) ~G1645 (CL:RETURN-FROM NIL (CL:PROGN))))) (G3904 NIL)))) (G3903 (CL:LABELS ((G3905 (S) (CL:LABELS ((G3906 (~G1647) (CLOSE S) ~G1647)) (G3906 (CL:PROGN (%LOAD-R S)))))) (G3905 (OPEN PATHNAME :DIRECTION 'INPUT))))))))) (CL:SETF (CL:GETHASH #'%LOAD *FUNCTION-ATOM-SOURCES*) (CL:CONS (CL:CONS 'PATHNAME NIL) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS '%LOAD (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'PRINT-DEFINITION (CL:CONS (CL:CONS 'BACKQUOTE (CL:CONS (CL:CONS '%LOAD (CL:CONS (CL:CONS 'QUASIQUOTE (CL:CONS 'PATHNAME NIL)) NIL)) NIL)) NIL)) (CL:CONS (CL:CONS 'CL:BLOCK (CL:CONS NIL (CL:CONS (CL:CONS 'LET (CL:CONS '~G1646 (CL:CONS (CL:CONS 'WITH-OPEN-FILE (CL:CONS 'S (CL:CONS (CL:CONS 'OPEN (CL:CONS 'PATHNAME (CL:CONS ':DIRECTION (CL:CONS (CL:CONS 'CL:QUOTE (CL:CONS 'INPUT NIL)) NIL)))) (CL:CONS (CL:CONS '%LOAD-R (CL:CONS 'S NIL)) NIL)))) (CL:CONS (CL:CONS 'LET* (CL:CONS (CL:CONS (CL:CONS 'I (CL:CONS NIL NIL)) NIL) (CL:CONS (CL:CONS 'CL:TAGBODY (CL:CONS '~G1644 (CL:CONS (CL:CONS '? (CL:CONS (CL:CONS 'NOT (CL:CONS '~G1646 NIL)) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1645 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS 'I (CL:CONS (CL:CONS 'CL:CAR (CL:CONS '~G1646 NIL)) NIL))) (CL:CONS (CL:CONS '%EVAL (CL:CONS (CL:CONS '%EXPAND (CL:CONS 'I NIL)) NIL)) (CL:CONS (CL:CONS 'CL:SETQ (CL:CONS '~G1646 (CL:CONS (CL:CONS 'CL:CDR (CL:CONS '~G1646 NIL)) NIL))) (CL:CONS (CL:CONS 'CL:GO (CL:CONS '~G1644 NIL)) (CL:CONS '~G1645 (CL:CONS (CL:CONS 'CL:RETURN-FROM (CL:CONS NIL (CL:CONS (CL:CONS 'CL:PROGN NIL) NIL))) NIL))))))))) NIL))) NIL)))) NIL))) NIL)))) NIL))) NIL)))) (CL:RETURN-FROM NIL '%LOAD))
